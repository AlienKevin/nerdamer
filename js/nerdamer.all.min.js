var nerdamer=function(a){"use strict";function ma(a,b,c){var d="hash"===b,e="decimals"===b,f=d?void 0:b;if(H(a)){var g="",h="",q="",s=a.group||c,t=a.value;if(!d){var u=e?a.multiplier.valueOf():a.multiplier.toString();"-1"==u&&(q="-",u="1"),"1"!=u&&(g=u);var v=a.power?e?a.power.valueOf():a.power.toString():"";"1"!=v&&(h=H(v)?ma(v,f):v)}switch(s){case i:g="",t="-1"==a.multiplier?"1":e?a.valueOf():a.multiplier.toString(),h="";break;case n:t=a.collectSymbols(ma,f).join("+").replace(/\+\-/g,"-");break;case p:t=a.collectSymbols(ma,f).join("+").replace(/\+\-/g,"-");break;case o:t=a.collectSymbols(function(a){var b=a.group;return(b===n||b===p)&&a.power.equals(1)&&a.multiplier.equals(1)?O(ma(a,f)):ma(a,f)}).join("*");break;case l:var w=a.previousGroup,x=a.power.group;w===n&&(t=a.collectSymbols(ma,f).join("+").replace("+-","-")),w===i||w===k||w===m||d||(t=O(t)),x!==p&&x!==o&&x!==n&&"1"==a.power.multiplier.toString()||!h||(h=O(h))}s===m&&e&&(t=a.fname+O(a.args.map(function(a){return ma(a,f)}).join(","))),!h||M(h)||s===l||e||(h=O(h)),((s===p||s===n)&&(g&&"1"!=g||"-"===q)||(s===o||s===p||s===n)&&h&&"1"!=h||!d&&s===j&&t==-1||a.fname===r)&&(t=O(t));var y=q+g;!g||M(g)||e||(y=O(y)),h<0&&(h=O(h)),g&&(y+="*"),h&&(h="^"+h),s===l&&"-"===t.charAt(0)&&(t=O(t));var z=y+t;return a.parens&&(z=O(z)),z+h}if(I(a)){for(var A=a.elements.length,y=[],B=0;B<A;B++)y.push(a.elements[B].text());return"["+y.join(",")+"]"}try{return a.toString()}catch(a){return""}}function oa(a){this.name=a}function pa(a){this.symbol=a}function qa(a){if(a instanceof qa)return a;if(void 0===a)return this;if(M(a))this.num=d(a),this.den=d(1);else{var b=wa.convert(a);this.num=new d(b[0]),this.den=new d(b[1])}}function ra(a){return this instanceof ra?(isNaN(a)?(this.group=k,D(a),this.value=a,this.multiplier=new qa(1),this.imaginary=a===h.IMAGINARY):(this.group=i,this.value=q,this.multiplier=new qa(a)),this.power=new qa(1),this):new ra(a)}function sa(a){if(F(a))return[a];for(var b=a,c=1,d=[],e=2.220446049250313e-16;c<b;){var g=a/c,h=Math.floor(g),i=g-h;i<=e&&c>1&&(f.indexOf(c)!==-1&&d.push(c),b=h),c++}return d.sort(function(a,b){return a-b})}function ta(a,b,c,d,e,f){this.val=a,this.fn=b,this.precedence=c,this.left_assoc=d,this.is_prefix=e,this.is_postfix=f||!1}function ua(a){this.val=a}function va(){function C(b){return h.PARSE2NUMBER?b:a.symfunction("parens",[b])}function D(b){if(b.multiplier.lessThan(0)&&b.multiplier.negate(),K(b)||ba(b.power))return b;if(b.isComposite()){var c=[];b.each(function(a){c.push(a.multiplier)});var d=la.QGCD.apply(null,c);d.lessThan(0)&&(b.multiplier=b.multiplier.multiply(new qa(-1)),b.distributeMultiplier())}return a.symfunction(u,[b])}function E(b){return h.PARSE2NUMBER&&b.isConstant()?M(b)?la.fact(b):la.gamma(b.multiplier.toDecimal()+1):a.symfunction(v,[b])}function F(b,c){if(b.isConstant()&&c.isConstant()){var d=new ra(1);return d.multiplier=d.multiplier.multiply(b.multiplier.mod(c.multiplier)),d}return a.symfunction("mod",[b,c])}function G(b){if(h.PARSE2NUMBER&&b.isConstant()&&!b.multiplier.lessThan(0))return new ra(Math.sqrt(b.multiplier.toDecimal()));var c,d,e=b.isConstant();if(b.group===o&&b.isLinear()){var f=G(ra(b.multiplier));for(var g in b.symbols){var i=b.symbols[g];f=a.multiply(f,G(i))}d=f}else if(b.fname===t){var g=b.args[0];g.setPower(b.power.multiply(new qa(.25))),d=g}else if(b.power.isInteger()){e&&b.multiplier.lessThan(0)&&(c=ra.imaginary(),b.multiplier=b.multiplier.abs());var f,j=b.multiplier.toDecimal(),k=Math.abs(j),l=Math.sqrt(k);if(M(l))f=new ra(l);else if(M(j)){var m=la.ifactor(j),n=1;for(var i in m){var p=m[i],q=p-p%2;if(q){var r=Math.pow(i,q);n*=Math.pow(i,q/2),j/=r}}f=a.multiply(a.symfunction(t,[new ra(j)]),new ra(n))}else{var p=b.multiplier.num.toString(),s=b.multiplier.den.toString(),u=Math.sqrt(p),v=Math.sqrt(s);f=a.multiply("1"===p?new ra(1):M(u)?new ra(u):a.symfunction(t,[new ra(p)]),"1"===s?new ra(1):M(v)?new ra(v).invert():a.symfunction(t,[new ra(s)]).invert())}b=b.toUnitMultiplier(!0),d=b.isOne()?b:ba(b.power.toString())?a.pow(b.clone(),new ra(.5)):a.symfunction(t,[b]),f&&(d=a.multiply(f,d)),c&&(d=a.multiply(c,d))}else b.setPower(b.power.multiply(new qa(.5))),d=b;return d}function N(b){var c=new ra(1);if(b.isConstant()){var d=b.multiplier.toDecimal();if(M(d)){var e=la.ifactor(d);for(var f in e){var g=e[f];c=a.multiply(c,a.symfunction("parens",[new ra(f).setPower(g)]))}}else{var h=N(new ra(b.multiplier.num)),i=N(new ra(b.multiplier.den));c=a.multiply(a.symfunction("parens",[h]),a.symfunction("parens",[i]).invert())}}return c}function O(b){var c;if(b.equals(0)&&B("log(0) is undefined!"),b.group===l&&b.power.multiplier.lessThan(0)||b.power==-1)b.power.negate(),c=O(b).negate();else if("e"===b.value&&b.multiplier.equals(1)){var d=b.power;c=H(d)?d:new ra(d)}else if(b.group===m&&"exp"===b.fname){var e=b.args[0];c=b.multiplier.equals(1)?a.multiply(e,new ra(b.power)):a.symfunction("log",[b])}else if(h.PARSE2NUMBER&&K(b)){var f;b.multiplier.lessThan(0)&&(b.negate(),f=a.multiply(new ra(Math.PI),new ra("i"))),c=new ra(Math.log(b.multiplier.toDecimal())),f&&(c=a.add(c,f))}else{var e;b.power.equals(1)||(e=b.group===l?b.power:new ra(b.power),b.toLinear()),c=a.symfunction("log",[b]),e&&(c=a.multiply(e,c))}return c}function P(a){var c,b=a%2;return b<0&&(b=2+b),c=b>=0&&b<=.5?1:b>.5&&b<=1?2:b>1&&b<=1.5?3:4}function R(b){if(h.PARSE2NUMBER&&b.isConstant())return new ra(Math.cos(b.valueOf()));var c,d=!1,e=P(b.multiplier.toDecimal()),f=b.multiplier.abs();if(b.multiplier=f,b.isPi()&&b.isLinear())if(M(f))c=new ra(ba(f)?1:-1);else{var i=(f.num,f.den);2==i?c=new ra(0):3==i?(c=a.parse("1/2"),d=!0):4==i?(c=a.parse("1/sqrt(2)"),d=!0):6==i?(c=a.parse("sqrt(3)/2"),d=!0):c=a.symfunction("cos",[b])}return!d||2!==e&&3!==e||c.negate(),c||(c=a.symfunction("cos",[b])),c}function T(b){if(h.PARSE2NUMBER&&b.isConstant())return new ra(Math.sin(b.valueOf()));var c,d=!1,e=P(b.multiplier.toDecimal()),f=b.multiplier.sign(),g=b.multiplier.abs();if(b.multiplier=g,b.isPi()&&b.isLinear())if(M(g))c=new ra(0);else{var j=(g.num,g.den);2==j?(c=new ra(1),d=!0):3==j?(c=a.parse("sqrt(3)/2"),d=!0):4==j?(c=a.parse("1/sqrt(2)"),d=!0):6==j?(c=a.parse("1/2"),d=!0):c=a.symfunction("sin",[b])}return c||(c=a.multiply(new ra(f),a.symfunction("sin",[b]))),!d||3!==e&&4!==e||c.negate(),c}function V(b){if(h.PARSE2NUMBER&&b.isConstant())return new ra(Math.tan(b.valueOf()));var c,d=!1,e=P(b.multiplier.toDecimal()),f=b.multiplier;if(b.multiplier=f,b.isPi()&&b.isLinear())if(M(f))c=new ra(0);else{var i=(f.num,f.den);2==i?B("tan is undefined for "+b.toString()):3==i?(c=a.parse("sqrt(3)"),d=!0):4==i?(c=new ra(1),d=!0):6==i?(c=a.parse("1/sqrt(3)"),d=!0):c=a.symfunction("tan",[b])}return c||(c=a.symfunction("tan",[b])),!d||2!==e&&4!==e||c.negate(),c}function W(b){if(h.PARSE2NUMBER&&b.isConstant())return new ra(la.sec(b.valueOf()));var c,d=!1,e=P(b.multiplier.toDecimal()),f=b.multiplier.abs();if(b.multiplier=f,b.isPi()&&b.isLinear())if(M(f))c=new ra(ba(f)?1:-1);else{var i=(f.num,f.den);2==i?B("sec is undefined for "+b.toString()):3==i?(c=new ra(2),d=!0):4==i?(c=a.parse("sqrt(2)"),d=!0):6==i?(c=a.parse("2/sqrt(3)"),d=!0):c=a.symfunction("sec",[b])}return!d||2!==e&&3!==e||c.negate(),c||(c=a.symfunction("sec",[b])),c}function X(b){if(h.PARSE2NUMBER&&b.isConstant())return new ra(la.csc(b.valueOf()));var c,d=!1,e=P(b.multiplier.toDecimal()),f=b.multiplier.abs();if(b.multiplier=f,b.isPi()&&b.isLinear())if(M(f))B("csc is undefined for "+b.toString());else{var i=(f.num,f.den);2==i?(c=new ra(1),d=!0):3==i?(c=a.parse("2/sqrt(3)"),d=!0):4==i?(c=a.parse("sqrt(2)"),d=!0):6==i?(c=new ra(2),d=!0):c=a.symfunction("csc",[b])}return c||(c=a.symfunction("csc",[b])),!d||3!==e&&4!==e||c.negate(),c}function Y(b){if(h.PARSE2NUMBER&&b.isConstant())return new ra(la.cot(b.valueOf()));var c,d=!1,e=P(b.multiplier.toDecimal()),f=b.multiplier;if(b.multiplier=f,b.isPi()&&b.isLinear())if(M(f))B("cot is undefined for "+b.toString());else{var i=(f.num,f.den);2==i?c=new ra(0):3==i?(c=a.parse("1/sqrt(3)"),d=!0):4==i?(c=new ra(1),d=!0):6==i?(c=a.parse("sqrt(3)"),d=!0):c=a.symfunction("cot",[b])}return c||(c=a.symfunction("cot",[b])),!d||2!==e&&4!==e||c.negate(),c}function Z(b){if(!b.symbols)return b;var c=b.clone();try{var d=b.power,e=b.multiplier,f=Number(d);if(!b.symbols)return b;for(var g in b.symbols){var h=b.symbols[g];b.symbols[g]=Z(h)}if(b=a.parse(b),M(d)&&f>0&&b.isComposite()){b=b.toLinear().toUnitMultiplier();for(var i=b.clone(),j=0;j<f-1;j++){var k=new ra(0);for(var g in b.symbols){var h=b.symbols[g];for(var m in i.symbols){var p=i.symbols[m],q=a.expand(a.multiply(h.clone(),p.clone())),r=Number(q.power);(q.group===o&&1!==r||q.group===n&&1!==r)&&(q=Z(q)),k=a.add(k,q)}}i=k}if(!e.equals(1))for(var g in i.symbols){var h=i.symbols[g];h.multiplier=h.multiplier.multiply(e),h.isComposite()&&h.distributeMultiplier(),b.symbols[g]=h}return i}if(b.group===o){var s=!1,t=b.power;for(var h in b.symbols){var u=b.symbols[h];if(u.isComposite()){s=!0;break}H(u.power)||H(t)?(u.power=a.multiply(u.power,ra(t)),u.group=l):u.power=u.power.multiply(t)}if(b.toLinear(),b=a.parse(b.text()),!s)return b;var i=new ra(0),v=[],w=new ra(b.multiplier);for(var g in b.symbols){var h=b.symbols[g];if(h.isComposite()){var d=h.power,x=!1;M(d)&&d<0&&(h.power.negate(),x=!0),x?(h.power.negate(),w=a.multiply(w,h)):v.push(h)}else w=a.multiply(w,h)}var y=v.length;i=v[0];for(var j=1;j<y;j++){var k=new ra(0),g=v[j];for(var z in i.symbols){var h=i.symbols[z];for(var m in g.symbols){var p=g.symbols[m],A=a.multiply(h.clone(),p.clone());k=a.add(k,A)}}i=k}var B=new ra(0);for(var g in i.symbols){var h=i.symbols[g];B=a.add(B,Z(a.multiply(w,h)))}b=B}}catch(a){return c}return b}function $(a){return za.identity(a)}function _(a,b){return a.elements[b]}function aa(a,b,c){return a.elements[b]=c,a}function ca(a,b,c){return a.elements[b][c]}function da(a,b,c,d){return a.elements[b][c]=d,a}function ea(){return new ya([].slice.call(arguments))}function fa(){return za.fromArray(arguments)}function ga(a){return J(a)?a.determinant():a}function ha(a,b){return I(a)&&I(b)?a.dot(b):void B("function dot expects 2 vectors")}function ia(a,b){return I(a)&&I(b)?a.cross(b):void B("function cross expects 2 vectors")}function ja(a){return J(a)?a.transpose():void B("function transpose expects a matrix")}function ka(a){return J(a)?a.invert():void B("invert expects a matrix")}function na(a){if(!H(a.power)&&a.power.absEquals(.5)){var b=a.power.sign();return G(a.toLinear()).setPower(new qa(b))}return a}function pa(a){if(a.group===j){var b=a.group===i?a.multiplier.toDecimal():a.value,c=sa(b)[0],d=new qa(Math.log(b)/Math.log(c)),e=d.multiply(a.power);if(e.den>a.power.den)return a;a=M(e)?ra(Math.pow(c,e)):new ra(c).setPower(e)}return a}var a=this,b={},c=this.constants={PI:Math.PI,E:Math.E},d=this.operators={"!":new ta("!","factorial",5,!1,!1,!0),"^":new ta("^","pow",4,!1,!1),"*":new ta("*","multiply",3,!0,!1),"/":new ta("/","divide",3,!0,!1),"+":new ta("+","add",2,!0,!0),"-":new ta("-","subtract",2,!0,!0),",":new ta(",","comma",1,!0,!1)},e=this.functions={cos:[R,1],sin:[T,1],tan:[V,1],sec:[W,1],csc:[X,1],cot:[Y,1],acos:[,1],asin:[,1],atan:[,1],sinh:[,1],cosh:[,1],tanh:[,1],asinh:[,1],acosh:[,1],atanh:[,1],log10:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceil:[,1],Si:[,1],Ci:[,1],fib:[,1],fact:[E,1],factorial:[E,1],round:[,1],mod:[F,2],pfactor:[N,1],vector:[ea,-1],matrix:[fa,-1],parens:[C,-1],sqrt:[G,1],log:[O,1],expand:[Z,1],abs:[D,1],invert:[ka,1],transpose:[ja,1],dot:[ha,2],cross:[ia,2],vecget:[_,2],vecset:[aa,3],matget:[ca,3],matset:[da,4],imatrix:[$,1]},f={},g=function(a){return a[a.length-1]},q="(",w=")",y="[",z="]",A=[];f[q]=q,f[w]=w,f[y]=y,f[z]=z,this.error=B,this.override=function(a,c){b[a]||(b[a]=[]),b[a].push(this[a]),this[a]=c},this.restore=function(a){this[a]&&(this[a]=b[a].pop())},this.extend=function(a,b,c){var d=this,e=this[a];if("function"==typeof e&&"function"==typeof b){var f=this[a];this[a]=function(a,e){return H(a)&&H(e)&&!c?f.call(d,a,e):b.call(d,a,e,f)}}},this.symfunction=function(a,b){var c=new ra(a);return c.group=m,"object"==typeof b&&(b=[].slice.call(b)),c.args=b,c.fname=a===r?"":a,c.updateHash(),c},this.callfunction=function(a,b){var c=e[a];if(!c)throw new Error(a+" is not a supported function.");var g,d=c[1],f=c[0];if(b instanceof Array||(b=void 0!==b?[b]:[]),d!==-1){var j=L(d),k=j?d[0]:d,l=j?d[1]:d,m=b.length,n=a+" requires a {0} of {1} arguments. {2} provided!";m<k&&B(S(n,"minimum",k,m)),m>l&&B(S(n,"maximum",l,m))}if(f)g=f.apply(c[2]||this,b);else if(h.PARSE2NUMBER)try{b=b.map(function(a){return a.group===i?a.multiplier.toDecimal():void B("Symbol must be of group N.")});var o=a in Math?Math[a]:la[a];g=new ra(o.apply(void 0,b))}catch(c){g=this.symfunction(a,b)}else g=this.symfunction(a,b);return g},this.parse=function(b,e){b=String(b).split(" ").join("").replace(/\d*\.*\d+e[\+\-]*\d+/gi,function(a,b,c){return/[a-z_]/.test(c.charAt(b-1))?a:(A.push(a),"&")}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(){var a=arguments[4],b=arguments[1],c=arguments[2],d=arguments[3],e=a.charAt(d),f="",g="*";return e.match(/[\+\-\/\*]/)||(f=a.charAt(d-1)),f.match(/[a-z]/i)&&(g=""),b+g+c}).replace(/\)\(/g,")*(")||"0";var m,n,o,h=e||{},i=[],j=[],k=b.length,l=0,p=!1,r=!1,t=0,u=function(b){b||(b=i.pop());var c=j.pop(),d=j.pop();if(b||d||!c)if(b===q)p&&B("Unmatched open parenthesis!"),i.push(b),v(d),v(c);else{var f,e=b.fn;if(e)f=a[e].call(a,d,c);else{for(f=b.resolve(c);d&&g(i)instanceof ua;)f=i.pop().resolve(f);d&&v(d)}v(f)}else v(c)},v=function(a){if(/&/.test(a)&&(a=A.shift()),""!==a&&void 0!==a){if(!(a instanceof Array||a instanceof ra||Q(a))){var c=h[a]||x[a];a=c?c.clone():new ra(a)}for(;g(i)instanceof ua;){if(r){var e=d[b.charAt(t+1)];if(e&&!e.left_assoc)break}if(E&&!E.left_assoc)break;var f=i.pop();a=f.resolve(a)}j.push(a),r=!1}};if(!h["~"])for(var C in c)h[C]=new ra(c[C]);for(t=0;t<k;t++){var D=b.charAt(t),E=D in d?d[D]:void 0,F=D in f?f[D]:void 0;if(E||F){var G=b.substring(l,t),H=F===y,I=b.charAt(t+1),J=I in d?d[I]:void 0;if(J){var K=D+I,L=K in d?d[K]:void 0;L&&(E=L,t++)}if(F===q&&G||H){H&&G&&v(G);var M=H?s:G;i.push(new oa(M),q),l=t+1,m=t;continue}if(v(G),!F&&(t-m===1||0===t)){if(E.is_prefix){i.push(new ua(E.val)),l=t+1,m=t;continue}B(E.val+" is not a valid prefix operator!:"+l)}if(D!==w&&(m=t),E&&!E.left_assoc&&E.is_postfix&&(j.push(a[E.fn](j.pop())),E=d[b.charAt(++t)],!E)){if(t===k)break;t--}if(E){if(n&&(E.left_assoc&&E.precedence<=n.precedence||!E.left_assoc&&E.precedence<n.precedence)){var N=!1;do{u();var O=g(i);if(O===q)break;N=!O||O.left_assoc&&O.precedence<E.precedence}while(!N)}i.push(E),n=g(i)}else{if(D===q)i.push(F);else if(D===w||D===z){m=null;for(var P=!1;!P;){var R=i.pop();if(void 0===R&&B("Unmatched close bracket or parenthesis!"),R===q?P=!0:u(R),R===q&&D===z){var S=g(i);S&&S.name===s||B("Unmatched parenthesis!")}}var T=g(i);if(T instanceof oa){T.name===s&&D!==z&&D!==w&&B("Unmatched bracket!");var U=a.callfunction(i.pop().name,j.pop());r=!0,v(U)}}n=g(i)}l=t+1}else t===k-1&&v(b.substring(l,t+1));o=D}for(p=!0;i.length>0;)u();return j[0]},this.expand=Z,this.ext={log:O,sqrt:G,abs:D,vector:ea,matrix:fa,parens:C,determinant:ga,dot:ha,invert:ka,transpose:ja},this.mapped_function=function(){for(var b={},c=this.params,d=0;d<c.length;d++)b[c[d]]=arguments[d];return a.parse(this.body,b)},this.add=function(b,c){var d=H(b),e=H(c);if(d&&e){if(b.multiplier.equals(0))return c;if(c.multiplier.equals(0))return b;if(b.isConstant()&&c.isConstant()&&h.PARSE2NUMBER)return new ra(b.multiplier.add(c.multiplier).valueOf());var f=b.group,g=c.group,q=b.power.toString(),r=c.power.toString();if(f<g||f===g&&q>r&&r>0)return this.add(c,b);if(f===o&&g===n&&b.value===c.value){var s=b;b=c,c=s,f=b.group,g=c.group,q=b.power.toString(),r=c.power.toString()}var z,A,C,u=q===r,v=b.value,w=c.value,x=b.isComposite(),y=c.isComposite();if(x&&(z=ma(b,"hash")),y&&(A=ma(c,"hash")),f===p&&g===p&&c.isLinear()&&!b.isLinear())return this.add(b,c);f===n&&g===n&&(v=z,w=A);var D=f===j&&g===i,E=b.value===c.multiplier.toString(),F=v===w||z===A&&void 0===!z||D&&E;if(F&&u&&f===g)if(D&&(c=c.convert(j)),f!==n||g!==k&&g!==j)if(C=b,b.multiplier.isOne()&&c.multiplier.isOne()&&f===p)for(var K in c.symbols){var L=c.symbols[K];C.attach(L)}else C.multiplier=C.multiplier.add(c.multiplier);else b.distributeMultiplier(),C=b.attach(c);else if(F&&f!==n)C=ra.shell(n).attach([b,c]),C.value=f===n?z:v;else if(x&&b.isLinear()){var M=f===g,N=f===n&&g===n;if(N&&(M=b.value===c.value),b.distributeMultiplier(),c.isComposite()&&c.isLinear()&&M){c.distributeMultiplier();for(var K in c.symbols){var L=c.symbols[K];b.attach(L)}C=b}else N&&b.value!==A||f===n&&!F?(C=ra.shell(p).attach([b,c]),C.updateHash()):C=b.attach(c)}else{if(f===m&&b.fname===t&&g!==l&&c.power.equals(.5)){var O=c.multiplier.clone();c=G(c.toUnitMultiplier().toLinear()),c.multiplier=O}C=ra.shell(p).attach([b,c]),C.updateHash()}if(C.multiplier.equals(0)&&(C=new ra(0)),1===C.length){var O=C.multiplier;C=U(C.symbols),C.multiplier=C.multiplier.multiply(O)}return C}if(e&&!d){var s=b;b=c,c=s,s=e,e=d,d=s}var P=J(c);if(d&&P)c.eachElement(function(c){return a.add(b.clone(),c)});else if(J(b)&&P)c=b.add(c);else if(d&&I(c))c.each(function(d,e){e--,c.elements[e]=a.add(b.clone(),c.elements[e])});else if(I(b)&&I(c))c.each(function(d,e){e--,c.elements[e]=a.add(b.elements[e],c.elements[e])});else{if(I(b)&&J(c))return a.add(c,b);if(J(b)&&I(c)){if(c.elements.length===b.rows()){var Q=new za,R=b.cols();return c.each(function(c,d){for(var e=[],f=0;f<R;f++)e.push(a.add(b.elements[d-1][f].clone(),c.clone()));Q.elements.push(e)}),Q}B("Dimensions must match!")}}return c},this.subtract=function(b,c){var f,d=d=H(b),e=H(c);if(d&&e)return this.add(b,c.negate());if(e&&(f=c,c=b,b=f,d=e),d&&I(c))c=c.map(function(c){return a.subtract(c,b.clone())});else if(I(b)&&I(c))b.dimensions()===c.dimensions()?c=b.subtract(c):a.error("Unable to subtract vectors. Dimensions do not match.");else if(J(b)&&I(c)){if(c.elements.length===b.rows()){var g=new za,h=b.cols();return c.each(function(c,d){for(var e=[],f=0;f<h;f++)e.push(a.subtract(b.elements[d-1][f].clone(),c.clone()));g.elements.push(e)}),g}B("Dimensions must match!")}else{if(I(b)&&J(c)){var g=c.clone().negate();return a.add(g,b)}J(b)&&J(c)&&(c=b.subtract(c))}return c},this.multiply=function(b,c){var d=H(b),e=H(c);if(d&&e){if(b.isConstant()&&c.isConstant()&&h.PARSE2NUMBER)return new ra(b.multiplier.multiply(c.multiplier).valueOf());if(b.isOne())return c.clone();if(c.isOne())return b.clone();if(b.multiplier.equals(0)||c.multiplier.equals(0))return new ra(0);if(c.group>b.group&&c.group!==p)return this.multiply(c,b);if(b.group===o&&c.group===n&&b.value===c.value){var f=b;b=c,c=f}var g=b.group,q=c.group,r=c.multiplier.num,s=c.multiplier.den;if(g===m&&b.fname===t&&!c.isConstant()&&b.args[0].value===c.value){var u=b.power;b=b.args[0].clone(),b.setPower(new qa(.5).multiply(u)),g=b.group}var v=b.value,w=c.value,x=new qa(b.multiplier.lessThan(0)?-1:1),y=g===j&&q===i&&c.multiplier.equals(b.value),z=y?new qa(1).multiply(b.multiplier).abs():b.multiplier.multiply(c.multiplier).abs(),A=b.clone().toUnitMultiplier();if(c=c.clone().toUnitMultiplier(!0),v===w&&g===n&&g===q&&(v=b.text("hash"),w=c.text("hash")),q===l&&c.previousGroup===n&&g===n&&(v=ma(b,"hash",l)),v!==w&&!y||g===n&&(q===k||q===j||q===m)||g===n&&q===o)if(g===o&&b.isLinear())if(q===o&&c.distributeExponent(),q===o&&c.isLinear()){for(var L in c.symbols){var N=c.symbols[L];A=A.combine(N)}A.multiplier=A.multiplier.multiply(c.multiplier)}else A.combine(c);else g!==i?g===o?(A.distributeExponent(),A.combine(c)):c.isOne()||(A=ra.shell(o).combine([A,c])):A=c.clone().toUnitMultiplier();else{var C=b.power,D=c.power,E=H(C),F=H(D),G=E||F;if(A.power=G?a.add(H(C)?C:new ra(C),H(D)?D:new ra(D)):g===i?C:C.add(D),A.power.equals(0)&&(A=A.convert(i)),G&&A.convert(l),b.imaginary&&c.imaginary){var K=ba(A.power%2);K&&(A=new ra(1),z.negate())}A.group!==l&&A.previousGroup&&(A.previousGroup=void 0),A.multiplier=A.multiplier.multiply(c.multiplier)}if(A.group===j){var O=Math.log(A.value),P=Math.log(r)/O,Q=Math.log(s)/O,R=z.num/r,S=z.den/s;0!==P&&M(P)&&M(R)&&(A.power=A.power.add(new qa(P)),z.num/=r),0!==Q&&M(Q)&&M(S)&&(A.power=A.power.subtract(new qa(Q)),z.den/=s)}if(1===A.length){var f=A.multiplier;A=U(A.symbols),A.multiplier=A.multiplier.multiply(f)}var T=A.power.toString();if(ba(T)&&A.fname===t){var V=A.power;A=A.args[0],A=a.multiply(new ra(z),a.pow(A,new ra(V.divide(new qa(2)))))}else A.multiplier=A.multiplier.multiply(z).multiply(x);return A.group===j&&M(A.power.toDecimal())&&(A=A.convert(i)),A}e&&!d&&(f=b,b=c,c=f,f=e,e=d,d=f);var W=J(c),X=J(b);if(d&&W)c.eachElement(function(c){return a.multiply(b.clone(),c)});else if(X&&W)c=b.multiply(c);else if(d&&I(c))c.each(function(d,e){e--,c.elements[e]=a.multiply(b.clone(),c.elements[e])});else if(I(b)&&I(c))c.each(function(d,e){e--,c.elements[e]=a.multiply(b.elements[e],c.elements[e])});else{if(I(b)&&J(c))return this.multiply(c,b);if(J(b)&&I(c)){if(c.elements.length===b.rows()){var Y=new za,Z=b.cols();return c.each(function(c,d){for(var e=[],f=0;f<Z;f++)e.push(a.multiply(b.elements[d-1][f].clone(),c.clone()));Y.elements.push(e)}),Y}B("Dimensions must match!")}}return c},this.divide=function(b,c){var d=H(b),e=H(c);if(d&&e){var f;return b.isConstant()&&c.isConstant()?(c.equals(0)&&B("Division by zero not allowed!"),f=b.clone(),f.multiplier=f.multiplier.divide(c.multiplier)):(c.invert(),f=a.multiply(b,c)),f}var g=I(b),h=I(c);if(d&&h)c=c.map(function(c){return a.divide(b.clone(),c)});else if(g&&e)c=b.map(function(b){return a.divide(b,c.clone())});else if(g&&h)b.dimensions()===c.dimensions()?c=c.map(function(c,d){return a.divide(b.elements[--d],c)}):a.error("Cannot divide vectors. Dimensions do not match!");else{var i=J(b),j=J(c);i&&e?(b.eachElement(function(b){return a.divide(b,c.clone())}),c=b):i&&j?b.rows()===c.rows()&&b.cols()===c.cols()?b.eachElement(function(b,d,e){return a.divide(b,c.elements[d][e])}):a.error("Dimensions do not match!"):i&&h&&(b.cols()===c.dimensions()?(b.eachElement(function(b,d,e){return a.divide(b,c.elements[d].clone())}),c=b):a.error("Unable to divide matrix by vector."))}return c},this.pow=function(b,c){var d=H(b),e=H(c);if(d&&e){b.equals(0)&&c.equals(0)&&B("0^0 is undefined!");var f=c.isConstant(),g=b.isConstant(),j=c.isInteger(),k=b.multiplier,n=b.clone();if(n.toUnitMultiplier(),n.group!==m||n.fname!==t||f)n.multiplyPower(c);else{var o=n.args[0];o.multiplyPower(new ra(.5)),o.multiplier.multiply(n.multiplier),o.multiplyPower(c),n=o}if(g&&f&&h.PARSE2NUMBER){var p=b.multiplier.toDecimal(),q=c.multiplier.toDecimal(),r=new ra(1);if(c.multiplier.den.isOdd()){var s=Math.abs(p);r=new ra(p/s),p=s}ba(q)&&(r=new ra(1)),n=a.multiply(new ra(Math.pow(p,q)),r)}else if(j&&!k.equals(1)){var v=c.multiplier.toDecimal(),w=new qa(Math.pow(k.num,v)/Math.pow(k.den,v));n.multiplier=n.multiplier.multiply(w)}else{var r=Math.sign(k.num),x=b.group===i&&r<0,y=na(new ra(x?k.num:Math.abs(k.num)).setPower(c.clone())),z=na(new ra(k.den).setPower(c.clone()).invert());if(b.imaginary){var A=c.multiplier.multiply(qa.quick(1,2)),C=Math.pow(-1,A.num);n=ba(A.den)?new ra(-1).setPower(A,!0):new ra(C)}if(r<0&&!x&&n.negate(),n=a.multiply(n,pa(a.multiply(y,z))),f&&b.group!==l){var D=ba(c.multiplier.den),E=ba(b.power),F=n.power.toDecimal(),G=ba(F);if(D&&E&&!G)if(1===F)n=a.symfunction(u,[n]);else if(M(F))n=a.multiply(a.symfunction(u,[n.clone().toLinear()]),n.clone().setPower(new qa(F-1)));else{var v=n.power;n=a.symfunction(u,[n.toLinear()]).setPower(v)}}}if(n=na(n),n.fname===t){var K=n.group===l,L=K?n.power.multiplier.toString():n.power.toString();if(ba(L)){var N=K?a.divide(n.power,new ra(2)):new ra(n.power.divide(new qa(2))),k=n.multiplier;n=a.pow(n.args[0],N),n.multiplier=n.multiplier.multiply(k)}}else if(n.isE()&&n.group===l&&n.power.contains("pi")&&n.power.contains(h.IMAGINARY)){var O=n.multiplier,P=n.power.multiplier;n=new ra(ba(P)?O:O.negate())}return n}return I(b)&&e?b=b.map(function(b){return a.pow(b,c.clone())}):J(b)&&e&&b.eachElement(function(b){return a.pow(b,c.clone())}),b},this.comma=function(a,b){return a instanceof Array?a.push(b):a=[a,b],a},this.factorial=function(a){return this.symfunction(v,[a])}}function ya(a){I(a)?this.elements=a.items.slice(0):L(a)?this.elements=a.slice(0):this.elements=[].slice.call(arguments)}function za(){var c,a=arguments,b=a.length,d=[];if(J(a))for(c=0;c<b;c++)d.push(a[c].slice(0));else{var e,f,g;for(c=0;c<b;c++)e=a[c],I(e)&&(e=e.elements),L(e)||(e=[e]),g=e.length,f&&f!==g&&B("Unable to create Matrix. Row dimensions do not match!"),d.push(e),f=g}this.elements=d}var b="0.6.6",c=new va,d=a.bigInt,e={},f=[],g={},h={init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i"},i=e.N=1,j=e.P=2,k=e.S=3,l=e.EX=4,m=e.FN=5,n=e.PL=6,o=e.CB=7,p=e.CP=8,q=h.CONST_HASH="#",r=h.PARENTHESIS="parens",s=h.VECTOR="vector",t=h.SQRT="sqrt",u=h.ABS="abs",v=h.FACTORIAL="fact",w=[],x={},y=[],z="",A=g.isReserved=function(a){return y.indexOf(a)!==-1},B=function(a){if(!h.suppress_errors)throw new Error(a)},D=g.validateName=function(a,b){b=b||"variable";var c=/^[a-z_][a-z\d\_]*$/gi;if(!c.test(a))throw new Error(a+" is not a valid "+b+" name")},F=(g.intersection=function(a,b,c){var d=[];if(a.length>b.length){var e=a;a=b,b=e}b=b.slice();for(var f=a.length,g=b.length,h=0;h<f;h++)for(var i=a[h],j=0;j<g;j++){var k=b[j];if(void 0!==k){var l=c?c(i,k):i===k;l&&(b[j]=void 0,d.push(i))}}return d},g.isPrime=function(a){for(var b=Math.floor(Math.sqrt(a)),c=2;c<=b;c++)if(a%c===0)return!1;return!0}),G=g.isFraction=function(a){return H(a)?G(a.multiplier.toDecimal()):a%1!==0},H=g.isSymbol=function(a){return a instanceof ra},I=g.isVector=function(a){return a instanceof ya},J=g.isMatrix=function(a){return a instanceof za},K=g.isNumericSymbol=function(a){return a.group===i},L=g.isArray=function(a){return a instanceof Array},M=g.isInt=function(a){return a%1===0},N=g.isNegative=function(a){return H(a)&&(a=a.multiplier),a.lessThan(0)},O=g.inBrackets=function(a){return"("+a+")"},Q=(g.stringReplace=function(a,b,c,d){return a.substr(0,b)+d+a.substr(c,a.length)},g.customType=function(a){return void 0!==a&&a.custom}),S=(g.sameSign=function(a,b){return a<0==b<0},g.format=function(){var a=[].slice.call(arguments),b=a.shift(),c=b.replace(/{(\d+)}/g,function(b,c){var d=a[c];return"function"==typeof d?d():d});return c}),T=g.keys=Object.keys,U=g.firstObject=function(a){for(var b in a)break;return a[b]},_=(g.compare=function(a,b,d){for(var g,e=5,f={},h=0;h<d.length;h++)f[d[h]]=new ra(Math.floor(Math.random()*e)+1);return ga("PARSE2NUMBER",function(){g=c.parse(a,f).equals(c.parse(b,f))}),g},g.arrayMax=function(a){return Math.max.apply(void 0,a)},g.arrayMin=function(a){return Math.min.apply(void 0,a)},g.arrayClone=function(a){for(var b=[],c=a.length,d=0;d<c;d++)b[d]=a[d].clone();return b},g.comboSort=function(a,b){for(var c=a.length,d=[],e=0;e<a.length;e++)d.push([a[e],b[e]]);d.sort(function(a,b){return a[0]-b[0]});var f=[],g=[];for(e=0;e<c;e++)f.push(d[e][0]),g.push(d[e][1]);return[f,g]},g.round=function(a,b){return b=b||14,Math.round(a*Math.pow(10,b))/Math.pow(10,b)},g.variables=function(a,b,c){if(c=c||{c:[],add:function(a){this.c.indexOf(a)===-1&&isNaN(a)&&this.c.push(a)}},H(a)){var d=a.group,e=a.previousGroup;if(d===l&&_(a.power,b,c),d===p||d===o||e===p||e===o)for(var f in a.symbols)_(a.symbols[f],b,c);else if(d===k||e===k)"e"!==a.value&&"pi"!==a.value&&c.add(a.value);else if(d===n||e===n)_(U(a.symbols),b,c);else if(d===l)isNaN(a.value)||c.add(a.value),_(a.power,b,c);else if(d===m&&!b)for(var g=0;g<a.args.length;g++)_(a.args[g],b,c)}return c.c.sort()}),aa=g.each=function(a,b){if(L(a))for(var c=a.length,d=0;d<c;d++)b.call(a,d);else for(var e in a)a.hasOwnProperty(e)&&b.call(a,e)},ba=g.even=function(a){return a%2===0},da=(g.evenFraction=function(a){return 1/(a%1)%2===0},g.arrayUnique=function(a){for(var b=a.length,c=[],d=0;d<b;d++){var e=a[d];c.indexOf(e)===-1&&c.push(e)}return c}),ea=g.reserveNames=function(a){var b=function(a){y.indexOf(a)===-1&&y.push(a)};"string"==typeof a?b(a):aa(a,function(a){b(a)})},fa=g.remove=function(a,b){var c;return L(a)?c=a.splice(b,1)[0]:(c=a[b],delete a[b]),c},ga=g.block=function(a,b,c,d){var e=h[a];h[a]=void 0===c||!!c;var f=b.call(d);return h[a]=e,f},ja=(g.arguments2Array=function(a){return[].slice.call(a)},function(a){for(var b in a)a[b]=c.parse(a[b].toString());return a}),ka=g.generatePrimes=function(a){for(var b=f[f.length-1]||2,c=b;c<a;c++)F(c)&&f.push(c)},la={csc:function(a){return 1/Math.sin(a)},sec:function(a){return 1/Math.cos(a)},cot:function(a){return 1/Math.tan(a)},erf:function(a){function d(a){var d=1;a<0&&(d=-1),a=Math.abs(a);var e=1/(1+c*a),f=1-((((b[4]*e+b[3])*e+b[2])*e+b[1])*e+b[0])*e*Math.exp(-a*a);return d*f}var b=[.254829592,-.284496736,1.421413741,-1.453152027,1.061405429],c=.3275911;return d(a)},gamma:function(a){var b=7,c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019571e-21,1.5056327351493116e-7];if(a<.5)return Math.PI/(Math.sin(Math.PI*a)*gamma(1-a));a-=1;for(var d=c[0],e=1;e<b+2;e++)d+=c[e]/(a+e);var f=a+b+.5;return Math.sqrt(2*Math.PI)*Math.pow(f,a+.5)*Math.exp(-f)*d},fact:function(a){for(var b=1,c=2;c<=a;c++)b*=c;return b},GCD:function(){for(var a=da([].slice.call(arguments).map(function(a){return Math.abs(a)})).sort(),b=Math.abs(a.shift()),c=a.length;c-- >0;)for(var d=Math.abs(a.shift());;){if(b%=d,0===b){b=d;break}if(d%=b,0===d)break}return b},QGCD:function(){for(var a=[].slice.call(arguments),b=a[0],c=1;c<a.length;c++){var d=a[c],e=b.isNegative()&&d.isNegative()?-1:1;b=d.gcd(b),e<0&&b.negate()}return b},LCM:function(a,b){return a*b/la.GCD(a,b)},pow:function(a,b){return a<0&&Math.abs(b)<1?1/b%2===0?NaN:-Math.pow(Math.abs(a),b):Math.pow(a,b)},ifactor:function(a,b){b=b||{};var c=Math.floor(Math.sqrt(a)),d=f[f.length-1];c>d&&a<1e6&&ka(c);for(var e=f.length,g=0;g<e;g++)for(var h=f[g];a%h===0;)a/=h,b[h]=(b[h]||0)+1;return a>1&&(b[a]=1),b},boxfactor:function(a,b){b=b||200;for(var c,d,e=Math.floor(5/12*a),f=0,g=!1;;){if(c=Math.floor(a/e),d=a%e,0===d)break;if(g)return[a,1];e=Math.max(d,e-d),f++,g=f>b}return[c,e,f]},fib:function(a){for(var b=0,c=1,d=1,e=2;e<=a;e++)d=b+c,b=c,c=d;return d},mod:function(a,b){return a%b},Ci:function(a){for(var b=20,c=.5772156649015329,d=0,e=1;e<b;e++){var f=2*e;d+=Math.pow(-1,e)*Math.pow(a,f)/(f*la.fact(f))}return Math.log(a)+c+d},Si:function(a){for(var b=20,c=0,d=0;d<b;d++){var e=2*d;c+=Math.pow(-1,d)*Math.pow(a,e+1)/((e+1)*la.fact(e+1))}return c}};Math.sign=Math.sign||function(a){return a=+a,0===a||isNaN(a)?a:a>0?1:-1},Math.cosh=Math.cosh||function(a){var b=Math.exp(a);return(b+1/b)/2},Math.sinh=Math.sinh||function(a){var b=Math.exp(a);return(b-1/b)/2},Math.tanh=Math.tanh||function(a){if(a===1/0)return 1;if(a===-(1/0))return-1;var b=Math.exp(2*a);return(b-1)/(b+1)},Math.asinh=Math.asinh||function(a){return a===-(1/0)?a:Math.log(a+Math.sqrt(a*a+1))},Math.acosh=Math.acosh||function(a){return Math.log(a+Math.sqrt(a*a-1))},Math.atanh=Math.atanh||function(a){return Math.log((1+a)/(1-a))/2},Math.log10=Math.log10||function(a){return Math.log(a)*Math.LOG10E},ea(la),g.text=ma,pa.getExpression=function(a,b){"last"!==a&&a||(a=w.length),"first"===a&&(a=1);var c=a-1,d=w[c],e=d?new pa(d):d;return e},pa.prototype={text:function(a){return a=a||"decimals",ma(this.symbol,a)},latex:function(a){return xa.latex(this.symbol,a)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var b,a=arguments[0],d=1;"string"==typeof a?b="%"===a.charAt(0)?pa.getExpression(a.substr(1)).text():a:a instanceof pa||H(a)?b=a.text():(b=this.symbol.text(),d--);var e=arguments[d]||{};return e.e=c.constants.E,e.pi=c.constants.PI,new pa(ga("PARSE2NUMBER",function(){return c.parse(b,ja(e))},!0))},buildFunction:function(a){return Ba(this.symbol,a)},isNumber:function(){return K(this.symbol)},isInfinity:function(){return Math.abs(this.symbol.multiplier)===1/0},variables:function(){return _(this.symbol)},toString:function(){try{return L(this.symbol)?"["+this.symbol.toString()+"]":this.symbol.toString()}catch(a){return""}},toDecimal:function(){
return this.symbol.toDecimal()},isFraction:function(){return G(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()},sub:function(a,b){return new pa(this.symbol.sub(c.parse(a),c.parse(b)))}},pa.prototype.toTeX=pa.prototype.latex,qa.isFrac=function(a){return a instanceof qa},qa.quick=function(a,b){var c=new qa;return c.num=new d(a),c.den=new d(b),c},qa.prototype={multiply:function(a){if(this.isOne())return a.clone();if(a.isOne())return this.clone();var b=this.clone();return b.num=b.num.multiply(a.num),b.den=b.den.multiply(a.den),b.simplify()},divide:function(a){if(a.equals(0))throw new Error("Division by zero not allowed!");return this.clone().multiply(a.clone().invert()).simplify()},subtract:function(a){return this.clone().add(a.clone().neg())},neg:function(){return this.num=this.num.multiply(-1),this},add:function(a){var b=this.den,c=a.den,d=this.clone(),e=d.num,f=a.num;return b.equals(c)?d.num=e.add(f):(d.num=e.multiply(c).add(f.multiply(b)),d.den=b.multiply(c)),d.simplify()},mod:function(a){var b=this.clone(),c=a.clone();return b.num=b.num.multiply(c.den),b.den=b.den.multiply(c.den),c.num=c.num.multiply(this.den),c.den=c.den.multiply(this.den),b.num=b.num.mod(c.num),b.simplify()},simplify:function(){var a=d.gcd(this.num,this.den);return this.num=this.num.divide(a),this.den=this.den.divide(a),this},clone:function(){var a=new qa;return a.num=new d(this.num),a.den=new d(this.den),a},toDecimal:function(){return this.num/this.den},qcompare:function(a){return[this.num.multiply(a.den),a.num.multiply(this.den)]},equals:function(a){isNaN(a)||(a=new qa(a));var b=this.qcompare(a);return b[0].equals(b[1])},absEquals:function(a){isNaN(a)||(a=new qa(a));var b=this.qcompare(a);return b[0].abs().equals(b[1])},greaterThan:function(a){isNaN(a)||(a=new qa(a));var b=this.qcompare(a);return b[0].gt(b[1])},lessThan:function(a){isNaN(a)||(a=new qa(a));var b=this.qcompare(a);return b[0].lt(b[1])},isInteger:function(){return this.den.equals(1)},negate:function(){return this.num=this.num.multiply(-1),this},invert:function(){var a=this.den,b=this.num.isNegative();return this.den=this.num.abs(),this.num=a,b&&(this.num=this.num.multiply(-1)),this},isOne:function(){return this.num.equals(1)&&this.den.equals(1)},sign:function(){return this.num.isNegative()?-1:1},abs:function(){return this.num=this.num.abs(),this},gcd:function(a){return qa.quick(d.gcd(a.num,this.num),d.lcm(a.den,this.den))},toString:function(){return this.den.equals(1)?String(this.num):this.num+"/"+this.den},valueOf:function(){return this.num/this.den},isNegative:function(){return this.toDecimal()<0}},ra.imaginary=function(){var a=new ra(h.IMAGINARY);return a.isImaginary=!0,a},ra.shell=function(a,b){var c=new ra(b);return c.group=a,c.symbols={},c.length=0,c},ra.unwrapSQRT=function(a,b){var c=a.power;if(a.fname===t&&(a.isLinear()||b)){var d=a.args[0].clone();d.power=d.power.multiply(new qa(.5)),d.multiplier=d.multiplier.multiply(a.multiplier),a=d,b&&(a.power=c.multiply(new qa(.5)))}return a},ra.prototype={equals:function(a){return H(a)||(a=new ra(a)),this.value===a.value&&this.power.equals(a.power)&&this.multiplier.equals(a.multiplier)},isPoly:function(a){var b=this.group,c=this.power;if(!M(c)||c<0)return!1;if(b===i||b===k)return!0;if(!(this.isComposite()||b===o&&a))return!1;if(!a&&_(this)>1)return!1;for(var d in this.symbols)if(!this.symbols[d].isPoly(a))return!1;return!0},stripVar:function(a){var b;return this.group!==n&&this.group!==k||this.value!==a?this.group===o&&this.isLinear()?(b=new ra(1),this.each(function(d){d.contains(a,!0)||(b=c.multiply(b,d.clone()))}),b.multiplier=b.multiplier.multiply(this.multiplier)):this.group!==p||this.isLinear()?this.group===p&&this.isLinear()?(b=new ra(0),this.each(function(d){if(!d.contains(a)){var e=d.clone();e.multiplier=e.multiplier.multiply(this.multiplier),b=c.add(b,e)}})):b=this.group===m&&this.contains(a)?new ra(this.multiplier):this.clone():b=new ra(this.multiplier):b=new ra(this.multiplier),b},toArray:function(a,b){b=b||{arr:[],add:function(a,b){var d=this.arr[b];this.arr[b]=d?c.add(d,a):a}};var d=this.group;if(d===k&&this.contains(a))b.add(new ra(this.multiplier),this.power);else if(d===o){var e=this.stripVar(a),f=c.divide(this.clone(),e.clone()),g=f.isConstant()?0:f.power;b.add(e,g)}else if(d===n&&this.value===a)this.each(function(c,d){b.add(c.stripVar(a),d)});else if(d===p)this.each(function(c){c.toArray(a,b)});else{if(this.contains(a))throw new Error("Cannot convert to array! Exiting");b.add(this.clone(),0)}b=b.arr;for(var h=0;h<b.length;h++)b[h]||(b[h]=new ra(0));return b},hasFunc:function(){if(this.group===m||this.group===l)return!0;if(this.symbols)for(var a in this.symbols)if(this.symbols[a].hasFunc())return!0;return!1},sub:function(a,b){var d=this.group,e=a.group;if(d===e&&this.equals(a))return b.clone();var f;if(d===e&d===k&&a.isLinear()&&this.value===a.value)f=b.clone(),f.multiplier=this.multiplier.clone(),f.power=this.power.clone(),f=c.parse(f);else if(ma(this,"hash")===ma(a,"hash")){var g=c.divide(c.parse(this.power),c.parse(a.power));M(g)&&(f=b.clone(),f=c.pow(f,c.parse(g)),f.multiplier=f.multiplier.multiply(this.multiplier))}else if(this.symbols){f=this.clone();var h=this.isComposite()?"attach":"combine";f.symbols={},this.each(function(c){var d=c.sub(a,b);f[h](d)}),f.updateHash()}else if(d===m){f=this.clone(),f.args=[];for(var i=0;i<this.args.length;i++)f.args[i]=this.args[i].sub(a,b);f.updateHash()}return this.group===l&&(f=f||this.clone(),f.power=f.power.sub(a,b),f=c.parse(f)),f?f:this.clone()},isMonomial:function(){if(this.group===k)return!0;if(this.group!==o)return!1;for(var a in this.symbols)if(this.symbols[a].group!==k)return!1;return!0},isPi:function(){return this.group===k&&"pi"===this.value},sign:function(){return this.multiplier.sign()},isE:function(){return"e"===this.value},isSQRT:function(){return this.fname===t},isConstant:function(){return this.value===q},isInteger:function(){return this.isConstant()&&this.multiplier.isInteger()},isLinear:function(a){if(a){if(this.isConstant())return!0;if(this.group===k)return this.value!==a||this.power.equals(1);if(this.isComposite()&&this.power.equals(1)){for(var b in this.symbols)if(!this.symbols[b].isLinear(a))return!1;return!0}return!(this.group!==o||!this.symbols[a])&&this.symbols[a].isLinear(a)}return this.power.equals(1)},multiplyPower:function(a){if(this.group===i&&this.multiplier.equals(1))return this;var b=this.power;if(this.group!==l&&a.group===i){var d=a.multiplier;this.group!==i||d.isInteger()||this.convert(j),this.power=b.equals(1)?d.clone():b.multiply(d),this.group===j&&M(this.power)&&(this.value=Math.pow(this.value,this.power),this.toLinear(),this.convert(i))}else this.group!==l&&(b=new ra(b),this.convert(l)),this.power=c.multiply(b,a);return this},setPower:function(a,b){if(this.group===i&&this.multiplier.equals(1))return this;if(this.group!==l||H(a)){var c=!1,d=!1;H(a)&&(a.group===i?a=a.multiplier:d=!0);var e=d?l:c?null:j;this.power=a,this.group===i&&e&&this.convert(e,b)}else this.group=this.previousGroup,delete this.previousGroup,this.power=a;return this},isInverse:function(){return this.group===l?this.power.multiplier.lessThan(0):this.power<0},clone:function(a){var e,b=a||new ra(0),c=["value","group","length","previousGroup","imaginary","fname","args"],d=c.length;if(this.symbols){b.symbols={};for(var f in this.symbols)b.symbols[f]=this.symbols[f].clone()}for(e=0;e<d;e++)void 0!==this[c[e]]&&(b[c[e]]=this[c[e]]);return b.power=this.power.clone(),b.multiplier=this.multiplier.clone(),b},toUnitMultiplier:function(a){return this.multiplier.num=new d(this.multiplier.num.isNegative()&&a?-1:1),this.multiplier.den=new d(1),this},toLinear:function(){return this.setPower(new qa(1)),this},each:function(a){if(this.symbols)for(var b in this.symbols)a.call(this,this.symbols[b],b);else a.call(this,this,this.value)},valueOf:function(){return this.group===i?this.multiplier:0===this.power?1:0===this.multiplier?0:ma(this,"decimals")},contains:function(a,b){var c=this.group;if(this.symbols&&c!==l){for(var d in this.symbols)if(this.symbols[d].contains(a,b))return!0}else if(c===m||this.previousGroup===m){for(var e=0;e<this.args.length;e++)if(this.args[e].contains(a,b))return!0}else if(c===l)return!(!b||!this.power.contains(a,b))||this.value===a;return this.value===a},negate:function(){return this.multiplier.negate(),this.group!==p&&this.group!==n||this.distributeMultiplier(),this},invert:function(a){return a||(this.multiplier=this.multiplier.invert()),H(this.power)?this.power.negate():this.power&&this.group!==i&&this.power.negate(),this},distributeMultiplier:function(){if(this.symbols&&this.power.equals(1)&&this.group!==o&&!this.multiplier.equals(1)){for(var a in this.symbols){var b=this.symbols[a];b.multiplier=b.multiplier.multiply(this.multiplier),b.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent:function(){if(1!==this.power){var a=this.power;for(var b in this.symbols){var d=this.symbols[b];d.group===l?d.power=c.multiply(d.power,new ra(a)):this.symbols[b].power=this.symbols[b].power.multiply(a)}this.toLinear()}return this},convert:function(a,b){if(a>m){var c=this.clone();this.symbols={},a===o?c.toUnitMultiplier():this.toUnitMultiplier(),this.group===m&&(c.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[c.keyForGroup(a)]=c,this.group=a,this.length=1}else if(a===l)this.group===i&&this.multiplier.equals(1)||(this.group!==l&&(this.previousGroup=this.group),this.group===i?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=ma(this,"hash"),this.group=l);else if(a===i){var d=this.multiplier.toDecimal();this.symbols&&(this.symbols=void 0),new ra(this.group===j?d*Math.pow(this.value,this.power):d).clone(this)}else a===j&&this.group===i&&("1"!==this.multiplier.den.toString()&&B("Attempting conversion of group N with non-unit denominator!"),this.value=b?this.multiplier.num.toString():Math.abs(this.multiplier.num.toString()),this.toUnitMultiplier(!b),this.group=j);return this},insert:function(a,b){if(H(a)||B("Object "+a+" is not of type Symbol!"),this.symbols){var d=this.group;if(d>m){var e=a.keyForGroup(d),f=e in this.symbols&&this.symbols[e];if("add"===b){var g=e;f?(this.symbols[g]=c.add(f,a),this.symbols[g].multiplier.equals(0)&&(delete this.symbols[g],this.length--,0===this.length&&(this.convert(i),this.multiplier=new qa(0)))):(this.symbols[e]=a,this.length++)}else a.group===j&&M(a.power)&&a.convert(i),a.group!==l?(this.multiplier=this.multiplier.multiply(a.multiplier),a.toUnitMultiplier()):(a.parens=a.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(a.multiplier.clone().abs()),a.toUnitMultiplier(!0)),f&&(a=c.multiply(fa(this.symbols,e),a),a.isConstant()&&(this.multiplier=this.multiplier.multiply(a.multiplier),a=new ra(1)),this.length--),a.isOne(!0)?a.multiplier.lessThan(0)&&this.negate():(this.symbols[e]=a,this.length++);0===this.length&&this.convert(i),this.group!==p&&this.group!==o||this.updateHash()}}return this},attach:function(a){if(L(a)){for(var b=0;b<a.length;b++)this.insert(a[b],"add");return this}return this.insert(a,"add")},combine:function(a){if(L(a)){for(var b=0;b<a.length;b++)this.insert(a[b],"multiply");return this}return this.insert(a,"multiply")},updateHash:function(){if(this.group!==i)if(this.group===m){for(var a="",b=this.args,c=this.fname===r,d=0;d<b.length;d++)a+=(0===d?"":",")+ma(b[d]);var e=c?"":this.fname;this.value=e+(c?a:O(a))}else this.group!==k&&this.group!==n&&(this.value=ma(this,"hash"))},keyForGroup:function(a){var c,b=this.group;if(b===i)c=this.value;else if(b===k||b===j)c=a===n?this.power.toDecimal():this.value;else if(b===m)c=a===n?this.power.toDecimal():ma(this,"hash");else{if(b===n)return c=a===o?ma(this,"hash"):a===p?this.power.equals(1)?this.value:O(ma(this,"hash"))+"^"+this.power.toDecimal():a===n?this.power.toString():this.value;b===p?(a===p&&(c=ma(this,"hash")),c=a===n?this.power.toDecimal():this.value):b===o?c=a===n?this.power.toDecimal():ma(this,"hash"):b===l&&(c=a===n?ma(this.power):ma(this,"hash"))}return c},collectSymbols:function(a,b,c,d){var e=[];if(this.symbols)for(var f in this.symbols){var g=this.symbols[f];!d||g.group!==n&&g.group!==p?e.push(a?a(g,b):g):e=e.concat(g.collectSymbols())}else e.push(this);return null===c&&(c=void 0),e.sort(c)},latex:function(){return xa.latex(this)},text:function(){return ma(this)},isOne:function(a){var b=a?"absEquals":"equals";return this.group===i?this.multiplier[b](1):this.power.equals(0)},isComposite:function(){var a=this.group,b=this.previousGroup;return a===p||a===n||b===n||b===p},isCombination:function(){var a=this.group,b=this.previousGroup;return a===o||b===o},lessThan:function(a){return this.multiplier.lessThan(a)},getDenom:function(){if(this.power.lessThan(0))return this.clone();if(this.group===o)var a=new ra(1);for(var b in this.symbols)this.symbols[b].power<0&&(a=c.multiply(a,this.symbols[b].clone()));return a},getNum:function(){if(this.power.lessThan(0))return new ra(this.multiplier.num);if(this.group===o){var a=new ra(1);for(var b in this.symbols)this.symbols[b].power>0&&(a=c.multiply(a,this.symbols[b].clone()));return a}return this.clone()},toString:function(){return this.text()}},ta.prototype.toString=function(){return this.val},ua.prototype={resolve:function(a){return"-"===this.val?a.negate():a},toString:function(){return this.val}};var wa={convert:function(a,b){var c;if(0===a)c=[0,1];else if(a<1e-6||a>1e20){var d=this.quickConversion(Number(a));if(d[1]<=1e20){var e=Math.abs(a),f=a/e;c=this.fullConversion(e.toFixed((d[1]+"").length-1)),c[0]=c[0]*f}else c=d}else c=this.fullConversion(a);return c},quickConversion:function(a){var b=(a.toExponential()+"").split("e"),c=b[0].split(".")[1],d=c?c.length:0;return[Math.pow(10,d)*b[0],Math.pow(10,Math.abs(b[1])+d)]},fullConversion:function(a){for(var b=!1,c=0,d=1,e=1,f=0,g=0,h=a,i=1e-16;!b;){g++,g>1e4&&(b=!0);var j=Math.floor(h),k=c+j*e,l=d+j*f,m=h-j;m<i&&(b=!0),h=1/m,c=e,d=f,e=k,f=l,(Math.abs(k/l-a)<i||g>30)&&(b=!0)}return[k,l]}},xa={space:"~",dot:" \\cdot ",latex:function(a,b){if(L(a)){for(var c=[],d=0;d<a.length;d++)c.push(this.latex(a[d]));return this.brackets(c.join(", "),"square")}if(J(a)){for(var e="\\begin{pmatrix}\n",d=0;d<a.elements.length;d++){for(var f=[],g=a.elements[d],h=0;h<g.length;h++)f.push(this.latex(g));e+=f.join(" & ")+"\\\\\n"}return e+="\\end{pmatrix}"}a=a.clone();var i="decimal"===b,k=a.power,l=N(k),m=a.multiplier.lessThan(0);if(a.group===j&&i)return String(a.multiplier.toDecimal()*Math.pow(a.value,a.power.toDecimal()));a.multiplier=a.multiplier.abs();var n;if(i){var p=String(a.multiplier.toDecimal());"1"!=p||i||(p=""),n=[p,""]}else n=[a.multiplier.num,a.multiplier.den];var r,q=this.value(a,l,b,m);l&&k.negate(),i?(r=H(k)?xa.latex(k,b):String(k.toDecimal()),"1"==r&&(r="")):r=H(k)?this.latex(k,b):this.formatFrac(k,!0);var s=["",""],t=l?1:0;s[t]=r;var u=(m?"-":"")+this.set(n,q,s,a.group===o);return u.replace(/\+\-/gi,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},value:function(a,b,c,d){var e=a.group,f=a.previousGroup,g=["",""],h=b?1:0;if(e===k||e===j||f===k||f===j||f===i){var n=a.value,q=this.greek[n];q&&(n=q),g[h]=n}else if(e===m||f===m){for(var s,w=[],x=a.fname,y=0;y<a.args.length;y++){var A,z=a.args[y];A="string"==typeof z?z:this.latex(z,c),w.push(A)}if(x===t)g[h]="\\sqrt"+this.braces(w.join(","));else if(x===u)g[h]=this.brackets(w.join(","),"abs");else if(x===r)g[h]=this.brackets(w.join(","),"parens");else if("integrate"===x)g[h]="\\int"+this.braces(w[0])+this.braces("d"+w[1]);else if(x===v){var z=a.args[0];z.power.equals(1)&&(z.isComposite()||z.isCombination())&&(w[0]=this.brackets(w[0])),g[h]=w[0]+"!"}else{var s="\\mathrm"+this.braces(x);g[h]=s+this.brackets(w.join(","),"parens")}}else if(a.isComposite()){for(var B=a.collectSymbols().sort(e===p||f===p?function(a,b){return b.group-a.group}:function(a,b){var c=H(a.power)?-1:a.power,d=H(b.power)?-1:b.power;return d-c}),C=[],D=B.length,y=0;y<D;y++)C.push(xa.latex(B[y],c));var n=C.join("+");g[h]=a.isLinear()&&a.multiplier.equals(1)&&!d?n:this.brackets(n,"parens")}else if(e===o||f===l){var E=[],F=[],G=[],I=[],J=0,K=0,L=function(a,b,c){if(c>1&&b.length>0)for(var d=b.length,e=0;e<d;e++){var f=b[e],g=a[f];/^\\left\(.+\\right\)\^\{.+\}$/g.test(g)||/^\\left\(.+\\right\)$/g.test(g)||(a[f]=xa.brackets(g,"parens"))}return a};a.each(function(b){var e,d=N(b.power);d?(e=xa.latex(b.invert(),c),K++,b.isComposite()&&(1!=a.multiplier.den&&1==Math.abs(b.power)&&(e=xa.brackets(e,"parens")),G.push(E.length)),E.push(e)):(e=xa.latex(b,c),J++,b.isComposite()&&(1!=a.multiplier.num&&1==Math.abs(b.power)&&(e=xa.brackets(e,"parens")),I.push(F.length)),F.push(e))}),L(F,I,J),g[0]=F.join(this.dot),L(E,G,K),g[1]=E.join(this.dot)}return g},set:function(a,b,c,d){var e=function(a){return/^\\left\(.+\\right\)$/.test(a)};if(c&&(c=this.formatP(c)),d){var f=c[0];c[0]=""}b=this.merge(b,c);var g=a[0],h=a[1],i=b[0],j=b[1];i&&1==g&&(g=""),1==h&&(h="");var k=this.join(g,i,e(i)?"":this.dot),l=this.join(h,j,e(j)?"":this.dot);if(k&&l){var m=this.frac(k,l);return d&&f&&(m=this.brackets(m)+f),m}return k},merge:function(a,b){for(var c=[],d=0;d<2;d++)c[d]=a[d]+b[d];return c},join:function(a,b,c){return a||b?a&&!b?a:b&&!a?b:a+c+b:""},formatP:function(a){for(var b=0;b<2;b++){var c=a[b];c&&(a[b]="^"+this.braces(c))}return a},formatFrac:function(a,b){var c=a.num.toString(),d=a.den.toString();return b&&"1"===c&&"1"===d?"":"1"===d?c:this.frac(c,d)},frac:function(a,b){return"\\frac"+this.braces(a)+this.braces(b)},braces:function(a){return"{"+a+"}"},brackets:function(a,b){b=b||"parens";var c={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]},d=c[b];return"\\left"+d[0]+a+"\\right"+d[1]}};ya.arrayPrefill=function(a,b){var c=[];b=b||0;for(var d=0;d<a;d++)c[d]=b;return c},ya.fromArray=function(a){var b=new ya;return b.elements=a,b},ya.prototype={custom:!0,e:function(a){return a<1||a>this.elements.length?null:this.elements[a-1]},set:function(a,b){this.elements[a]=new ra(b)},dimensions:function(){return this.elements.length},modulus:function(){return ga("SAFE",function(){return c.pow(this.dot(this.clone()),new ra(.5))},void 0,this)},eql:function(a){var b=this.elements.length,d=a.elements||a;if(b!==d.length)return!1;do if(Math.abs(c.subtract(this.elements[b-1],d[b-1]).valueOf())>PRECISION)return!1;while(--b);return!0},clone:function(){for(var a=new ya,b=this.elements.length,c=0;c<b;c++)a.elements.push(this.elements[c].clone());return a},map:function(a){var b=[];return this.each(function(c,d){b.push(a(c,d))}),new ya(b)},each:function(a){var d,b=this.elements.length,c=b;do d=c-b,a(this.elements[d],d+1);while(--b)},toUnitVector:function(){return ga("SAFE",function(){var a=this.modulus();return 0===a.valueOf()?this.clone():this.map(function(b){return c.divide(b,a)})},void 0,this)},angleFrom:function(a){return ga("SAFE",function(){var b=a.elements||a,d=this.elements.length;if(d!==b.length)return null;var e=new ra(0),f=new ra(0),g=new ra(0);this.each(function(a,d){e=c.add(e,c.multiply(a,b[d-1])),f=c.add(f,c.multiply(a,a)),g=c.add(g,c.multiply(b[d-1],b[d-1]))}),f=c.pow(f,new ra(.5)),g=c.pow(g,new ra(.5));var h=c.multiply(f,g);if(0===h.valueOf())return null;var i=c.divide(e,h),j=i.valueOf();return j<-1&&(i=-1),j>1&&(i=1),new ra(Math.acos(i))},void 0,this)},isParallelTo:function(a){var b=this.angleFrom(a).valueOf();return null===b?null:b<=PRECISION},isAntiparallelTo:function(a){var b=this.angleFrom(a).valueOf();return null===b?null:Math.abs(b-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(a){var b=this.dot(a);return null===b?null:Math.abs(b)<=Sylvester.precision},add:function(a){return ga("SAFE",function(){var b=a.elements||a;return this.elements.length!==b.length?null:this.map(function(a,d){return c.add(a,b[d-1])})},void 0,this)},subtract:function(a){return ga("SAFE",function(){var b=a.elements||a;return this.elements.length!==b.length?null:this.map(function(a,d){return c.subtract(a,b[d-1])})},void 0,this)},multiply:function(a){return this.map(function(b){return b.clone()*a.clone()})},x:function(a){return this.multiply(a)},dot:function(a){return ga("SAFE",function(){var b=a.elements||a,d=new ra(0),e=this.elements.length;if(e!==b.length)return null;do d=c.add(d,c.multiply(this.elements[e-1],b[e-1]));while(--e);return d},void 0,this)},cross:function(a){var b=a.elements||a;if(3!==this.elements.length||3!==b.length)return null;var d=this.elements;return ga("SAFE",function(){return new ya([c.subtract(c.multiply(d[1],b[2]),c.multiply(d[2],b[1])),c.subtract(c.multiply(d[2],b[0]),c.multiply(d[0],b[2])),c.subtract(c.multiply(d[0],b[1]),c.multiply(d[1],b[0]))])},void 0,this)},max:function(){var d,a=0,b=this.elements.length,c=b;do d=c-b,Math.abs(this.elements[d].valueOf())>Math.abs(a.valueOf())&&(a=this.elements[d]);while(--b);return a},indexOf:function(a){var e,b=null,c=this.elements.length,d=c;do e=d-c,null===b&&this.elements[e].valueOf()===a.valueOf()&&(b=e+1);while(--c);return b},text:function(a){return ma(this)},toString:function(){return this.text()},latex:function(a){var b=[];for(var c in this.elements)b.push(xa.latex.call(xa,this.elements[c],a));return"["+b.join(", ")+"]"}},za.identity=function(a){for(var b=new za,c=0;c<a;c++){b.elements.push([]);for(var d=0;d<a;d++)b.set(c,d,new ra(c===d?1:0))}return b},za.fromArray=function(a){function b(a){return za.apply(this,a)}return b.prototype=za.prototype,new b(a)},za.zeroMatrix=function(a,b){for(var c=new za,d=0;d<a;d++)c.elements.push(ya.arrayPrefill(b,new ra(0)));return c},za.prototype={custom:!0,set:function(a,b,c){this.elements[a]||(this.elements[a]=[]),this.elements[a][b]=H(c)?c:new ra(c)},cols:function(){return this.elements[0].length},rows:function(){return this.elements.length},row:function(a){return!a||a>this.cols()?[]:this.elements[a-1]},col:function(a){var b=this.rows(),c=[];if(a>this.cols()||!a)return c;for(var d=0;d<b;d++)c.push(this.elements[d][a-1]);return c},eachElement:function(a){var d,e,b=this.rows(),c=this.cols();for(d=0;d<b;d++)for(e=0;e<c;e++)this.elements[d][e]=a.call(this,this.elements[d][e],d,e)},determinant:function(){if(!this.isSquare())return null;var f,a=this.toRightTriangular(),b=a.elements[0][0],d=a.elements.length-1,e=d;do f=e-d+1,b=c.multiply(b,a.elements[f][f]);while(--d);return b},isSquare:function(){return this.elements.length===this.elements[0].length},isSingular:function(){return this.isSquare()&&0===this.determinant()},augment:function(a){var b=this.rows(),c=a.rows();b!==c&&B("Cannot augment matrix. Rows don't match.");for(var d=0;d<b;d++)this.elements[d]=this.elements[d].concat(a.elements[d]);return this},clone:function(){for(var a=this.rows(),b=this.cols(),c=new za,d=0;d<a;d++){c.elements[d]=[];for(var e=0;e<b;e++){var f=this.elements[d][e];c.elements[d][e]=H(f)?f.clone():f}}return c},invert:function(){return this.isSquare()||B("Matrix is not square!"),ga("SAFE",function(){var d,e,h,j,k,l,n,a=this.elements.length,b=a,f=za.identity(a),g=this.augment(f).toRightTriangular(),i=g.elements[0].length,m=[];do{d=a-1,k=[],h=i,m[d]=[],l=g.elements[d][d];do j=i-h,n=c.divide(g.elements[d][j],l.clone()),k.push(n),j>=b&&m[d].push(n);while(--h);for(g.elements[d]=k,e=0;e<d;e++){k=[],h=i;do j=i-h,k.push(c.subtract(g.elements[e][j].clone(),c.multiply(g.elements[d][j].clone(),g.elements[e][d].clone())));while(--h);g.elements[e]=k}}while(--a);return za.fromArray(m)},void 0,this)},toRightTriangular:function(){return ga("SAFE",function(){var b,d,e,h,i,k,a=this.clone(),f=this.elements.length,g=f,j=this.elements[0].length;do{if(h=g-f,d=a.elements[h][h],0===d.valueOf())for(var l=h+1;l<g;l++)if(e=a.elements[l][h],e&&0!==e.valueOf()){b=[],i=j;do k=j-i,b.push(c.add(a.elements[h][k].clone(),a.elements[l][k].clone()));while(--i);a.elements[h]=b;break}var d=a.elements[h][h];if(0!==d.valueOf())for(l=h+1;l<g;l++){var m=c.divide(a.elements[l][h].clone(),a.elements[h][h].clone());b=[],i=j;do k=j-i,b.push(k<=h?new ra(0):c.subtract(a.elements[l][k].clone(),c.multiply(a.elements[h][k].clone(),m.clone())));while(--i);a.elements[l]=b}}while(--f);return a},void 0,this)},transpose:function(){var e,f,g,a=this.elements.length,b=this.elements[0].length,c=new za,d=b;do{e=b-d,c.elements[e]=[],f=a;do g=a-f,c.elements[e][g]=this.elements[g][e].clone();while(--f)}while(--d);return c},canMultiplyFromLeft:function(a){var b=J(a)?a.elements.length:a.length;return this.elements[0].length===b},sameSize:function(a){return this.rows()===a.rows()&&this.cols()===a.cols()},multiply:function(a){return ga("SAFE",function(){var b=a.elements||a;if(!this.canMultiplyFromLeft(b)){if(this.sameSize(a)){for(var d=new za,e=this.rows(),f=0;f<e;f++){var g=c.multiply(new ya(this.elements[f]),new ya(a.elements[f]));d.elements[f]=g.elements}return d}return null}var f,j,l,o,p,q,h=this.elements.length,i=h,k=b[0].length,m=this.elements[0].length,n=[];do{f=i-h,n[f]=[],j=k;do{l=k-j,o=new ra(0),p=m;do q=m-p,o=c.add(o,c.multiply(this.elements[f][q],b[q][l]));while(--p);n[f][l]=o}while(--j)}while(--h);return za.fromArray(n)},void 0,this)},add:function(a){var b=new za;return this.sameSize(a)&&this.eachElement(function(d,e,f){b.set(e,f,c.add(d.clone(),a.elements[e][f]))}),b},subtract:function(a){var b=new za;return this.sameSize(a)&&this.eachElement(function(d,e,f){b.set(e,f,c.subtract(d.clone(),a.elements[e][f]))}),b},negate:function(){return this.each(function(a){return a.negate()}),this},toVector:function(){if(1===this.rows()||1===this.cols()){var a=new ya;return a.elements=this.elements,a}return this},toString:function(a){var b=this.rows(),c=[];a=void 0===a?"\n":a;for(var d=0;d<b;d++)c.push("["+this.elements[d].map(function(a){return void 0!==a?a.toString():""}).join(",")+"]");return"matrix"+O(c.join(","))},text:function(){return"matrix("+this.toString("")+")"},latex:function(a){var b=this.cols(),c=this.elements;return S("\\begin{vmatrix}{0}\\end{vmatrix}",function(){var d=[];for(var e in c){for(var f=[],g=0;g<b;g++)f.push(xa.latex.call(xa,c[e][g],a));d.push(f.join(" & "))}return d.join(" \\cr ")})}},za.prototype.each=za.prototype.eachElement;var Aa=function(){ea(c.constants),ea(c.functions),ka(h.init_primes)},Ba=g.build=function(a,b){var d=_(a),e=[],f=function(a,b){b=b||[];var d=[],g=a.group,h="",j=function(c){var d=c===o?"*":"+",e=[];for(var g in a.symbols)e.push(f(a.symbols[g],b)[0]);var h=e.join(d);return h&&!a.multiplier.equals(1)?O(h):h},n=function(c){var d;return c in Math?d="Math."+c:(e.indexOf(c)===-1&&(b.push("var "+c+" = "+la[c].toString()+"; "),e.push(c)),d=c),d+=O(a.args.map(function(a){return f(a,b)[0]}).join(","))};g===i?d.push(a.multiplier.toDecimal()):a.multiplier.equals(-1)?h="-":a.multiplier.equals(1)||d.push(a.multiplier.toDecimal());var p;if(g===k)p=a.value;else if(g===m)p=n(a.fname);else if(g===l){var q=a.previousGroup;p=q===i||q===k?a.value:q===m?n(a.fname):j(a.previousGroup)}else p=j(a.group);if(a.group!==i&&!a.power.equals(1)){var r=f(c.parse(a.power));b.push(r[1]),p="Math.pow"+O(p+","+r[0])}return p&&d.push(h+p),[d.join("*"),b.join("").replace(/\n+\s+/g," ")]};if(b){d.length!==b.length&&B("Argument array contains wrong number of arguments");for(var g=0;g<d.length;g++){var h=d[g];b.indexOf(h)===-1&&B(h+" not found in argument array")}d=b}var j=f(a);return new Function(d,j[1]+" return "+j[0]+";")};Aa();var Ca={};Ca.Operator=ta,Ca.groups=e,Ca.Symbol=ra,Ca.Expression=pa,Ca.Frac=qa,Ca.Vector=ya,Ca.Matrix=za,Ca.Parser=va,Ca.Fraction=wa,Ca.Math2=la,Ca.LaTeX=xa,Ca.Utils=g,Ca.PRIMES=f,Ca.PARSER=c,Ca.PARENTHESIS=r,Ca.Settings=h,Ca.VARS=x,Ca.err=B,Ca.bigInt=d;var Da=function(a,b,d,e){var f,g,i;a instanceof pa&&(a=a.toString());var j=a.split("=");j.length>1&&(/\w+\((.*)\)/.test(j[0].replace(/\s/g,""))?(g=/\w+(?=\()/.exec(j[0])[0],i=/\((.*)(?=\))/.exec(j[0])[1].replace(/\s/g,"").split(",")):f=j[0],a=j[1]);var k=L(d),l="expand",m=k?d.indexOf("numer")!==-1:"numer"===d;(k?d.indexOf(l)!==-1:d===l)&&(a=S("{0}({1})",l,a));var n=ga("PARSE2NUMBER",function(){return c.parse(a,ja(b))},m||h.PARSE2NUMBER);return e?w[e-1]=n:w.push(n),f&&Da.setVar(f,n),g&&Da.setFunction(g,i,n),new pa(n)};return Da.version=function(){return b},Da.getWarnings=function(){return z},Da.setConstant=function(a,b){if(D(a),!A(a))if("delete"===b)delete c.constants[a];else{if(isNaN(b))throw new Error("Constant must be a number!");c.constants[a]=b}return this},Da.setFunction=function(a,b,d){return D(a),!A(a)&&(b=b||_(c.parse(d)),c.functions[a]=[c.mapped_function,b.length,{name:a,params:b,body:d}],!0)},Da.getCore=function(){return Ca},Da.getExpression=Da.getEquation=pa.getExpression,Da.reserved=function(a){return a?y:y.join(", ")},Da.clear=function(a,b){if("all"===a)w=[];else if("last"===a)w.pop();else if("first"===a)w.shift();else{var c=a?a-1:w.length;b===!0?w[c]=void 0:fa(w,c)}return this},Da.flush=function(){return this.clear("all"),this},Da.expressions=function(a,b,c){for(var d=a?{}:[],e=0;e<w.length;e++){var f=b?xa.latex(w[e],c):ma(w[e],c);a?d[e+1]=f:d.push(f)}return d},Da.register=function(a){var b=this.getCore();if(L(a))for(var d=0;d<a.length;d++)a&&this.register(a[d]);else if(a&&h.exclude.indexOf(a.name)===-1){if(a.dependencies)for(var d=0;d<a.dependencies.length;d++)if(!b[a.dependencies[d]])throw new Error(S("{0} requires {1} to be loaded!",a.name,a.dependencies[d]));var e=a.parent,f=a.build.call(b);if(e){b[e]||(b[a.parent]={});var g="nerdamer"===e?this:b[e];g[a.name]=f}a.visible&&(c.functions[a.name]=[f,a.numargs])}},Da.validateName=D,Da.validVarName=function(a){try{return D(a),y.indexOf(a)===-1}catch(a){return!1}},Da.supported=function(){return T(c.functions)},Da.numEquations=Da.numExpressions=function(){return w.length},Da.setVar=function(a,b){return D(a),"delete"===b?delete x[a]:x[a]=H(b)?b:c.parse(b),this},Da.clearVars=function(){return x={},this},Da.load=function(a){return a.call(this),this},Da.getVars=function(a,b){a=a||"text";var c={};if("object"===a)c=x;else for(var d in x)"latex"===a?c[d]=x[d].latex(b):"text"===a&&(c[d]=x[d].text(b));return c},Da.set=function(a,b){var c=["SAFE"];c.indexOf(a)!==-1&&B("Cannot modify setting: "+a),h[a]=b},Da}({bigInt:function(a){"use strict";function g(a,b){this.value=a,this.sign=b,this.isSmall=!1}function h(a){this.value=a,this.sign=a<0,this.isSmall=!0}function i(a){return-d<a&&a<d}function j(a){return a<1e7?[a]:a<1e14?[a%1e7,Math.floor(a/1e7)]:[a%1e7,Math.floor(a/1e7)%1e7,Math.floor(a/1e14)]}function k(a){l(a);var c=a.length;if(c<4&&F(a,e)<0)switch(c){case 0:return 0;case 1:return a[0];case 2:return a[0]+a[1]*b;default:return a[0]+(a[1]+a[2]*b)*b}return a}function l(a){for(var b=a.length;0===a[--b];);a.length=b+1}function m(a){for(var b=new Array(a),c=-1;++c<a;)b[c]=0;return b}function n(a){return a>0?Math.floor(a):Math.ceil(a)}function o(a,c){var i,j,d=a.length,e=c.length,f=new Array(d),g=0,h=b;for(j=0;j<e;j++)i=a[j]+c[j]+g,g=i>=h?1:0,f[j]=i-g*h;for(;j<d;)i=a[j]+g,g=i===h?1:0,f[j++]=i-g*h;return g>0&&f.push(g),f}function p(a,b){return a.length>=b.length?o(a,b):o(b,a)}function q(a,c){var g,h,d=a.length,e=new Array(d),f=b;for(h=0;h<d;h++)g=a[h]-f+c,c=Math.floor(g/f),e[h]=g-c*f,c+=1;for(;c>0;)e[h++]=c%f,c=Math.floor(c/f);return e}function r(a,c){var i,j,d=a.length,e=c.length,f=new Array(d),g=0,h=b;for(i=0;i<e;i++)j=a[i]-g-c[i],j<0?(j+=h,g=1):g=0,f[i]=j;for(i=e;i<d;i++){if(j=a[i]-g,!(j<0)){f[i++]=j;break}j+=h,f[i]=j}for(;i<d;i++)f[i]=a[i];return l(f),f}function s(a,b,c){var d;return F(a,b)>=0?d=r(a,b):(d=r(b,a),c=!c),d=k(d),"number"==typeof d?(c&&(d=-d),new h(d)):new g(d,c)}function t(a,c,d){var l,m,e=a.length,f=new Array(e),i=-c,j=b;for(l=0;l<e;l++)m=a[l]+i,i=Math.floor(m/j),m%=j,f[l]=m<0?m+j:m;return f=k(f),
"number"==typeof f?(d&&(f=-f),new h(f)):new g(f,d)}function u(a,c){var i,j,k,n,o,d=a.length,e=c.length,f=d+e,g=m(f),h=b;for(k=0;k<d;++k){n=a[k];for(var p=0;p<e;++p)o=c[p],i=n*o+g[k+p],j=Math.floor(i/h),g[k+p]=i-j*h,g[k+p+1]+=j}return l(g),g}function v(a,c){var h,i,d=a.length,e=new Array(d),f=b,g=0;for(i=0;i<d;i++)h=a[i]*c+g,g=Math.floor(h/f),e[i]=h-g*f;for(;g>0;)e[i++]=g%f,g=Math.floor(g/f);return e}function w(a,b){for(var c=[];b-- >0;)c.push(0);return c.concat(a)}function x(a,b){var c=Math.max(a.length,b.length);if(c<=30)return u(a,b);c=Math.ceil(c/2);var d=a.slice(c),e=a.slice(0,c),f=b.slice(c),g=b.slice(0,c),h=x(e,g),i=x(d,f),j=x(p(e,d),p(g,f)),k=p(p(h,w(r(r(j,h),i),c)),w(i,2*c));return l(k),k}function y(a,b){return-.012*a-.012*b+15e-6*a*b>0}function z(a,c,d){return a<b?new g(v(c,a),d):new g(u(c,j(a)),d)}function A(a){var f,g,h,i,j,c=a.length,d=m(c+c),e=b;for(h=0;h<c;h++){i=a[h];for(var k=0;k<c;k++)j=a[k],f=i*j+d[h+k],g=Math.floor(f/e),d[h+k]=f-g*e,d[h+k+1]+=g}return l(d),d}function B(a,c){var n,o,p,q,r,s,t,d=a.length,e=c.length,f=b,g=m(c.length),h=c[e-1],i=Math.ceil(f/(2*h)),j=v(a,i),l=v(c,i);for(j.length<=d&&j.push(0),l.push(0),h=l[e-1],o=d-e;o>=0;o--){for(n=f-1,j[o+e]!==h&&(n=Math.floor((j[o+e]*f+j[o+e-1])/h)),p=0,q=0,s=l.length,r=0;r<s;r++)p+=n*l[r],t=Math.floor(p/f),q+=j[o+r]-(p-t*f),p=t,q<0?(j[o+r]=q+f,q=-1):(j[o+r]=q,q=0);for(;0!==q;){for(n-=1,p=0,r=0;r<s;r++)p+=j[o+r]-f+l[r],p<0?(j[o+r]=p+f,p=0):(j[o+r]=p,p=1);q+=p}g[o]=n}return j=D(j,i)[0],[k(g),k(j)]}function C(a,c){for(var i,j,l,m,n,d=a.length,e=c.length,f=[],g=[],h=b;d;)if(g.unshift(a[--d]),F(g,c)<0)f.push(0);else{j=g.length,l=g[j-1]*h+g[j-2],m=c[e-1]*h+c[e-2],j>e&&(l=(l+1)*h),i=Math.ceil(l/m);do{if(n=v(c,i),F(n,g)<=0)break;i--}while(i);f.push(i),g=r(g,n)}return f.reverse(),[k(f),k(g)]}function D(a,c){var g,h,i,j,d=a.length,e=m(d),f=b;for(i=0,g=d-1;g>=0;--g)j=i*f+a[g],h=n(j/c),i=j-h*c,e[g]=0|h;return[e,0|i]}function E(a,c){var d,l,e=Z(c),f=a.value,i=e.value;if(0===i)throw new Error("Cannot divide by zero");if(a.isSmall)return e.isSmall?[new h(n(f/i)),new h(f%i)]:[$[0],a];if(e.isSmall){if(1===i)return[a,$[0]];if(i==-1)return[a.negate(),$[0]];var m=Math.abs(i);if(m<b){d=D(f,m),l=k(d[0]);var o=d[1];return a.sign&&(o=-o),"number"==typeof l?(a.sign!==e.sign&&(l=-l),[new h(l),new h(o)]):[new g(l,a.sign!==e.sign),new h(o)]}i=j(m)}var p=F(f,i);if(p===-1)return[$[0],a];if(0===p)return[$[a.sign===e.sign?1:-1],$[0]];d=f.length+i.length<=200?B(f,i):C(f,i),l=d[0];var q=a.sign!==e.sign,r=d[1],s=a.sign;return"number"==typeof l?(q&&(l=-l),l=new h(l)):l=new g(l,q),"number"==typeof r?(s&&(r=-r),r=new h(r)):r=new g(r,s),[l,r]}function F(a,b){if(a.length!==b.length)return a.length>b.length?1:-1;for(var c=a.length-1;c>=0;c--)if(a[c]!==b[c])return a[c]>b[c]?1:-1;return 0}function G(a){var b=a.abs();return!b.isUnit()&&(!!(b.equals(2)||b.equals(3)||b.equals(5))||!(b.isEven()||b.isDivisibleBy(3)||b.isDivisibleBy(5))&&(!!b.lesser(25)||void 0))}function K(a){return("number"==typeof a||"string"==typeof a)&&+Math.abs(a)<=b||a instanceof g&&a.value.length<=1}function L(a,b,c){b=Z(b);for(var d=a.isNegative(),e=b.isNegative(),f=d?a.not():a,g=e?b.not():b,h=[],i=[],j=!1,k=!1;!j||!k;)f.isZero()?(j=!0,h.push(d?1:0)):d?h.push(f.isEven()?1:0):h.push(f.isEven()?0:1),g.isZero()?(k=!0,i.push(e?1:0)):e?i.push(g.isEven()?1:0):i.push(g.isEven()?0:1),f=f.over(2),g=g.over(2);for(var l=[],m=0;m<h.length;m++)l.push(c(h[m],i[m]));for(var n=bigInt(l.pop()).negate().times(bigInt(2).pow(l.length));l.length;)n=n.add(bigInt(l.pop()).times(bigInt(2).pow(l.length)));return n}function O(a){var c=a.value,d="number"==typeof c?c|M:c[0]+c[1]*b|N;return d&-d}function P(a,b){return a=Z(a),b=Z(b),a.greater(b)?a:b}function Q(a,b){return a=Z(a),b=Z(b),a.lesser(b)?a:b}function R(a,b){if(a=Z(a).abs(),b=Z(b).abs(),a.equals(b))return a;if(a.isZero())return b;if(b.isZero())return a;for(var d,e,c=$[1];a.isEven()&&b.isEven();)d=Math.min(O(a),O(b)),a=a.divide(d),b=b.divide(d),c=c.multiply(d);for(;a.isEven();)a=a.divide(O(a));do{for(;b.isEven();)b=b.divide(O(b));a.greater(b)&&(e=b,b=a,a=e),b=b.subtract(a)}while(!b.isZero());return c.isUnit()?a:a.multiply(c)}function S(a,b){return a=Z(a).abs(),b=Z(b).abs(),a.divide(R(a,b)).multiply(b)}function T(a,c){a=Z(a),c=Z(c);var d=Q(a,c),e=P(a,c),f=e.subtract(d);if(f.isSmall)return d.add(Math.round(Math.random()*f));for(var i=f.value.length-1,j=[],l=!0,m=i;m>=0;m--){var o=l?f.value[m]:b,p=n(Math.random()*o);j.unshift(p),p<o&&(l=!1)}return j=k(j),d.add("number"==typeof j?new h(j):new g(j,!1))}function V(a){var b=a.value;return"number"==typeof b&&(b=[b]),1===b.length&&b[0]<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(b[0]):"<"+b+">"}function W(a,b){if(b=bigInt(b),b.isZero()){if(a.isZero())return"0";throw new Error("Cannot convert nonzero numbers to base 0.")}if(b.equals(-1))return a.isZero()?"0":a.isNegative()?new Array(1-a).join("10"):"1"+new Array(+a).join("01");var c="";if(a.isNegative()&&b.isPositive()&&(c="-",a=a.abs()),b.equals(1))return a.isZero()?"0":c+new Array(+a+1).join(1);for(var f,d=[],e=a;e.isNegative()||e.compareAbs(b)>=0;){f=e.divmod(b),e=f.quotient;var g=f.remainder;g.isNegative()&&(g=b.minus(g).abs(),e=e.next()),d.push(V(g))}return d.push(V(e)),c+d.reverse().join("")}function X(a){if(i(+a)){var b=+a;if(b===n(b))return new h(b);throw"Invalid integer: "+a}var d="-"===a[0];d&&(a=a.slice(1));var e=a.split(/e/i);if(e.length>2)throw new Error("Invalid integer: "+j.join("e"));if(2===e.length){var f=e[1];if("+"===f[0]&&(f=f.slice(1)),f=+f,f!==n(f)||!i(f))throw new Error("Invalid integer: "+f+" is not a valid exponent.");var j=e[0],k=j.indexOf(".");if(k>=0&&(f-=j.length-k-1,j=j.slice(0,k)+j.slice(k+1)),f<0)throw new Error("Cannot include negative exponent part for integers");j+=new Array(f+1).join("0"),a=j}var m=/^([0-9][0-9]*)$/.test(a);if(!m)throw new Error("Invalid integer: "+a);for(var o=[],p=a.length,q=c,r=p-q;p>0;)o.push(+a.slice(r,p)),r-=q,r<0&&(r=0),p-=q;return l(o),new g(o,d)}function Y(a){return i(a)?new h(a):X(a.toString())}function Z(a){return"number"==typeof a?Y(a):"string"==typeof a?X(a):a}var b=1e7,c=7,d=9007199254740992,e=j(d),f=Math.log(d);g.prototype.add=function(a){var c=Z(a);if(this.sign!==c.sign)return this.subtract(c.negate());var d=this.value,e=c.value;return c.isSmall?new g(q(d,Math.abs(e)),this.sign):new g(p(d,e),this.sign)},g.prototype.plus=g.prototype.add,h.prototype.add=function(a){var b=Z(a),c=this.value;if(c<0!==b.sign)return this.subtract(b.negate());var d=b.value;if(b.isSmall){if(i(c+d))return new h(c+d);d=j(Math.abs(d))}return new g(q(d,Math.abs(c)),c<0)},h.prototype.plus=h.prototype.add,g.prototype.subtract=function(a){var b=Z(a);if(this.sign!==b.sign)return this.add(b.negate());var c=this.value,d=b.value;return b.isSmall?t(c,Math.abs(d),this.sign):s(c,d,this.sign)},g.prototype.minus=g.prototype.subtract,h.prototype.subtract=function(a){var b=Z(a),c=this.value;if(c<0!==b.sign)return this.add(b.negate());var d=b.value;return b.isSmall?new h(c-d):t(d,Math.abs(c),c>=0)},h.prototype.minus=h.prototype.subtract,g.prototype.negate=function(){return new g(this.value,!this.sign)},h.prototype.negate=function(){var a=this.sign,b=new h(-this.value);return b.sign=!a,b},g.prototype.abs=function(){return new g(this.value,!1)},h.prototype.abs=function(){return new h(Math.abs(this.value))},g.prototype.multiply=function(a){var i,d=Z(a),e=this.value,f=d.value,h=this.sign!==d.sign;if(d.isSmall){if(0===f)return $[0];if(1===f)return this;if(f===-1)return this.negate();if(i=Math.abs(f),i<b)return new g(v(e,i),h);f=j(i)}return y(e.length,f.length)?new g(x(e,f),h):new g(u(e,f),h)},g.prototype.times=g.prototype.multiply,h.prototype._multiplyBySmall=function(a){return i(a.value*this.value)?new h(a.value*this.value):z(Math.abs(a.value),j(Math.abs(this.value)),this.sign!==a.sign)},g.prototype._multiplyBySmall=function(a){return 0===a.value?$[0]:1===a.value?this:a.value===-1?this.negate():z(Math.abs(a.value),this.value,this.sign!==a.sign)},h.prototype.multiply=function(a){return Z(a)._multiplyBySmall(this)},h.prototype.times=h.prototype.multiply,g.prototype.square=function(){return new g(A(this.value),!1)},h.prototype.square=function(){var a=this.value*this.value;return i(a)?new h(a):new g(A(j(Math.abs(this.value))),!1)},g.prototype.divmod=function(a){var b=E(this,a);return{quotient:b[0],remainder:b[1]}},h.prototype.divmod=g.prototype.divmod,g.prototype.divide=function(a){return E(this,a)[0]},h.prototype.over=h.prototype.divide=g.prototype.over=g.prototype.divide,g.prototype.mod=function(a){return E(this,a)[1]},h.prototype.remainder=h.prototype.mod=g.prototype.remainder=g.prototype.mod,g.prototype.pow=function(a){var e,f,g,b=Z(a),c=this.value,d=b.value;if(0===d)return $[1];if(0===c)return $[0];if(1===c)return $[1];if(c===-1)return b.isEven()?$[1]:$[-1];if(b.sign)return $[0];if(!b.isSmall)throw new Error("The exponent "+b.toString()+" is too large.");if(this.isSmall&&i(e=Math.pow(c,d)))return new h(n(e));for(f=this,g=$[1];;){if(d&!0&&(g=g.times(f),--d),0===d)break;d/=2,f=f.square()}return g},h.prototype.pow=g.prototype.pow,g.prototype.modPow=function(a,b){if(a=Z(a),b=Z(b),b.isZero())throw new Error("Cannot take modPow with modulus 0");for(var c=$[1],d=this.mod(b);a.isPositive();){if(d.isZero())return $[0];a.isOdd()&&(c=c.multiply(d).mod(b)),a=a.divide(2),d=d.square().mod(b)}return c},h.prototype.modPow=g.prototype.modPow,g.prototype.compareAbs=function(a){var b=Z(a),c=this.value,d=b.value;return b.isSmall?1:F(c,d)},h.prototype.compareAbs=function(a){var b=Z(a),c=Math.abs(this.value),d=b.value;return b.isSmall?(d=Math.abs(d),c===d?0:c>d?1:-1):-1},g.prototype.compare=function(a){if(a===1/0)return-1;if(a===-(1/0))return 1;var b=Z(a),c=this.value,d=b.value;return this.sign!==b.sign?b.sign?1:-1:b.isSmall?this.sign?-1:1:F(c,d)*(this.sign?-1:1)},g.prototype.compareTo=g.prototype.compare,h.prototype.compare=function(a){if(a===1/0)return-1;if(a===-(1/0))return 1;var b=Z(a),c=this.value,d=b.value;return b.isSmall?c==d?0:c>d?1:-1:c<0!==b.sign?c<0?-1:1:c<0?1:-1},h.prototype.compareTo=h.prototype.compare,g.prototype.equals=function(a){return 0===this.compare(a)},h.prototype.eq=h.prototype.equals=g.prototype.eq=g.prototype.equals,g.prototype.notEquals=function(a){return 0!==this.compare(a)},h.prototype.neq=h.prototype.notEquals=g.prototype.neq=g.prototype.notEquals,g.prototype.greater=function(a){return this.compare(a)>0},h.prototype.gt=h.prototype.greater=g.prototype.gt=g.prototype.greater,g.prototype.lesser=function(a){return this.compare(a)<0},h.prototype.lt=h.prototype.lesser=g.prototype.lt=g.prototype.lesser,g.prototype.greaterOrEquals=function(a){return this.compare(a)>=0},h.prototype.geq=h.prototype.greaterOrEquals=g.prototype.geq=g.prototype.greaterOrEquals,g.prototype.lesserOrEquals=function(a){return this.compare(a)<=0},h.prototype.leq=h.prototype.lesserOrEquals=g.prototype.leq=g.prototype.lesserOrEquals,g.prototype.isEven=function(){return 0===(1&this.value[0])},h.prototype.isEven=function(){return 0===(1&this.value)},g.prototype.isOdd=function(){return 1===(1&this.value[0])},h.prototype.isOdd=function(){return 1===(1&this.value)},g.prototype.isPositive=function(){return!this.sign},h.prototype.isPositive=function(){return this.value>0},g.prototype.isNegative=function(){return this.sign},h.prototype.isNegative=function(){return this.value<0},g.prototype.isUnit=function(){return!1},h.prototype.isUnit=function(){return 1===Math.abs(this.value)},g.prototype.isZero=function(){return!1},h.prototype.isZero=function(){return 0===this.value},g.prototype.isDivisibleBy=function(a){var b=Z(a),c=b.value;return 0!==c&&(1===c||(2===c?this.isEven():this.mod(b).equals($[0])))},h.prototype.isDivisibleBy=g.prototype.isDivisibleBy,g.prototype.isPrime=function(){var b=G(this);if(b!==a)return b;for(var g,h,i,j,c=this.abs(),d=c.prev(),e=[2,3,5,7,11,13,17,19],f=d;f.isEven();)f=f.divide(2);for(i=0;i<e.length;i++)if(j=bigInt(e[i]).modPow(f,c),!j.equals($[1])&&!j.equals(d)){for(h=!0,g=f;h&&g.lesser(d);g=g.multiply(2))j=j.square().mod(c),j.equals(d)&&(h=!1);if(h)return!1}return!0},h.prototype.isPrime=g.prototype.isPrime,g.prototype.isProbablePrime=function(b){var c=G(this);if(c!==a)return c;for(var d=this.abs(),e=b===a?5:b,f=0;f<e;f++){var g=bigInt.randBetween(2,d.minus(2));if(!g.modPow(d.prev(),d).isUnit())return!1}return!0},h.prototype.isProbablePrime=g.prototype.isProbablePrime,g.prototype.next=function(){var a=this.value;return this.sign?t(a,1,this.sign):new g(q(a,1),this.sign)},h.prototype.next=function(){var a=this.value;return a+1<d?new h(a+1):new g(e,!1)},g.prototype.prev=function(){var a=this.value;return this.sign?new g(q(a,1),!0):t(a,1,this.sign)},h.prototype.prev=function(){var a=this.value;return a-1>-d?new h(a-1):new g(e,!0)};for(var H=[1];H[H.length-1]<=b;)H.push(2*H[H.length-1]);var I=H.length,J=H[I-1];g.prototype.shiftLeft=function(a){if(!K(a))throw new Error(String(a)+" is too large for shifting.");if(a=+a,a<0)return this.shiftRight(-a);for(var b=this;a>=I;)b=b.multiply(J),a-=I-1;return b.multiply(H[a])},h.prototype.shiftLeft=g.prototype.shiftLeft,g.prototype.shiftRight=function(a){var b;if(!K(a))throw new Error(String(a)+" is too large for shifting.");if(a=+a,a<0)return this.shiftLeft(-a);for(var c=this;a>=I;){if(c.isZero())return c;b=E(c,J),c=b[1].isNegative()?b[0].prev():b[0],a-=I-1}return b=E(c,H[a]),b[1].isNegative()?b[0].prev():b[0]},h.prototype.shiftRight=g.prototype.shiftRight,g.prototype.not=function(){return this.negate().prev()},h.prototype.not=g.prototype.not,g.prototype.and=function(a){return L(this,a,function(a,b){return a&b})},h.prototype.and=g.prototype.and,g.prototype.or=function(a){return L(this,a,function(a,b){return a|b})},h.prototype.or=g.prototype.or,g.prototype.xor=function(a){return L(this,a,function(a,b){return a^b})},h.prototype.xor=g.prototype.xor;var M=1<<30,N=(b&-b)*(b&-b)|M,U=function(a,b){var c=$[0],d=$[1],e=a.length;if(2<=b&&b<=36&&e<=f/Math.log(b))return new h(parseInt(a,b));b=Z(b);var i,g=[],j="-"===a[0];for(i=j?1:0;i<a.length;i++){var k=a[i].toLowerCase(),l=k.charCodeAt(0);if(48<=l&&l<=57)g.push(Z(k));else if(97<=l&&l<=122)g.push(Z(k.charCodeAt(0)-87));else{if("<"!==k)throw new Error(k+" is not a valid character");var m=i;do i++;while(">"!==a[i]);g.push(Z(a.slice(m+1,i)))}}for(g.reverse(),i=0;i<g.length;i++)c=c.add(g[i].times(d)),d=d.times(b);return j?c.negate():c};g.prototype.toString=function(b){if(b===a&&(b=10),10!==b)return W(this,b);for(var g,c=this.value,d=c.length,e=String(c[--d]),f="0000000";--d>=0;)g=String(c[d]),e+=f.slice(g.length)+g;var h=this.sign?"-":"";return h+e},h.prototype.toString=function(b){return b===a&&(b=10),10!=b?W(this,b):String(this.value)},g.prototype.valueOf=function(){return+this.toString()},g.prototype.toJSNumber=g.prototype.valueOf,h.prototype.valueOf=function(){return this.value},h.prototype.toJSNumber=h.prototype.valueOf;for(var $=function(a,b){return"undefined"==typeof a?$[0]:"undefined"!=typeof b?10===+b?Z(a):U(a,b):Z(a)},_=0;_<1e3;_++)$[_]=new h(_),_>0&&($[-_]=new h(-_));return $.one=$[1],$.zero=$[0],$.minusOne=$[-1],$.max=P,$.min=Q,$.gcd=R,$.lcm=S,$.isInstance=function(a){return a instanceof g||a instanceof h},$.randBetween=T,$}()});"undefined"!=typeof module&&(module.exports=nerdamer),function(){"use strict";function q(c,d,e){if(a.Utils.isSymbol(c))this.parse(c);else if(isNaN(c))"string"==typeof c&&this.parse(b.parse(c));else{if(e=e||0,void 0===d)throw new Error("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[e]=c,this.fill(c)}}function r(){this.factors={}}function s(b,c,d){this.terms=c||[],this.coeff=b,this.map=d,this.sum=new a.Frac(0),this.image=void 0}var a=nerdamer.getCore(),b=a.PARSER,c=a.groups.N,d=a.groups.S,e=a.groups.EX,f=a.groups.FN,g=a.groups.PL,h=a.groups.CP,i=a.groups.CB,j=a.Utils.keys,k=a.Utils.variables,l=a.Utils.round,m=a.Frac,n=a.Utils.isInt,o=a.Symbol,p=a.Settings.CONST_HASH;q.fromArray=function(a,b){if("undefined"==typeof b)throw new Error("A variable name must be specified when creating polynomial from array");var c=new q;return c.coeffs=a,c.variable=b,c},q.fit=function(a,b,c,d,e,f){var g=new Array(e+1),h=c-b;g[0]=b,g[e]=a,h-=a*Math.pow(d,e);for(var i=e-1;i>0;i--){var j=Math.pow(d,i),k=h/j,l=Math.sign(k),n=l*Math.floor(Math.abs(k));h-=n*j,g[i]=n}if(0!==h)return null;for(var i=0;i<g.length;i++)g[i]=new m(g[i]);return q.fromArray(g,f)},q.prototype={parse:function(d,e){if(this.variable=k(d)[0],!d.isPoly())throw new Error("Polynomial Expected! Received "+a.Utils.text(d));if(e=e||[],d.power.absEquals(1)||(d=b.expand(d)),d.group===a.groups.N)e[0]=d.multiplier;else if(d.group===a.groups.S)e[d.power.toDecimal()]=d.multiplier;else for(var f in d.symbols){var g=d.symbols[f],h=g.power;if(a.Utils.isSymbol(h))throw new Error("power cannot be a Symbol");h=g.group===c?0:h.toDecimal(),g.symbols?this.parse(g,e):e[h]=g.multiplier}this.coeffs=e,this.fill()},fill:function(a){a=Number(a)||0;for(var b=this.coeffs.length,c=0;c<b;c++)void 0===this.coeffs[c]&&(this.coeffs[c]=new m(a));return this},trim:function(){for(var a=this.coeffs.length;a--;){var b=this.coeffs[a],c=b.equals(0);if(!b||!c)break;if(0===a)break;this.coeffs.pop()}return this},modP:function(a){for(var b=this.coeffs.length,c=0;c<b;c++){var d=this.coeffs[c];if(d<0){for(var e,f=c;f<b;f++)if(this.coeffs[f]>0){e=this.coeffs[f];break}if(e){for(f;f>c;f--)this.coeffs[f]=this.coeffs[f].subtract(new m(1)),this.coeffs[f-1]=this.coeffs[f-1].add(new m(a));d=this.coeffs[c]}}var g=d.mod(a),h=d.subtract(g).divide(a);if(!h.equals(0)){var i=c+1,j=this.coeffs[i]||new m(0);j=j.add(h),this.coeffs[i]=new m(j),this.coeffs[c]=new m(g)}}return this},add:function(a){for(var b=Math.max(this.coeffs.length,a.coeffs.length),c=0;c<b;c++){var d=this.coeffs[c]||new m(0),e=a.coeffs[c]||new m(0);this.coeffs[c]=d.add(e)}return this},subtract:function(a){for(var b=Math.max(this.coeffs.length,a.coeffs.length),c=0;c<b;c++){var d=this.coeffs[c]||new m(0),e=a.coeffs[c]||new m(0);this.coeffs[c]=d.subtract(e)}return this},divide:function(b){for(var c=this.variable,d=a.Utils.arrayClone(this.coeffs),e=a.Utils.arrayClone(b.coeffs),f=d.length,g=e.length-1,h=[],i=0;i<f;i++){var j=f-(i+1),k=j-g,l=d[j].divide(e[g]);if(k<0)break;h[k]=l;for(var m=0;m<=g;m++)d[m+k]=d[m+k].subtract(e[m].multiply(l))}var n=q.fromArray(d,c||"x").trim(),o=q.fromArray(h,c||"x");return[o,n]},multiply:function(a){for(var b=this.coeffs.length,c=a.coeffs.length,d=[],e=0;e<b;e++)for(var f=this.coeffs[e],g=0;g<c;g++){var h=e+g,i=a.coeffs[g],j=d[h]||new m(0);d[h]=j.add(f.multiply(i))}return this.coeffs=d,this},isZero:function(){for(var a=this.coeffs.length,b=0;b<a;b++){var c=this.coeffs[b];if(!c.equals(0))return!1}return!0},sub:function(a){for(var b=new m(0),c=this.coeffs.length,d=0;d<c;d++){var e=this.coeffs[d];e.equals(0)||(b=b.add(e.multiply(new m(Math.pow(a,d)))))}return b},clone:function(){var a=new q;return a.coeffs=this.coeffs,a.variable=this.variable,a},deg:function(){return this.trim(),this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var a=this.lc(),b=this.coeffs.length,c=0;c<b;c++)this.coeffs[c]=this.coeffs[c].divide(a);return this},gcd:function(b){var e,c=this.coeffs.length-1,d=b.coeffs.length-1;if(c<d)return b.gcd(this);for(var f=this;!b.isZero();){var g=b.clone();f=f.clone(),e=f.divide(g),b=e[1],f=g}var h=a.Math2.QGCD.apply(null,f.coeffs);if(!h.equals(1))for(var i=f.coeffs.length,j=0;j<i;j++)f.coeffs[j]=f.coeffs[j].divide(h);return f},diff:function(){for(var a=[],b=this.coeffs.length,c=1;c<b;c++)a.push(this.coeffs[c].multiply(new m(c)));return this.coeffs=a,this},integrate:function(){for(var a=[0],b=this.coeffs.length,c=0;c<b;c++){var d=new m(c+1);a[d]=this.coeffs[c].divide(d)}return this.coeffs=a,this},gcf:function(b){for(var c=function(a){for(var b=0;b<a.length;b++)if(!a[b].equals(0))return b},d=[],e=0;e<this.coeffs.length;e++){var f=this.coeffs[e];f.equals(0)||d.indexOf(f)!==-1||d.push(f)}var g=[a.Math2.QGCD.apply(void 0,d),c(this.coeffs)].toDecimal();if(b){var h=[];h[g[1]-1]=g[0],g=q.fromArray(h,this.variable).fill()}return g},quad:function(a){var b=[];if(this.coeffs.length>3)throw new Error("Cannot calculate quadratic order of "+(this.coeffs.length-1));if(0===this.coeffs.length)throw new Error("Polynomial array has no terms");var c=this.coeffs[2]||0,d=this.coeffs[1]||0,e=this.coeffs[0],f=d*d-4*c*e;return f<0&&!a?b:(b[0]=(-d+Math.sqrt(f))/(2*c),b[1]=(-d-Math.sqrt(f))/(2*c),b)},squareFree:function(){for(var a=this.clone(),b=1,c=a.clone().diff(),d=a.clone().gcd(c),e=a.divide(d)[0],f=q.fromArray([new m(1)],a.variable);!d.equalsNumber(1);){var g=e.gcd(d),h=e.divide(g)[0];if(!h.equalsNumber(1)&&b>1){for(var i=h.clone(),j=1;j<b;j++)i.multiply(h.clone());h=i}f=f.multiply(h),b++,e=g,d=d.divide(g)[0]}return[f,e,b]},toSymbol:function(){var c=this.coeffs.length,d=this.variable;if(0===c)return new a.Symbol(0);for(var e=c-1,f="",g=0;g<c;g++){var h=g===e?"":"+",i=this.coeffs[g];i.equals(0)||(f+=i+"*"+d+"^"+g+h)}return b.parse(f)},equalsNumber:function(a){return this.trim(),1===this.coeffs.length&&this.coeffs[0].toDecimal()===a},toString:function(){return this.toSymbol().toString()}},o.prototype.coeffs=function(a,c){c&&!this.isPoly(!0)&&b.error("Polynomial expected when requesting coefficients with order"),a=a||[];var d=this.clone().distributeMultiplier();if(d.isComposite())for(var e in d.symbols){var f=d.symbols[e];f.isComposite()?f.clone().distributeMultiplier().coeffs(a,c):c?a[f.isConstant()?0:f.power.toDecimal()]=f.multiplier:a.push(f.multiplier)}else c?a[d.isConstant()?0:d.power.toDecimal()]=d.multiplier:a.push(d.multiplier);if(c)for(var g=0;g<a.length;g++)void 0===a[g]&&(a[g]=new m(0));return a},o.prototype.tBase=function(a){if("undefined"==typeof a)throw new Error("Symbol.tBase requires a map object!");for(var b=[],c=this.collectSymbols(null,null,null,!0),d=c.length,e=0;e<d;e++){var f=c[e],g=f.group,h=new s(f.multiplier,[],a);if(g===i)for(var j in f.symbols){var k=f.symbols[j];h.terms[a[j]]=k.power}else h.terms[a[f.value]]=f.power;b.push(h.fill()),h.updateCount()}return b},o.prototype.altVar=function(a){var b=this.multiplier.toString(),c=this.power.toString();return("1"===b?"":b+"*")+a+("1"===c?"":"^"+c)},o.prototype.sameVars=function(a){if(!this.symbols&&this.group!==a.group)return!1;for(var b in this.symbols){var c=this.symbols[b],d=a.symbols[b];if(!d)return!1;if(c.value!==d.value)return!1}return!0},r.prototype.add=function(a){if(a.equals(0))return this;if(a.group===i){var c=this;a.each(function(a){c.add(a)})}else{this.preAdd&&(a=this.preAdd(a)),this.pFactor&&(a=b.pow(a,new o(this.pFactor)));var d=a.isConstant();if(d&&a.equals(1))return this;var e=d?a.value:a.text();e in this.factors?this.factors[e]=b.multiply(this.factors[e],a):this.factors[e]=a}return this},r.prototype.toSymbol=function(){var c=new o(1);for(var d in this.factors){var e=this.factors[d].power.equals(1)?b.symfunction(a.PARENTHESIS,[this.factors[d]]):this.factors[d];c=b.multiply(c,e)}return c},r.prototype.merge=function(a){for(var c in a)c in this.factors?this.factors[c]=b.multiply(this.factors[c],a[c]):this.factors[c]=a[c];return this},r.prototype.each=function(b){for(var c in this.factors){var d=this.factors[c];d.fname===a.PARENTHESIS&&d.isLinear()&&(d=d.args[0]),b.call(this,d,c)}return this},r.prototype.count=function(){return j(this.factors).length},r.prototype.toString=function(){return this.toSymbol().toString()},s.prototype.updateCount=function(){this.count=this.count||0;for(var a=0;a<this.terms.length;a++)this.terms[a].equals(0)||this.count++;return this},s.prototype.getVars=function(){for(var a=[],b=0;b<this.terms.length;b++){var c=this.terms[b];this.getRevMap();c.equals(0)||a.push(this.rev_map[b])}return a.join(" ")},s.prototype.len=function(){return"undefined"==typeof this.count&&this.updateCount(),this.count},s.prototype.toSymbol=function(a){a=a||this.getRevMap();for(var c=new o(this.coeff),d=0;d<this.terms.length;d++){var e=a[d],f=this.terms[d];if(!f.equals(0)&&e!==p){var g=new o(e);g.power=f,c=b.multiply(c,g)}}return c},s.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var a={};for(var b in this.map)a[this.map[b]]=b;return this.rev_map=a,a},s.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},s.prototype.getImg=function(){return this.image||this.generateImage(),this.image},s.prototype.fill=function(){for(var b=this.map.length,c=0;c<b;c++)"undefined"==typeof this.terms[c]?this.terms[c]=new a.Frac(0):this.sum=this.sum.add(this.terms[c]);return this},s.prototype.divide=function(a){for(var b=this.coeff.divide(a.coeff),c=this.terms.length,d=new s(b,[],this.map),e=0;e<c;e++)d.terms[e]=this.terms[e].subtract(a.terms[e]),d.sum=d.sum.add(d.terms[e]);return d},s.prototype.multiply=function(a){for(var b=this.coeff.multiply(a.coeff),c=this.terms.length,d=new s(b,[],this.map),e=0;e<c;e++)d.terms[e]=this.terms[e].add(a.terms[e]),d.sum=d.sum.add(d.terms[e]);return d},s.prototype.isZero=function(){return this.coeff.equals(0)},s.prototype.toString=function(){return"{ coeff: "+this.coeff.toString()+", terms: ["+this.terms.join(",")+"]: sum: "+this.sum.toString()+", count: "+this.count+"}"},a.Utils.toMapObj=function(a){for(var b=0,c={},d=0;d<a.length;d++){var e=a[d];"undefined"==typeof c[e]&&(c[e]=b,b++)}return c.length=b,c},a.Utils.filledArray=function(a,b,c){for(var d=[];b--;)d[b]=c?new c(a):a;return d},a.Utils.arrSum=function(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d];return b},a.Utils.subFunctions=function(b,c){c=c||{};var d=[];return b.each(function(b){if(b.group===f||b.previousGroup===f){var e=a.Utils.text(b,"hash"),k=c[e];if(k)d.push(b.altVar(k));else{var l=b.fname+j(c).length;c[e]=l,d.push(b.altVar(l))}}else b.group===i||b.group===g||b.group===h?d.push(a.Utils.subFunctions(b,c)):d.push(b.text())}),b.group===h||b.group===g?b.altVar(a.Utils.inBrackets(d.join("+"))):b.group===i?b.altVar(a.Utils.inBrackets(d.join("*"))):b.text()},a.Utils.getFunctionsSubs=function(a){var c={};for(var d in a)c[a[d]]=b.parse(d);return c};var t=a.Algebra={version:"1.4.0",init:void 0,proots:function(b,c){function y(a,b,d){function j(a,b,c,d,e,f){e[0]=f.b=d[0],e[1]=f.a=-(b*f.b)+d[1];for(var g=2;g<a;g++)e[g]=-(b*f.a+c*f.b)+d[g],f.b=f.a,f.a=e[g]}function k(a,b,c,d,e,f,g,h,i){var k=new Object,l=3;return k.b=k.a=0,j(b,g,h,f,i,k),e.c=k.a,e.d=k.b,Math.abs(e.c)<=100*a*Math.abs(f[b-1])&&Math.abs(e.d)<=100*a*Math.abs(f[b-2])?l:(e.h=h*d,Math.abs(e.d)>=Math.abs(e.c)?(l=2,e.e=c/e.d,e.f=e.c/e.d,e.g=g*d,e.a3=e.e*(e.g+c)+e.h*(d/e.d),e.a1=-c+e.f*d,e.a7=e.h+(e.f+g)*c):(l=1,e.e=c/e.c,e.f=e.d/e.c,e.g=e.e*g,e.a3=e.e*c+(e.g+e.h/e.c)*d,e.a1=-(c*(e.d/e.c))+d,e.a7=e.g*e.d+e.h*e.f+c),l)}function m(a,b,c,d,e,f,g,h,i){var j;if(3!=c)if(j=1==c?e:d,Math.abs(f.a1)>10*a*Math.abs(j)){f.a7/=f.a1,f.a3/=f.a1,g[0]=i[0],g[1]=-(i[0]*f.a7)+i[1];for(var k=2;k<b;k++)g[k]=-(i[k-1]*f.a7)+h[k-2]*f.a3+i[k]}else{g[0]=0,g[1]=-(i[0]*f.a7);for(var k=2;k<b;k++)g[k]=-(i[k-1]*f.a7)+h[k-2]*f.a3}else{g[1]=g[0]=0;for(var k=2;k<b;k++)g[k]=h[k-2]}}function n(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z;b.b=b.a=0,3!=a&&(2!=a?(r=c+m*g+l*j,s=h+(m+n*j)*i):(r=(c+k)*j+l,s=(j+m)*h+n*i),t=-(o[p-1]/q[p]),u=-(o[p-2]+t*q[p-1])/q[p],v=n*u*d,w=t*f,x=t*t*e,y=-(w+x)+v,z=-y+s+t*r,0!=z&&(b.a=-((m*(x+w)+n*(t*d+u*f))/z)+m,b.b=n*(1+y/z)))}function o(a,b,c,d){var e,f,g;return d.sr=d.si=d.lr=d.li=0,0==a?void(d.sr=0!=b?-(c/b):d.sr):0==c?void(d.lr=-(b/a)):(e=b/2,Math.abs(e)<Math.abs(c)?(g=c>=0?a:-a,g=-g+e*(e/Math.abs(c)),f=Math.sqrt(Math.abs(g))*Math.sqrt(Math.abs(c))):(g=-(a/e*(c/e))+1,f=Math.sqrt(Math.abs(g))*Math.abs(e)),void(g>=0?(f=e>=0?-f:f,d.lr=(-e+f)/a,d.sr=0!=d.lr?c/d.lr/a:d.sr):(d.lr=d.sr=-(e/a),d.si=Math.abs(f/a),d.li=-d.si)))}function p(a,b,c,d,e,f,g,h,i,l,p,q){var s,t,u,v,w,x,y,z,A,B,C,E,r=new Object,D=0,F=0;c.NZ=0,x=d,z=e;do{if(r.li=r.lr=r.si=r.sr=0,o(1,x,z,r),c.szr=r.sr,c.szi=r.si,c.lzr=r.lr,c.lzi=r.li,Math.abs(Math.abs(c.szr)-Math.abs(c.lzr))>.01*Math.abs(c.lzr))break;for(j(g,x,z,i,f,h),t=Math.abs(-(c.szr*h.b)+h.a)+Math.abs(c.szi*h.b),B=Math.sqrt(Math.abs(z)),s=2*Math.abs(f[0]),w=-(c.szr*h.b),C=1;C<b;C++)s=s*B+Math.abs(f[C]);if(s=s*B+Math.abs(w+h.a),s=(9*s+2*Math.abs(w)-7*(Math.abs(h.a+w)+B*Math.abs(h.b)))*a,t<=20*s){c.NZ=2;break}if(D++,D>20)break;if(D>=2&&v<=.01&&t>=u&&!F){for(v=v<a?Math.sqrt(a):Math.sqrt(v),x-=x*v,z+=z*v,j(g,x,z,i,f,h),C=0;C<5;C++)E=k(a,b,h.a,h.b,p,q,x,z,l),m(a,b,E,h.a,h.b,p,q,l,f);F=1,D=0}u=t,E=k(a,b,h.a,h.b,p,q,x,z,l),m(a,b,E,h.a,h.b,p,q,l,f),E=k(a,b,h.a,h.b,p,q,x,z,l),n(E,h,h.a,p.a1,p.a3,p.a7,h.b,p.c,p.d,p.f,p.g,p.h,x,z,q,b,i),y=h.a,A=h.b,0!=A&&(v=Math.abs((-z+A)/A),x=y,z=A)}while(0!=A)}function r(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u=d-1;for(b.NZ=t=r=0,p=c.a;;){for(o=e[0],g[0]=o,s=1;s<f;s++)g[s]=o=o*p+e[s];for(l=Math.abs(o),m=Math.abs(p),j=.5*Math.abs(g[0]),s=1;s<f;s++)j=j*m+Math.abs(g[s]);if(l<=20*a*(2*j-l)){b.NZ=1,b.szr=p,b.szi=0;break}if(t++,t>10)break;if(t>=2&&Math.abs(q)<=.001*Math.abs(-q+p)&&l>n){r=1,b.a=p;break}for(n=l,i[0]=k=h[0],s=1;s<d;s++)i[s]=k=k*p+h[s];if(Math.abs(k)>10*Math.abs(h[u])*a)for(q=-(o/k),h[0]=g[0],s=1;s<d;s++)h[s]=q*i[s-1]+g[s];else for(h[0]=0,s=1;s<d;s++)h[s]=i[s-1];for(k=h[0],s=1;s<d;s++)k=k*p+h[s];q=Math.abs(k)>10*Math.abs(h[u])*a?-(o/k):0,p+=q}return r}function s(a,b,c,d,e,f,g,h,i,l,o,q){var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,Q,R,S,T,U,V,s=new Object,t=new Object,u=new Array(b),v=new Array(b),P=1;for(q.NZ=0,z=y=.25,A=d,D=e,s.b=s.a=0,j(i,o,e,h,l,s),w=s.a,x=s.b,t.h=t.g=t.f=t.e=t.d=t.c=t.a7=t.a3=t.a1=0,T=k(a,g,w,x,t,f,o,e,u),Q=0;Q<c;Q++){if(N=1,m(a,g,T,w,x,t,f,u,l),T=k(a,g,w,x,t,f,o,e,u),n(T,s,w,t.a1,t.a3,t.a7,x,t.c,t.d,t.f,t.g,t.h,o,e,f,g,h),K=s.a,M=L=s.b,F=0!=f[g-1]?-(h[g]/f[g-1]):0,G=I=1,0!=Q&&3!=T&&(I=0!=M?Math.abs((M-D)/M):I,G=0!=F?Math.abs((F-A)/F):G,J=I<C?I*C:1,H=G<B?G*B:1,U=J<z?1:0,R=H<y?1:0,R||U)){for(O=0;O<g;O++)v[O]=f[O];for(E=F,S=V=0;;){if(N&&0==(N=0)&&R&&(!U||H<J));else{if(p(a,g,q,K,L,l,i,s,h,u,t,f),w=s.a,x=s.b,q.NZ>0)return;if(P=V=1,z*=.25,S||!R)P=0;else for(O=0;O<g;O++)f[O]=v[O]}if(0!=P){if(s.a=E,P=r(a,q,s,g,h,i,l,f,u),E=s.a,q.NZ>0)return;if(S=1,y*=.25,0!=P){K=-(E+E),L=E*E;continue}}for(O=0;O<g;O++)f[O]=v[O];if(!U||V)break}j(i,o,e,h,l,s),w=s.a,x=s.b,T=k(a,g,w,x,t,f,o,e,u)}D=M,A=F,C=I,B=G}}function t(a,b,c,d){var p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,e=a.Degree,f=.017453292519943295,g=Math.LN2,h=a.Degree+1,i=new Array(h),j=new Array(h),k=new Array(h),l=new Array(h),m=new Object,n=new Object;B=1;do q=B,B/=2,C=1+B;while(C>1);var O=Number.MIN_VALUE/q,P=Math.cos(94*f),Q=Math.sin(94*f),R=Math.sqrt(.5),S=-R;for(n.NZ=I=0,n.szr=n.szi=n.lzr=n.lzi=0;0==b[e];)c[I]=d[I]=0,e--,I++;for(M=e+1;e>=1;){if(e<=2){e<2?(c[a.Degree-1]=-(b[1]/b[0]),d[a.Degree-1]=0):(m.li=m.lr=m.si=m.sr=0,o(b[0],b[1],b[2],m),c[a.Degree-2]=m.sr,d[a.Degree-2]=m.si,c[a.Degree-1]=m.lr,d[a.Degree-1]=m.li);break}for(w=0,x=Number.MAX_VALUE,T=0;T<M;T++)z=Math.abs(b[T]),z>w&&(w=z),0!=z&&z<x&&(x=z);if(y=O/x,(y<=1&&w>=10||y>1&&Number.MAX_VALUE/y>=w)&&(y=0==y?Number.MIN_VALUE:y,K=Math.floor(Math.log(y)/g+.5),u=Math.pow(2,K),1!=u))for(T=0;T<M;T++)b[T]*=u;for(var T=0;T<M;T++)j[T]=Math.abs(b[T]);j[e]=-j[e],L=e-1,z=Math.exp((Math.log(-j[e])-Math.log(j[0]))/e),0!=j[L]&&(A=-j[e]/j[L],z=A<z?A:z),A=z;do{z=A,A=.1*z,v=j[0];for(var T=1;T<M;T++)v=v*A+j[T]}while(v>0);t=z;do{r=v=j[0];for(var T=1;T<e;T++)v=z*v+j[T],r=z*r+v;v=z*v+j[e],t=v/r,z-=t}while(Math.abs(t/z)>.005);p=z;for(var T=1;T<e;T++)i[T]=(e-T)*b[T]/e;for(i[0]=b[0],B=b[e],C=b[L],N=0==i[L]?1:0,J=0;J<5;J++)if(D=i[L],N){for(var T=0;T<L;T++)I=L-T,i[I]=i[I-1];i[0]=0,N=0==i[L]?1:0}else{F=-B/D;for(var T=0;T<L;T++)I=L-T,i[I]=F*i[I-1]+b[I];i[0]=b[0],N=Math.abs(i[L])<=Math.abs(C)*q*10?1:0}for(var T=0;T<e;T++)l[T]=i[T];for(J=1;J<=20;J++){if(H=-(Q*S)+P*R,S=Q*R+P*S,R=H,E=p*R,G=-(2*E),s(q,h,20*J,E,p,i,e,b,M,k,G,n),0!=n.NZ){I=a.Degree-e,c[I]=n.szr,d[I]=n.szi,M-=n.NZ,e=M-1;for(var T=0;T<M;T++)b[T]=k[T];1!=n.NZ&&(c[I+1]=n.lzr,d[I+1]=n.lzi);break}for(var T=0;T<e;T++)i[T]=l[T]}if(J>20){a.Degree-=e;break}}}var e=100,f=a.slice(0);if(a.unshift(d),d>e)throw new Error("This utility accepts polynomials of degree up to "+e+". ");var g=[],h={};for(h.Degree=d,q=0;q<d;q++)g.push(0);var i=g.slice(0);t(h,f,i,g);
var u=g.length;for(q=0;q<u;q++){var v=l(g[q],c+8),w=l(i[q],c);w=c-String(w).length>2?w:i[q];var x=v<0?"-":"";0===w&&(w=""),0===v&&(v=""),v=1===Math.abs(v)?x+"i":v?v+"*i":"";var y=w&&v?w+"+"+v:w+v;i[q]=y.replace(/\+\-/g,"-")}return i}c=c||7;var e=0,f=function(a,b,c){for(var d=y(a,b,c),f=0;f<e;f++)d.unshift(0);return d};if(b instanceof o&&b.isPoly()){if(b.group===a.groups.S)return[0];if(b.group===a.groups.PL)var g=j(b.symbols),h=a.Utils.arrayMin(g),b=a.PARSER.divide(b,a.PARSER.parse(b.value+"^"+h));for(var i=j(b.symbols).sort().pop(),k=b.group===a.groups.PL?b.symbols:b.symbols[i],m=k.group,g=m===d?[k.power.toDecimal()]:j(k.symbols),n=[],p=a.Utils.arrayMax(g),q=1;q<=p;q++){var r=0;g.indexOf(q+"")!==-1&&(r=m===d?k.multiplier:k.symbols[q].multiplier),n.unshift(r)}return n.push(b.symbols["#"].multiplier),k.group===d&&(n[0]=k.multiplier),f(n,g,p)}if(a.Utils.isArray(b)){for(var s=b,n=[],g=[],t=0,q=0;q<s.length;q++){for(var u=s[q][0],v=s[q][1],w=v-t-1,x=0;x<w;x++)n.unshift(0);n.unshift(u),0!==v&&g.push(v),t=v}var p=Math.max.apply(void 0,g);return f(n,g,p)}throw new Error("Cannot calculate roots. Symbol must be a polynomial!")},roots:function(c){var d=t.proots(c).map(function(a){return b.parse(a)});return a.Vector.fromArray(d)},froot:function(b,c,d){var e=function(c){for(var e=1e-12,f=d?d:a.Utils.build(a.Calculus.diff(b.clone())),g=b instanceof Function?b:a.Utils.build(b),h=1e4,i=!1,j=0;!i;){var k=c-g(c)/f(c),l=Math.abs(k)-Math.abs(c),m=Math.abs(l);c=k,m<e?i=!0:j>h&&(c=null,i=!0),j++}return c};return e(Number(c))},quad:function(a,c,d){var e=function(a,c,d,e){return b.parse("-("+c+"+"+e+"*sqrt(("+c+")^2-4*("+a+")*("+d+")))/(2*"+a+")")};return[e(a,c,d,1),e(a,c,d,-1)]},sumProd:function(a,b){return t.quad(-b,a,-1).map(function(a){return a.invert()})},polyPowers:function(b,e,f){f=f||[];var k=k=b.group;if(k===g&&e===b.value)f=f.concat(j(b.symbols));else if(k===h)for(var l in b.symbols){var m=b.symbols[l],k=m.group,n=m.value;if(k===d&&e===n)f.push(m.power);else if(k===g||k===h)f=t.polyPowers(m,e,f);else if(k===i&&m.contains(e)){var o=m.symbols[e];o&&f.push(o.power)}else k!==c&&e===n||f.push(0)}return a.Utils.arrayUnique(f).sort()},Factor:{mix:function(a,b){for(var c=j(a),d=c.length,e=[],f=0;f<d;f++){for(var g=c[f],h=a[g],i=e.length,k=0;k<i;k++){var l=e[k]*g;e.push(l),b&&e.push(-l)}for(var k=1;k<=h;k++)e.push(Math.pow(g,k))}return e},factor:function(c,e){if(c.group===d)return c;var f=c.power.clone();if(n(f)){c.toLinear(),e=e||new r;var h,g={};c=b.parse(a.Utils.subFunctions(c,g)),j(g).length>0&&(e.preAdd=function(c){return b.parse(c,a.Utils.getFunctionsSubs(g))}),c.isLinear()||(e.pFactor=c.power.toString(),c.toLinear());var i=k(c),l=i.length>1;if(l&&(h=c.clone()),l){var m=!0,o=!0;if(c.each(function(a){a.group!==d&&(m=!1),a.multiplier.equals(1)||(o=!1)}),m&&o)return b.pow(c,b.parse(f))}c=t.Factor.coeffFactor(c,e),c=t.Factor.powerFactor(c,e),1===i.length?(c=t.Factor.squareFree(c,e),c=t.Factor.trialAndError(c,e)):c=t.Factor.mfactor(c,e),c=b.parse(c,a.Utils.getFunctionsSubs(g)),e.add(c);var p=e.toSymbol();return l&&!a.Utils.compare(h,p,i)?h:b.pow(p,b.parse(f))}return c},squareFree:function(a,b){if(a.isConstant()||a.group===d)return a;var c=new q(a),e=c.squareFree(),f=e[2];if(1!==f){var g=e[1].toSymbol();return g.power=g.power.multiply(new m(f)),b.add(t.Factor.factor(g)),t.Factor.squareFree(e[0].toSymbol(),b)}return a},powerFactor:function(c,d){if(c.group!==g)return c;var e=a.Utils.arrayMin(j(c.symbols)),f=new o(0),h=b.parse(c.value+"^"+e);return c.each(function(a){a=b.divide(a,h.clone()),f=b.add(f,a)}),d.add(h),f},coeffFactor:function(b,c){if(b.isComposite()){var d=a.Math2.QGCD.apply(null,b.coeffs());d.equals(1)||b.each(function(a){a.isComposite()?a.each(function(a){a.multiplier=a.multiplier.divide(d)}):a.multiplier=a.multiplier.divide(d)}),b.updateHash(),c&&c.add(new o(d))}return b},trialAndError:function(b,c){if(b.isConstant()||b.group===d)return b;for(var e=new q(b),f=e.coeffs[0],g=a.Math2.ifactor(f),h=t.proots(b),i=0;i<h.length;i++){var j=h[i],k=1;if(!isNaN(j)){for(var l in g){var o=a.Utils.round(Math.log(l)/Math.log(Math.abs(j)),8);if(n(o)){j=l,k=o;break}}var p=new m(j),r=[new m(p.num).negate()];r[k]=new m(p.den);var s=q.fromArray(r,e.variable).fill(),u=e.divide(s);u[1].equalsNumber(0)&&(e=u[0],c.add(s.toSymbol()))}}return e.equalsNumber(1)||(e=t.Factor.search(e,c)),e.toSymbol()},search:function(b,c,d){d=d||10;var e=b.variable,f=function(a,f,g,h){var i=q.fit(a,f,g,d,h,e);if(i&&i.coeffs.length>1){var j=b.divide(i);if(j[1].equalsNumber(0))return c.add(i.toSymbol()),[j[0],i]}return null},g=b.coeffs[0],h=a.Math2.ifactor(g),i=b.lc(),j=a.Math2.ifactor(i),k=b.sub(d),l=t.Factor.mix(a.Math2.ifactor(k),k<0),m=Math.ceil(b.coeffs.length/2),n=i.lessThan(0),o=g.lessThan(0);for(j[1]=1,h[1]=1;m--;)for(var p in j)for(var r in h)for(var s=0;s<l.length;s++){var u=f(p,r,l[s],m);if(u)return b=u[0],a.Utils.isPrime(b.sub(d))||(b=t.Factor.search(b,c)),b;!u&&n?u=f(-p,r,l[s],m):!u&&o?u=f(p,-r,l[s],m):!u&&n&&o&&(u=f(-p,-r,l[s],m))}return b},mSqfrFactor:function(b,c){for(var d=k(b).reverse(),e=0;e<d.length;e++)do{var f=t.Factor.coeffFactor(a.Calculus.diff(b,d[e]));if(f.equals(0))break;var g=t.div(b,f.clone()),h=g[1].equals(0);if(g[0].isConstant()){c.add(g[0]);break}h&&(c.add(g[0]),b=f)}while(h);return b},mfactor:function(a,c){a=t.Factor.mSqfrFactor(a,c);for(var d=k(a),e=a.collectSymbols(),f={},g={},h=d.length,i=e.length,j=0;j<h;j++){var l=d[j];f[l]=new o(0);for(var m=0;m<i;m++){var n=e[m];if(n.contains(l)){var p=n.value===l?n.power.toDecimal():n.symbols[l].power.toDecimal();(!g[l]||p<g[l])&&(g[l]=p),f[l]=b.add(f[l],n.clone())}}}for(var q in f){var r=b.parse(q+"^"+g[q]),s=b.expand(b.divide(f[q],r)),u=t.div(a.clone(),s);if(u[0].equals(0))return u[1];if(u[1].equals(0)){var v=u[0];c.add(v),c.add(s);var w=t.div(a,u[0].clone()),r=w[0];return r.isConstant()?(c.add(r),r):t.Factor.mfactor(r,c)}}return a}},allLinear:function(a){for(var b=a.length,c=0;c<b;c++)if(!t.isLinear(a[c]))return!1;return!0},isLinear:function(a){var b=!1,j=a.group;if(j===g||j===h){b=!0;for(var k in a.symbols){var l=a.symbols[k],m=l.group;if(m===f||m===e||m===i)b=!1;else if(m===g||m===h)b=t.isLinear(l);else if(l.group!==c&&"1"!==l.power.toString()){b=!1;break}}}else j===d&&1===a.power&&(b=!0);return b},gcd:function(b,c){if(b.length<c.length){var d=b;b=c,c=d}var e=k(b),f=k(c);if(e.length===f.length&&1===e.length&&e[0]===f[0])return b=new q(b),c=new q(c),b.gcd(c).toSymbol();for(var g;!c.equals(0);){var d=c.clone();if(b=b.clone(),g=t.div(b,d),c=g[1],g[0].equals(0))return new o(a.Math2.QGCD(b.multiplier,c.multiplier));b=d}var h=[];b.each(function(a){h.push(a.multiplier)});var i=a.Math2.QGCD.apply(void 0,h);return i.equals(1)||b.each(function(a){a.multiplier=a.multiplier.divide(i)}),b},divide:function(a,c){var d=t.div(a,c),e=b.divide(d[1],c);return b.add(d[0],e)},div:function(c,e){if(e.isConstant())return c.each(function(a){a.multiplier=a.multiplier.divide(e.multiplier)}),[c,new o(0)];if(c.group===d&&e.group===h){var f=e.symbols[c.value];if(f&&e.isLinear()&&f.isLinear()&&c.isLinear())return[new o(1),b.subtract(c.clone(),e.clone())]}var g=c.hasFunc(),i=e.hasFunc(),j=!1;if(g||i){j=!0;var l={},c=b.parse(a.Utils.subFunctions(c,l)),e=b.parse(a.Utils.subFunctions(e,l)),n=a.Utils.getFunctionsSubs(l)}var t,u,r=a.Utils.arrayUnique(k(c).concat(k(e)));if(1===r.length){var v=new q(c).divide(new q(e));t=v[0].toSymbol(),u=v[1].toSymbol()}else{r.push(p);var w=function(a){for(var c=new o(0),d=0;d<a.length;d++){var e=a[d].toSymbol();c=b.add(c,e)}return c},x=function(a,b){var e,c=Math.max.apply(null,a.terms),d=0;if(!b)for(var f=0;f<a.terms.length;f++)if(a.terms[f].equals(c)&&(e=f,d++),d>1)return;if(b)for(f=0;f<a.terms.length;f++)if(a.terms[f].equals(c)){e=f;break}return[c,e,a]},y=function(a,b){b=b||0;var c=a[b],d=a.length;if(c){for(var e=x(c),f=b+1;f<d;f++){var g=a[f],h=c.sum.equals(g.sum);if(!h&&e)break;if(h){for(var i,j,k,l,m=c.terms.length,n=0;n<m;n++){var o=c.terms[n],p=g.terms[n];("undefined"==typeof i||o.greaterThan(i))&&(i=o,k=n),("undefined"==typeof j||p.greaterThan(j))&&(j=p,l=n)}var q=i.subtract(g.terms[k]),r=j.subtract(c.terms[l]);if(r>q){e=[j,l,g];break}if(q>r){e=[i,k,c];break}}else if(e=x(g))break;e=x(g)}if(!e)return x(a[0],!0);for(var s,t,f=0;f<D.length;f++){var u=D[f].terms;if(t=e[1],t===u.length-1)return;if(s=u[t],!s.equals(0))break}return s.equals(0)?y(a,++b):e}},z=a.Utils.toMapObj(r),A=function(a,b){return b.sum.subtract(a.sum)},B=function(a,b){if(!a||!b)return!1;for(var c=0;c<a.terms.length;c++)if(a.terms[c].lessThan(b.terms[c]))return!1;return!0},C=c.tBase(z).sort(A),D=e.tBase(z).sort(A),E=B(C[0],D[0])&&C[0].count>D[0].count?D:C,F=y(E),G=[];if(F){var H=F[1],I=function(a,b){return!a[0].sum.equals(b[0].sum)||a.length>=b.length},J=function(a,b,c){return c},K=function(a,b){var c=a.len(),d=b.len(),e=b.terms[H],f=a.terms[H];return d>c&&e.greaterThan(f)?d-c:e.subtract(f)};H=J(C,D,H),C.sort(K),D.sort(K);var L=D[0],M=C[0],N=new s(new m(1),[],M.map);if(L.sum.greaterThan(M.sum)&&M.len()>1)for(var O=0;O<M.terms.length;O++){var P=L.terms[O].subtract(M.terms[O]);if(P.equals(0))N.terms[O]=new m(0);else{var Q=P.add(new m(1));N.terms[O]=P;for(var R=0;R<C.length;R++)C[R].terms[O]=C[R].terms[O].add(Q)}}for(var S=B(C[0],D[0]);S&&I(C,D);){var v=C[0].divide(D[0]);G.push(v),C.shift();for(var O=1;O<D.length;O++){var T=D[O].multiply(v).generateImage(),U=C.length;0===U&&(T.coeff=T.coeff.neg(),C.push(T),C.sort(K));for(var R=0;R<U;R++){var V=C[R];if(V.getImg()===T.getImg()){V.coeff=V.coeff.subtract(T.coeff),V.coeff.equals(0)&&(a.Utils.remove(C,R),R--);break}R===U-1&&(T.coeff=T.coeff.neg(),C.push(T),C.sort(K))}}if(S=B(C[0],D[0]),!S&&C.length>=D.length)for(var O=1;O<C.length;O++)if(S=B(C[O],D[0])){C.unshift(a.Utils.remove(C,O));break}}}t=w(G),u=w(C),"undefined"!=typeof N&&(N=N.toSymbol(),t=b.divide(t,N.clone()),u=b.divide(u,N))}return j&&(t=b.parse(t.text(),n),u=b.parse(u.text(),n)),[t,u]},Classes:{Polynomial:q,Factors:r,MVTerm:s}};nerdamer.register([{name:"factor",visible:!0,numargs:1,build:function(){return t.Factor.factor}},{name:"gcd",visible:!0,numargs:2,build:function(){return t.gcd}},{name:"roots",visible:!0,numargs:-1,build:function(){return t.roots}},{name:"divide",visible:!0,numargs:2,build:function(){return t.divide}},{name:"div",visible:!0,numargs:2,build:function(){return t.div}}])}(),function(){"use strict";var a=nerdamer.getCore(),b=a.PARSER,c=a.Frac,d=a.Utils.isSymbol,e=a.groups.FN,f=a.Symbol,g=a.Utils.text,h=a.Utils.inBrackets,i=a.Utils.isInt,j=a.Utils.format,k=a.groups.N,l=a.groups.S,e=a.groups.FN,m=a.groups.PL,n=a.groups.CP,o=a.groups.CB,p=a.groups.EX,q=a.groups.P,r="log",s="abs",t="sqrt",u="sin",v="cos",w="tan",x="sec",y="csc",z="cot",A="asin",B="acos",C="atan",D="asec",E="acsc",F="acot";f.prototype.hasIntegral=function(){if(this.group===e&&"integrate"===this.fname)return!0;if(this.symbols)for(var a in this.symbols)if(this.symbols[a].hasIntegral())return!0;return!1},a.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},a.Utils.in_inverse_trig=function(a){var b=[A,B,C,E,D,F];return b.indexOf(a)!==-1},a.Utils.in_trig=function(a){var b=[v,u,w,x,y,z];return b.indexOf(a)!==-1},a.Settings.integration_depth=4;var G=a.Calculus={version:"1.3.1",sum:function(c,d,e,h){if(d.group!==a.groups.S)throw new Error("Index must be symbol. "+g(d)+" provided");d=d.value;var i;if(a.Utils.isNumericSymbol(e)&&a.Utils.isNumericSymbol(h)){e=e.multiplier,h=h.multiplier;var j=a.Utils.variables(c);if(1===j.length&&d===j[0]){var k=a.Utils.build(c);i=0;for(var l=e;l<=h;l++)i+=k.call(void 0,l)}else for(var k=c.text(),m={"~":!0},i=new a.Symbol(0),l=e;l<=h;l++)m[d]=new f(l),i=b.add(i,b.parse(k,m))}else i=b.symfunction("sum",arguments);return i},diff:function(i,j,D){function K(a){return(a.value===E||a.contains(E,!0))&&(a.multiplier=a.multiplier.multiply(a.power),a.power=a.power.subtract(new c(1)),a.power.equals(0)&&(a=f(a.multiplier))),a}function L(a){var j,t,D,i=a.group;if(i===k||i===l&&a.value!==E||i===q)a=f(0);else if(i===l)a=K(a);else{if(i===o){var F=a.multiplier.clone();a.toUnitMultiplier();var H=b.multiply(N(a),K(a.clone()));return H.multiplier=H.multiplier.multiply(F),H}if(i===e&&a.power.equals(1))switch(a.fname){case r:D=a.clone(),a=a.args[0].clone(),a.power=a.power.negate(),a.multiplier=D.multiplier.divide(a.multiplier);break;case v:a.fname=u,a.multiplier.negate();break;case u:a.fname=v;break;case w:a.fname=x,a.power=new c(2);break;case x:a=M(a,w);break;case y:a=M(a,"-cot");break;case z:a.fname=y,a.multiplier.negate(),a.power=new c(2);break;case A:a=b.parse("(sqrt(1-("+g(a.args[0])+")^2))^(-1)");break;case B:a=b.parse("-(sqrt(1-("+g(a.args[0])+")^2))^(-1)");break;case C:a=b.parse("(1+("+g(a.args[0])+")^2)^(-1)");break;case s:F=a.multiplier.clone(),a.toUnitMultiplier(),t=a.args[0].clone(),t.toUnitMultiplier(),a=b.parse(h(g(a.args[0]))+"/abs"+h(g(t))),a.multiplier=F;break;case"parens":a=f(1);break;case"cosh":a.fname="sinh";break;case"sinh":a.fname="cosh";break;case"tanh":a.fname="sech",a.power=new c(2);break;case"sech":a=M(a,"-tanh");break;case"asinh":a=b.parse("(sqrt(1+("+g(a.args[0])+")^2))^(-1)");break;case"acosh":a=b.parse("(sqrt(-1+("+g(a.args[0])+")^2))^(-1)");break;case"atanh":a=b.parse("(1-("+g(a.args[0])+")^2)^(-1)");break;case"Si":var I=a.args[0];a=b.parse("sin("+I+")/("+I+")");break;case"Ci":var I=a.args[0];a=b.parse("cos("+I+")/("+I+")")}else if(i===p||i===e&&d(a.power)){var J;J=i===p?a.value:i===e&&a.contains(E)?a.fname+h(g(a.args[0])):a.value+h(g(a.args[0])),j=b.multiply(b.parse(r+h(J)),a.power.clone()),t=G.diff(b.multiply(b.parse(r+h(J)),a.power.clone()),E),a=b.multiply(a,t)}else if(i!==e||a.power.equals(1)){if(i===n||i===m){var O=new f(0);for(var P in a.symbols)O=b.add(O,G.diff(a.symbols[P].clone(),E));a=b.multiply(K(a.clone()),O)}}else t=a.clone(),t.toLinear(),t.toUnitMultiplier(),a=b.multiply(K(a.clone(),E),L(t))}return a.updateHash(),a}function M(a,c,d){return b.multiply(a,b.parse(c+h(d||g(a.args[0]))))}function N(a){for(var c=a.collectSymbols(),d=new f(0),e=c.length,g=0;g<e;g++){for(var h=G.diff(c[g].clone(),E),i=0;i<e;i++)g!==i&&(h=b.multiply(h,c[i].clone()));d=b.add(d,h)}return d}var E=d(j)?j.text():j;if(D=d(D)?D.multiplier:D||1,void 0===E&&(E=a.Utils.variables(i)[0]),i.group===e&&i.fname===t){var F=i.args[0],H=i.power.clone();F.group===k&&F.group===q||(F.power=d(F.power)?b.multiply(F.power,b.multiply(new f(.5)),H):F.power.multiply(new c(.5)).multiply(H),F.multiplier=F.multiplier.multiply(i.multiplier)),i=F}if(i.group!==e||d(i.power))i=L(i);else{var I=L(i),J=G.diff(i.args[0].clone(),E);i=b.multiply(I,J)}return D>1&&(D--,i=G.diff(i,j,D)),i},integration:{u_substitution:function(c,d){function g(a,c,e){var f=e?e(a,c):b.divide(a.clone(),G.diff(c,d));return f.contains(d)?null:f}function h(a,c){var d=G.integrate(b.symfunction(a,[new f(m)]),m);return d=d.sub(new f(m),c),d.updateHash(),d}var n,i=c[0].clone(),j=c[1].clone(),k=i.group,l=j.group,m="__u__";if(k===e&&l!==e){var o=i.args[0];if(n=g(j,o.clone()))return b.multiply(n,h(i.fname,o));if(n=g(j,i))return G.integration.poly_integrate(i)}else if(l===e&&k!==e){var o=j.args[0];if(n=g(i,o.clone()))return b.multiply(n,h(j.fname,o))}else if(k===e&&k===e){if(n=g(i.clone(),j.clone()))return b.multiply(G.integration.poly_integrate(j),n);if(n=g(j.clone(),i.clone()))return b.multiply(G.integration.poly_integrate(j),n)}else{if(k===p&&l!==p){var q=i.power;n=g(j,q.clone());var r=G.integrate(i.sub(q,new f(m)),m);return b.multiply(r.sub(new f(m),q),n)}if(l===p&&k!==p){var q=j.power;n=g(i,q.clone());var r=G.integrate(j.sub(q,new f(m)),m);return b.multiply(r.sub(new f(m),q),n)}if(i.isComposite()||j.isComposite()){var s=function(c,e){var f=a.Algebra.Factor.factor(c),g=a.Algebra.Factor.factor(G.diff(e,d)),h=b.divide(f,g);return h},t=i.isComposite()?i.clone().toLinear():i.clone(),u=j.isComposite()?j.clone().toLinear():j.clone();if(n=g(t.clone(),u.clone(),s))return b.multiply(G.integration.poly_integrate(j),n);if(n=g(u.clone(),t.clone(),s))return b.multiply(G.integration.poly_integrate(i),n)}}},poly_integrate:function(a){var c=a.power.toString(),d=a.multiplier.toString(),e=a.toUnitMultiplier().toLinear();return Number(c)===-1?b.multiply(new f(d),b.symfunction(r,[e])):b.parse(j("({0})*({1})^(({2})+1)/(({2})+1)",d,e,c))},stop:function(a){throw a=a||"Stopping!",new Error(a)},partial_fraction:function(c,g,h){var i,j,k=new f(c.multiplier);if(d(c)?(j=c.getDenom().invert(),i=c.getNum()):(i=c[0],j=c[1]),i.isConstant()){var m=j.clone().toLinear(),o=m.stripVar(g),p=b.subtract(m.clone(),o);if(p.group===l&&p.isLinear())return G.integration.poly_integrate(c);j.power.greaterThan(1)&&(j=b.expand(j))}var q=a.Algebra.div(i,j.clone()),s=new a.Matrix,t=new a.Matrix,u=q[1].toArray(g),i=q[1],v=a.Algebra.Factor.factor(j);i.group!==n||v.length>1||G.integration.stop();var w=[],x=q[0].equals(0)?q[0]:G.integrate(q[0],g,h);if(v.group===n){if(q[1].isComposite())q[1].each(function(a){var c=b.divide(a.clone(),v.clone());x=b.add(x,G.integrate(c,g,h))});else{var m=v.clone().toLinear(),y=G.integration.decompose_arg(m,g),z=y[2],o=y[0],A=y[3];z.isLinear()||G.integration.stop(),v.power.equals(2)?(x=b.add(x,b.add(b.symfunction(r,[m.clone()]),b.divide(A,m))),x=b.divide(x,b.pow(o,new f(2)))):x=G.integration.by_parts(b.divide(q[1],v.clone()),g,a.Settings.integration_depth)}return x}v.each(function(a){a.group!==e||a.fname||(a=a.args[0]),a.isLinear()||(a=b.expand(a)),a.isConstant()?k=b.multiply(k,a):w.push(a)});var B=w.length;if(1===B){var C=b.divide(q[1],w[0]),D=G.integrate(C,g,h);return D=b.divide(D,k),x=b.add(x,D)}for(var E=0;E<B;E++){for(var F=new f(1),H=0;H<B;H++)E!==H&&(F=b.multiply(F,w[H].clone()));F=b.expand(F).toArray(g);var I=u[E];t.elements[E]=I?[I]:[f(0)],s.elements[E]=F}for(var J=s.transpose().invert().multiply(t),E=0;E<B;E++){var K=G.integrate(b.divide(q[1].clone(),w[E]),g,h),L=b.expand(J.elements[E][0]),M=b.divide(L,k.clone());x=b.add(x,b.multiply(K,M))}return x},by_parts:function(c,d,g){var i,j,k,m,n,q,s,t,u,v,h=function(c){var d=[[],[],[],[],[]],g=function(b){var c=b.group;if(c===e){var f=b.fname;a.Utils.in_trig(f)?d[3].push(b):a.Utils.in_inverse_trig(f)?d[1].push(b):f===r?d[0].push(b):stop()}else c===l||b.isComposite()&&b.isLinear()||c===o&&b.isLinear()?d[2].push(b):c===p||b.isComposite()&&!b.isLinear()?d[4].push(b):stop()};c.group===o?c.each(function(a){g(f.unwrapSQRT(a,!0))}):g(c);for(var h,i=new f(1),j=0;j<5;j++){var m,k=d[j],n=k.length;if(n>0){if(n>1){m=new f(1);for(var q=0;q<n;q++)m=b.multiply(m,k[q].clone())}else m=k[0].clone();h?i=b.multiply(i,m):(h=m,h.multiplier=h.multiplier.multiply(c.multiplier))}}return[h,i]};return i=h(c),j=i[0],k=i[1],m=f.unwrapSQRT(b.expand(G.diff(j.clone(),d)),!0),n=G.integrate(k.clone(),d,g),q=b.multiply(n.clone(),m),s=b.multiply(j,n),v=q.multiplier.clone(),q.toUnitMultiplier(),u=G.integrate(q.clone(),d,g),u.multiplier=u.multiplier.multiply(v),t=b.subtract(s,u)},decompose_arg:function(a,c){var d,e,f,g;if(a.group===n){var h=b.expand(a.clone()).stripVar(c);d=b.subtract(a.clone(),h.clone()),g=h}else d=a.clone();return e=d.stripVar(c),f=b.divide(d.clone(),e.clone()),[e,f,d,g]}},integrate:function(g,h,k){k=k||0;var F,q=d(h)?h.toString():h,D=f.unwrapSQRT(g.clone(),!0),E=D.group;try{if(++k>a.Settings.integration_depth&&G.integration.stop("Maximum depth reached. Exiting!"),D.contains(q,!0)){if(E===l)F=G.integration.poly_integrate(D,q,k);else if(E===p)if(D.contains(q))D.power.contains(q)?G.integration.stop():F=G.integration.poly_integrate(D,q,k);else{var H=G.diff(D.power.clone(),q);if(H.contains(q)){var I=H.stripVar(q),J=b.divide(H.clone(),I.clone());if(J.group===l&&J.isLinear())return I.multiplier=I.multiplier.divide(new c(2)),b.parse(j("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",I,q,D.multiplier));G.integration.stop()}if(D.isE())F=D;else{var K=b.symfunction(r,[b.parse(D.value)]);F=b.divide(D,K)}F=b.divide(F,H)}else if(D.isComposite()&&D.isLinear())F=new f(0),D.each(function(a){F=b.add(F,G.integrate(a,q,k))});else if(E===n){var L=Number(D.power),M=D.multiplier.clone();D.toUnitMultiplier();var N=D.clone().toLinear(),O=G.integration.decompose_arg(N,q),P=O[3],Q=O[2],H=O[0],J=O[1];if(L===-1)if(J.group===l&&J.power.equals(2)){var R=function(a){var c=new f(1);return a.each(function(a){c=b.multiply(c,"abs"===a.fname?a.args[0]:a)}),c},S=H.clone(),T=P.clone();S=b.pow(S,new f(.5)),T=b.pow(T,new f(.5));var K=b.multiply(R(T),R(S)),U=b.symfunction(C,[b.divide(b.multiply(H,J.toLinear()),K.clone())]);F=b.divide(U,K)}else F=J.group===l&&J.isLinear()?b.divide(G.integration.poly_integrate(D),H):G.integration.partial_fraction(D,q,k);else if(L===-.5)if(J.group===l&&J.power.equals(2))if(Q.multiplier.lessThan(0)&&!P.multiplier.lessThan(0))if(H.negate(),P.isConstant()&&H.isConstant()){var K=b.symfunction(t,[H.clone()]),V=b.symfunction(t,[b.multiply(H.clone(),P)]);F=b.divide(b.symfunction(A,[b.divide(Q.toLinear(),V)]),K)}else{var W=b.symfunction(t,[H]),X=b.multiply(W.clone(),J.clone().toLinear());F=b.divide(b.symfunction(C,[b.divide(X,b.symfunction(t,[N.clone()]))]),W)}else G.integration.stop();else G.integration.stop();else F=J.isLinear()?b.divide(G.integration.poly_integrate(D),H):G.integration.partial_fraction(D,q,k);F.multiplier=F.multiplier.multiply(M)}else if(E===e){var Y=D.args[0],M=D.multiplier.clone();D.toUnitMultiplier();var O=G.integration.decompose_arg(Y,q),H=O[0],J=O[1],Z=D.fname;if(Z===r||Z===A||Z===B||Z===C&&J.isLinear()){var L=D.power.toString();i(L)&&(k-=L),F=G.integration.by_parts(D,q,k)}else{if(!H.contains(q,!0)&&D.isLinear())if(Z===s){var J=b.divide(Y.clone(),H.clone());if(J.group!==l||J.power.lessThan(0))G.integration.stop();else if(a.Utils.even(J.power))F=G.integrate(Y,q,k);else{var $=G.integrate(J,q,k);$.power=$.power.subtract(new c(1)),F=b.multiply(b.multiply(b.symfunction(s,[J.toLinear()]),$),H)}}else{switch(Z){case v:F=b.symfunction(u,[Y]);break;case u:F=b.symfunction(v,[Y]),F.negate();break;case w:F=b.parse(j("log(sec({0}))",Y));break;case x:F=b.parse(j("log(tan({0})+sec({0}))",Y));break;case y:F=b.parse(j("-log(csc({0})+cot({0}))",Y));break;case z:F=b.parse(j("log(sin({0}))",Y));break;case"erf":var Y=D.args[0].clone(),I=Y.stripVar(q);F=b.parse(j("(({0})*{1}+e^(-{2}^2*{3}^2)/sqrt(pi))",Y,F,I,q));break;default:G.integration.stop()}F=b.divide(F,H)}else if(J.isLinear())if(Z===v||Z===u){var L=Number(D.power);if(L<0)D.fname=Z===u?y:x,D.invert().updateHash(),F=G.integrate(D,q,k);else{var Y=D.args[0],_=D.clone(),aa=D.clone(),ba=new f((L-1)/L),ca=b.multiply(H.clone(),new f(L)).invert();_.power=_.power.subtract(new c(1)),aa.power=aa.power.subtract(new c(2));var da=b.symfunction(Z===v?u:v,[Y.clone()]);Z===u&&da.negate(),F=b.add(b.multiply(b.multiply(ca,_),da),b.multiply(ba,G.integrate(b.parse(aa),q,k)))}}else if(Z===w||Z===z){if(D.args[0].isLinear(q)){var ea=D.power.subtract(new c(1)).toString(),fa=D.clone().toUnitMultiplier(),ga=b.parse(j((Z===z?"-":"")+"1/({2}*{0})*{3}({1})^({0})",ea,Y,H,Z));fa.power=fa.power.subtract(new c(2)),fa.power.equals(0)&&(fa=b.parse(fa)),F=b.subtract(ga,G.integrate(fa,q,k))}}else if(Z===x||Z===y){var ha=D.power.subtract(new c(1)).toString(),ia=D.power.subtract(new c(2)).toString(),ja=Z===x?w:z,fa=D.clone().toUnitMultiplier(),ka=j((Z===y?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",H,ha,ia,Y,Z,ja),ga=b.parse(ka);fa.power=fa.power.subtract(new c(2)),fa.power.equals(0)&&(fa=b.parse(fa)),F=b.add(ga,b.multiply(new f(ia/ha),G.integrate(fa,q,k)))}else G.integration.stop();else G.integration.stop();F.multiplier=F.multiplier.multiply(M)}}else if(E===m)F=G.integration.partial_fraction(D,q,k);else if(E===o){var la=D.stripVar(q),ma=b.divide(D.clone(),la.clone());if(ma.group!==o)F=G.integrate(ma,q,k);else{var na=ma.collectSymbols().sort(function(a,b){return a.group===b.group?Number(a.power)===Number(b.power)?a<b?1:-1:b.power-a.power:b.group-a.group}).map(function(a){return f.unwrapSQRT(a,!0)}),oa=na.length;if(2===oa){if(F=G.integration.u_substitution(na,q),!F){var pa=na[0].group,qa=na[1].group,ra=na[0],sa=na[1],ta=ra.fname,ua=sa.fname;if(D=b.multiply(ra.clone(),sa.clone()),pa===e&&qa===e)if(ta===r||ua===r)F=G.integration.by_parts(D.clone(),q,k);else{na.sort(function(a,b){return b.fname>a.fname});var va=ra.args[0];(!va.isLinear()||va.group!==n&&va.group!==o&&va.group!==l)&&G.integration.stop();var O=G.integration.decompose_arg(va,q);J=O[1],H=O[0],J.isLinear()||G.integration.stop();var wa=sa.args[0];if(va.equals(wa))if(ta===u&&ua===v)if(ra.power.lessThan(0)&&G.integration.stop(),ta===u&&ra.power.add(sa.power).equals(0))ra.fname=w,ra.updateHash(),F=G.integrate(ra,q,k);else{var xa=a.Utils.even(ra.power),ya=a.Utils.even(sa.power);if(F=new f(0),xa&&ya){var Ea=function(a){var e,c=a.power,d=c/2;return e=a.fname===v?"((1/2)+(cos(2*("+a.args[0]+"))/2))^"+d:"((1/2)-(cos(2*("+a.args[0]+"))/2))^"+d,b.parse(e)},H=Ea(ra),P=Ea(sa),da=b.multiply(H,P),Da=b.expand(da);return Da.each(function(a){F=b.add(F,G.integrate(a,q,k))}),b.multiply(F,la)}var za,fa,Aa;xa?(za=ra,fa=sa):(za=sa,fa=ra);var Ba=za.fname===v?-1:1,ea=fa.power,Ca=(ea-1)/2,Aa=b.parse("(1-"+za.fname+a.Utils.inBrackets(va)+"^2)^"+Ca),Da=b.expand(b.multiply(new f(Ba),b.multiply(za.clone(),Aa)));Da.each(function(a){F=b.add(F,G.integration.poly_integrate(a.clone()))})}else ta===w&&ua===x&&J.isLinear()?ra.isLinear()&&sa.isLinear()?F=b.divide(b.symfunction(x,[va.clone()]),H):G.integration.stop():ta===x&&ua===v?(ra.fname=v,ra.invert().updateHash(),F=G.integrate(b.multiply(ra,sa),q,k)):ta===u&&ua===y?(sa.fname=u,sa.invert().updateHash(),F=G.integrate(b.multiply(ra,sa),q,k)):G.integration.stop();else G.integration.stop()}else if(pa===e&&qa===l)F=ra.fname===v&&sa.power.equals(-1)?b.symfunction("Ci",[ra.args[0]]):ra.fname===u&&sa.power.equals(-1)?b.symfunction("Si",[ra.args[0]]):G.integration.by_parts(D,q,k);else if(pa===p&&qa===l)F=G.integration.by_parts(D,q,k);else if(pa===m&&qa===l){if(sa.value===ra.value&&ra.power.equals(-1)){var Fa=Math.min.apply(null,a.Utils.keys(ra.symbols)),Ga=Math.min(Fa,sa.power),Ha=sa.clone();Ha.power=new c(Ga),sa=b.divide(sa,Ha.clone());var da=new f(0);ra.each(function(a){da=b.add(da,b.divide(a.clone(),Ha.clone()))}),da.multiplier=ra.multiplier,D=b.divide(sa,da)}F=G.integration.partial_fraction(D,q,k)}else if(pa===n&&qa===l)if(ra.power.equals(-.5)){var O=G.integration.decompose_arg(ra.clone().toLinear(),q),H=O[0].negate(),J=O[1],P=O[3],L=Number(sa.power);if(i(L)&&a.Utils.even(L)&&J.power.equals(2)){var Ia=b.divide(b.multiply(b.pow(P.clone(),new f(2)),b.symfunction(t,[b.divide(P.clone(),H.clone())])),b.pow(H.clone(),new f(2)));Ia=b.multiply(Ia,b.symfunction(t,[P]).invert());var Ja=b.parse("sin(u)");Ja.power=Ja.power.multiply(sa.power);var Ka=G.integrate(Ja,"u",k),La=b.parse(A+"("+t+"("+H+"/"+P+")*"+q+")");F=b.multiply(Ia,Ka.sub(new f("u"),La))}}else if(ra.power.equals(-1)&&sa.isLinear()){var N=ra.clone().toLinear(),O=G.integration.decompose_arg(N.clone(),q),H=O[0],P=O[3],J=O[2];J.isLinear()||G.integration.stop(),F=b.divide(b.subtract(N.clone(),b.multiply(b.symfunction(r,[N]),P)),b.pow(H,new f(2)))}else if(!ra.power.lessThan(0)&&i(ra.power)){var Ma=b.expand(ra);F=new f(0),Ma.each(function(a){F=b.add(F,G.integrate(b.multiply(sa.clone(),a),q,k))})}else F=ra.power.lessThan(-2)?G.integration.by_parts(D,q,k):G.integration.partial_fraction(D,q,k);else if(ra.isComposite()&&sa.isComposite()){F=new f(0);var Na=Number(ra.power),Oa=Number(sa.power);if(Na<0&&Oa>0){var da=ra;ra=sa,sa=da}if(Na>0&&Oa<0){var K=a.Algebra.div(b.expand(ra.clone()),sa.clone().toLinear());K[0].each(function(a){F=b.add(F,G.integrate(a,q,k))}),ra=K[1]}ra.each(function(a){F=b.add(F,G.integrate(b.multiply(a,sa.clone()),q,k))})}else F=G.integration.by_parts(D,q,k)}}else 3===oa&&na[2].group===l&&(F=G.integration.by_parts(D,q,k))}F=b.multiply(F,la)}}else F=b.multiply(D.clone(),b.parse(q));if(F)return F}catch(a){}return b.symfunction("integrate",[g,h])}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return G.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return G.sum}},{name:"integrate",visible:!0,numargs:2,build:function(){return G.integrate}}])}(),function(){var a=nerdamer.getCore(),b=a.PARSER,o=(a.Utils.keys,a.Utils.build,a.Symbol,a.groups.S,a.Utils.round,a.Utils.isInt,a.Math2,a.Utils.variables,a.Utils.isComposite,a.Utils.isSymbol,a.Utils.isNumericSymbol,a.Utils.isVector,a.groups.N),v=(a.groups.EX,a.groups.FN,a.groups.PL,a.groups.CP,a.groups.CB,a.Vector,a.Special={version:"1.0.0",step:function(a){if(a.group===o){var c=a.multiplier.toDecimal();return c>0?1:c<0?0:.5}return b.symfunction("step",[a])},sign:function(a){if(a.group===o){var c=a.multiplier.toDecimal();return c>0?1:c<0?-1:0}return b.symfunction("sign",[a])},rect:function(b){var c=a.Utils.format("step({0}+(0.5)) - step({0}-(0.5))",b);return a.PARSER.parse(c)},sinc:function(a){if(a.group===o){var c=a.multiplier.toDecimal();return 0===c?1:Math.sin(a)/a}return b.symfunction("sinc",[a])},tri:function(b){var c=a.Utils.format("rect(0.5*{0})*(1-abs({0}))",b);return a.PARSER.parse(c)}});nerdamer.register([{name:"step",visible:!0,numargs:1,build:function(){return v.step}},{name:"sign",visible:!0,numargs:1,build:function(){return v.sign}},{name:"rect",visible:!0,numargs:1,build:function(){return v.rect}},{name:"sinc",visible:!0,numargs:1,build:function(){return v.sinc}},{name:"tri",visible:!0,numargs:1,build:function(){return v.tri}}])}(),function(){var a=nerdamer.getCore(),b=a.PARSER,c=a.Algebra,d=a.Calculus,e=a.groups.PL,f=a.Utils.format,g=a.Utils.build,h=a.Utils.isInt,i=a.Utils.sameSign,j=a.Symbol,k=a.Utils.isSymbol,l=a.Utils.variables,m=a.Utils.isArray,n=function(a){var c=a.split("=");void 0===c[1]&&(c[1]="0");var d=b.parse(c[0]),e=b.parse(c[1]);return b.subtract(d,e)},o=function(b){nerdamer.clearVars();for(var d=0;d<b.length;d++)b[d]=n(b[d]);c.allLinear(b)||a.err("System must contain all linear equations!");for(var e=l(b[0]),f=new a.Matrix,g=new a.Matrix,h=b.length,d=1;d<h;d++)e=e.concat(l(b[d]));e=a.Utils.arrayUnique(e).sort();for(var d=0;d<h;d++){for(var i=b[d],k=0;k<h;k++){var m=i.symbols[e[k]];f.set(d,k,m?m.multiplier:0)}var o=i.symbols["#"];g.set(d,0,new j(o?-o.multiplier:0))}f=f.invert();var p=f.multiply(g),q=[];return p.each(function(a,b){q.push([e[b],a.valueOf()])}),q},p=function(a,c,d,e){var f="-"===e?"subtract":"add",g=b.subtract(b.pow(c.clone(),j(2)),b.multiply(b.multiply(d.clone(),a.clone()),j(4))),h=b.pow(g,j(.5));return b.divide(b[f](c.clone().negate(),h),b.multiply(new j(2),d.clone()))},q=function(c,d,e,g){var h=g.text(),i=e.text(),k=d.text(),l=c.text(),m="{1}^2-3*{0}*{2}",n=b.parse(f(m,h,i,k)),o=b.parse(f("sqrt((2*{1}^3-9*{0}*{1}*{2}+27*{0}^2*{3})^2-4*({1}^2-3*{0}*{2})^3)",h,i,k,l)),p=b.parse(f("((1/2)*({4}+2*{1}^3-9*{0}*{1}*{2}+27*{0}^2*{3}))^(1/3)",h,i,k,l,o)),q=a.Utils.block("PARSE2NUMBER",function(){return b.parse(p,{a:new j(1),b:new j(1),c:new j(1),d:new j(1)})});0===Number(n)&&0===Number(q)&&(p=b.parse(f("((1/2)*(-{4}+2*{1}^3-9*{0}*{1}*{2}+27*{0}^2*{3}))^(1/3)",h,i,k,l,o)));for(var r=["-(b/(3*a))+C/(3*a)+((b^2-3*a*c))/(3*a*C)","-(b/(3*a))+(C*(1+i*sqrt(3)))/(6*a)+((1-i*sqrt(3))*(b^2-3*a*c))/6*a*C".replace(/i/g,a.Settings.IMAGINARY),"-(b/(3*a))+(C*(1-i*sqrt(3)))/(6*a)+((1+i*sqrt(3))*(b^2-3*a*c))/(6*a*C)".replace(/i/g,a.Settings.IMAGINARY)],s=0;s<3;s++)r[s]=b.parse(r[s],{a:g.clone(),b:e.clone(),c:d.clone(),d:c.clone(),C:p.clone()});return r},r=function(f,l){if(l=l||"x",m(f))return o.apply(void 0,arguments);var r=[],s=function(a){m(a)?r=r.concat(a):"null"!==a.valueOf()&&(k(a)||(a=b.parse(a)),r.push(a))},t=function(c){var f,e=g(c),h=0;do if(f=e(h),h++,h>100)break;while(!isFinite(f));if(0===f)s(new j(f));else{for(var l,k=g(d.diff(c.clone())),m=0;m<10;m++){var n=k(m);if(!isNaN(l)&&!isNaN(n))break;l=n}var o=1,p=l-n;i(p,f)&&(o=-1);var q=function(d){for(var g,f=0,h=d;h<d+100;h++){var j=e(h)*o,k=Math.abs(0-j);if(k>1&&(j*=k),0===j||!i(j,f)){g=j===d?j:(d+f)/2;break}f=j}void 0!==g&&s(b.parse(a.Algebra.froot(c,g)))};q(f),q(-f)}},u=n(f),v=a.Utils.variables(u),w=v.length;if(1===w)u.isPoly(!0)?v[0]===l&&c.proots(u).map(s):t(u);else if(!u.hasFunc()&&u.isComposite())try{var x=[],y=function(a,c){if(c=Number(c),!h(c))throw new Error("Stopping");var d=b.parse(l+"^"+c);x[c]=b.divide(a,d)};for(var z in u.symbols){
var A=u.symbols[z];if(A.group===e&&A.value===l)A.each(function(a,b){y(a,b)});else{var B;if(A.symbols){var B=A.symbols[l];y(A,B?B.power:0)}else y(A,A.value===l?A.power:0)}}for(var D=x.length,E=D-1,F=0;F<D;F++)void 0===x[F]&&(x[F]=new j(0));switch(E){case 1:s(b.divide(x[0],x[1].negate()));break;case 2:s(p.apply(void 0,x)),x.push("-"),s(p.apply(void 0,x));break;case 3:s(q.apply(void 0,x))}}catch(a){}return r};nerdamer.register({name:"solveEquations",parent:"nerdamer",visible:!0,build:function(){return r}})}();