var nerdamer=function(z){function f(b,e,d){var p="hash"===e,k="decimals"===e,q=p?void 0:e;if(E(b)){var l="",t=e="";d=b.group||d;var U=b.value;if(!p){var X=k?b.multiplier.valueOf():b.multiplier.toString();"-1"==X&&(t="-",X="1");"1"!=X&&(l=X);X=b.power?k?b.power.valueOf():b.power.toString():"";"1"!=X&&(e=E(X)?f(X,q):X)}switch(d){case n:l="";U="-1"==b.multiplier?"1":k?b.valueOf():b.multiplier.toString();e="";break;case c:U=b.collectSymbols(f,q).join("+").replace(/\+\-/g,"-");break;case h:U=b.collectSymbols(f,
q).join("+").replace(/\+\-/g,"-");break;case r:U=b.collectSymbols(function(b){var e=b.group;return(e===c||e===h)&&b.power.equals(1)&&b.multiplier.equals(1)?F(f(b,q)):f(b,q)}).join("*");break;case a:var X=b.previousGroup,m=b.power.group;X===c&&(U=b.collectSymbols(f,q).join("+").replace("+-","-"));X===n||X===w||X===g||p||(U=F(U));m!==h&&m!==r&&m!==c&&"1"==b.power.multiplier.toString()||!e||(e=F(e))}d===g&&k&&(U=b.fname+F(b.args.map(function(b){return f(b,q)}).join(",")));!e||O(e)||d===a||k||(e=F(e));
if((d===h||d===c)&&(l&&"1"!=l||"-"===t)||(d===r||d===h||d===c)&&e&&"1"!=e||!p&&d===D&&-1==U||b.fname===G)U=F(U);p=t+l;!l||O(l)||k||(p=F(p));0>e&&(e=F(e));l&&(p+="*");e&&(e="^"+e);d===a&&"-"===U.charAt(0)&&(U=F(U));k=p+U;b.parens&&(k=F(k));return k+e}if(S(b)){k=b.elements.length;p=[];for(e=0;e<k;e++)p.push(b.elements[e].text());return"["+p.join(",")+"]"}try{return b.toString()}catch(Xb){return""}}function v(b){this.name=b}function A(b){this.symbol=b}function u(b){if(b instanceof u)return b;if(void 0===
b)return this;O(b)?(this.num=W(b),this.den=W(1)):(b=T.convert(b),this.num=new W(b[0]),this.den=new W(b[1]))}function m(b){if(!(this instanceof m))return new m(b);isNaN(b)?(this.group=w,ga(b),this.value=b,this.multiplier=new u(1),this.imaginary=b===I.IMAGINARY):(this.group=n,this.value=l,this.multiplier=new u(b));this.power=new u(1);return this}function Y(b){if(Aa(b))return[b];for(var e=b,d=1,a=[];d<e;){var c=b/d,g=Math.floor(c);2.220446049250313E-16>=c-g&&1<d&&(-1!==da.indexOf(d)&&a.push(d),e=g);
d++}return a.sort(function(b,d){return b-d})}function ba(b,d,a,c,g,k){this.val=b;this.fn=d;this.precedence=a;this.left_assoc=c;this.is_prefix=g;this.is_postfix=k||!1}function ia(b){this.val=b}function L(){function b(b){return I.PARSE2NUMBER?b:C.symfunction("parens",[b])}function e(b){b.multiplier.lessThan(0)&&b.multiplier.negate();if(q(b)||pa(b.power))return b;if(b.isComposite()){var d=[];b.each(function(b){d.push(b.multiplier)});oa.QGCD.apply(null,d).lessThan(0)&&(b.multiplier=b.multiplier.multiply(new u(-1)),
b.distributeMultiplier())}return C.symfunction(y,[b])}function p(b){return I.PARSE2NUMBER&&b.isConstant()?O(b)?oa.fact(b):oa.gamma(b.multiplier.toDecimal()+1):C.symfunction(Ba,[b])}function V(b){if(I.PARSE2NUMBER&&b.isConstant()&&!b.multiplier.lessThan(0))return new m(Math.sqrt(b.multiplier.toDecimal()));var d,e=b.isConstant();if(b.group===r&&b.isLinear()){var e=V(m(b.multiplier)),a;for(a in b.symbols)var p=b.symbols[a],e=C.multiply(e,V(p));b=e}else if(b.fname===t)a=b.args[0],a.setPower(b.power.multiply(new u(.25))),
b=a;else if(b.power.isInteger()){e&&b.multiplier.lessThan(0)&&(d=m.imaginary(),b.multiplier=b.multiplier.abs());e=b.multiplier.toDecimal();a=Math.sqrt(Math.abs(e));if(O(a))e=new m(a);else if(O(e)){var c=oa.ifactor(e),g=1;for(p in c)if(a=c[p],a-=a%2)var Ha=Math.pow(p,a),g=g*Math.pow(p,a/2),e=e/Ha;e=C.multiply(C.symfunction(t,[new m(e)]),new m(g))}else a=b.multiplier.num.toString(),p=b.multiplier.den.toString(),e=Math.sqrt(a),c=Math.sqrt(p),e=C.multiply("1"===a?new m(1):O(e)?new m(e):C.symfunction(t,
[new m(a)]),"1"===p?new m(1):O(c)?(new m(c)).invert():C.symfunction(t,[new m(p)]).invert());b=b.toUnitMultiplier(!0);b=b.isOne()?b:pa(b.power.toString())?C.pow(b.clone(),new m(.5)):C.symfunction(t,[b]);e&&(b=C.multiply(e,b));d&&(b=C.multiply(d,b))}else b.setPower(b.power.multiply(new u(.5)));return b}function l(b){var e=new m(1);if(b.isConstant()){var d=b.multiplier.toDecimal();if(O(d)){b=oa.ifactor(d);for(var a in b)d=b[a],e=C.multiply(e,C.symfunction("parens",[(new m(a)).setPower(d)]))}else e=l(new m(b.multiplier.num)),
a=l(new m(b.multiplier.den)),e=C.multiply(C.symfunction("parens",[e]),C.symfunction("parens",[a]).invert())}return e}function X(b){b.equals(0)&&M("log(0) is undefined!");if(b.group===a&&b.power.multiplier.lessThan(0)||-1==b.power)b.power.negate(),b=X(b).negate();else if("e"===b.value&&b.multiplier.equals(1)){var e=b.power;b=E(e)?e:new m(e)}else if(b.group===g&&"exp"===b.fname)e=b.args[0],b=b.multiplier.equals(1)?C.multiply(e,new m(b.power)):C.symfunction("log",[b]);else if(I.PARSE2NUMBER&&q(b)){var d;
b.multiplier.lessThan(0)&&(b.negate(),d=C.multiply(new m(Math.PI),new m("i")));b=new m(Math.log(b.multiplier.toDecimal()));d&&(b=C.add(b,d))}else b.power.equals(1)||(e=b.group===a?b.power:new m(b.power),b.toLinear()),b=C.symfunction("log",[b]),e&&(b=C.multiply(e,b));return b}function F(b){b%=2;0>b&&(b=2+b);return 0<=b&&.5>=b?1:.5<b&&1>=b?2:1<b&&1.5>=b?3:4}function z(b){if(!b.symbols)return b;var e=b.clone();try{var d=b.power,p=b.multiplier,g=Number(d);if(!b.symbols)return b;for(var k in b.symbols){var h=
b.symbols[k];b.symbols[k]=z(h)}b=C.parse(b);if(O(d)&&0<g&&b.isComposite()){b=b.toLinear().toUnitMultiplier();for(var f=b.clone(),Ha=0;Ha<g-1;Ha++){var V=new m(0);for(k in b.symbols){var h=b.symbols[k],q;for(q in f.symbols){var l=f.symbols[q],K=C.expand(C.multiply(h.clone(),l.clone())),X=Number(K.power);if(K.group===r&&1!==X||K.group===c&&1!==X)K=z(K);V=C.add(V,K)}}f=V}if(!p.equals(1))for(k in f.symbols)h=f.symbols[k],h.multiplier=h.multiplier.multiply(p),h.isComposite()&&h.distributeMultiplier(),
b.symbols[k]=h;return f}if(b.group===r){var p=!1,U=b.power;for(h in b.symbols){var t=b.symbols[h];if(t.isComposite()){p=!0;break}E(t.power)||E(U)?(t.power=C.multiply(t.power,m(U)),t.group=a):t.power=t.power.multiply(U)}b.toLinear();b=C.parse(b.text());if(!p)return b;var f=new m(0),U=[],F=new m(b.multiplier);for(k in b.symbols)h=b.symbols[k],h.isComposite()?(d=h.power,t=!1,O(d)&&0>d&&(h.power.negate(),t=!0),t?(h.power.negate(),F=C.multiply(F,h)):U.push(h)):F=C.multiply(F,h);for(var y=U.length,f=U[0],
Ha=1;Ha<y;Ha++){V=new m(0);k=U[Ha];for(var n in f.symbols)for(q in h=f.symbols[n],k.symbols)var l=k.symbols[q],G=C.multiply(h.clone(),l.clone()),V=C.add(V,G);f=V}var w=new m(0);for(k in f.symbols)h=f.symbols[k],w=C.add(w,z(C.multiply(F,h)));b=w}}catch(Ia){return e}return b}function A(){return new Z([].slice.call(arguments))}function J(){return H.fromArray(arguments)}function x(b,e){if(S(b)&&S(e))return b.dot(e);M("function dot expects 2 vectors")}function ca(b){if(d(b))return b.transpose();M("function transpose expects a matrix")}
function B(b){if(d(b))return b.invert();M("invert expects a matrix")}function fa(b){if(!E(b.power)&&b.power.absEquals(.5)){var e=b.power.sign();return V(b.toLinear()).setPower(new u(e))}return b}function ra(b){if(b.group===D){var e=b.group===n?b.multiplier.toDecimal():b.value,d=Y(e)[0],e=(new u(Math.log(e)/Math.log(d))).multiply(b.power);if(e.den>b.power.den)return b;b=O(e)?m(Math.pow(d,e)):(new m(d)).setPower(e)}return b}var C=this,aa={},T=this.constants={PI:Math.PI,E:Math.E},P=this.operators={"!":new ba("!",
"factorial",5,!1,!1,!0),"^":new ba("^","pow",4,!1,!1),"*":new ba("*","multiply",3,!0,!1),"/":new ba("/","divide",3,!0,!1),"+":new ba("+","add",2,!0,!0),"-":new ba("-","subtract",2,!0,!0),",":new ba(",","comma",1,!0,!1)},Q=this.functions={cos:[function(b){if(I.PARSE2NUMBER&&b.isConstant())return new m(Math.cos(b.valueOf()));var e,d=!1,a=F(b.multiplier.toDecimal()),p=b.multiplier.abs();b.multiplier=p;b.isPi()&&b.isLinear()&&(O(p)?e=new m(pa(p)?1:-1):(e=p.den,2==e?e=new m(0):3==e?(e=C.parse("1/2"),d=
!0):4==e?(e=C.parse("1/sqrt(2)"),d=!0):6==e?(e=C.parse("sqrt(3)/2"),d=!0):e=C.symfunction("cos",[b])));!d||2!==a&&3!==a||e.negate();e||(e=C.symfunction("cos",[b]));return e},1],sin:[function(b){if(I.PARSE2NUMBER&&b.isConstant())return new m(Math.sin(b.valueOf()));var e,d=!1,a=F(b.multiplier.toDecimal()),p=b.multiplier.sign(),c=b.multiplier.abs();b.multiplier=c;b.isPi()&&b.isLinear()&&(O(c)?e=new m(0):(e=c.den,2==e?(e=new m(1),d=!0):3==e?(e=C.parse("sqrt(3)/2"),d=!0):4==e?(e=C.parse("1/sqrt(2)"),d=
!0):6==e?(e=C.parse("1/2"),d=!0):e=C.symfunction("sin",[b])));e||(e=C.multiply(new m(p),C.symfunction("sin",[b])));!d||3!==a&&4!==a||e.negate();return e},1],tan:[function(b){if(I.PARSE2NUMBER&&b.isConstant())return new m(Math.tan(b.valueOf()));var e,d=!1,a=F(b.multiplier.toDecimal()),p=b.multiplier;b.multiplier=p;b.isPi()&&b.isLinear()&&(O(p)?e=new m(0):(p=p.den,2==p?M("tan is undefined for "+b.toString()):3==p?(e=C.parse("sqrt(3)"),d=!0):4==p?(e=new m(1),d=!0):6==p?(e=C.parse("1/sqrt(3)"),d=!0):
e=C.symfunction("tan",[b])));e||(e=C.symfunction("tan",[b]));!d||2!==a&&4!==a||e.negate();return e},1],sec:[function(b){if(I.PARSE2NUMBER&&b.isConstant())return new m(oa.sec(b.valueOf()));var e,d=!1,a=F(b.multiplier.toDecimal()),p=b.multiplier.abs();b.multiplier=p;b.isPi()&&b.isLinear()&&(O(p)?e=new m(pa(p)?1:-1):(p=p.den,2==p?M("sec is undefined for "+b.toString()):3==p?(e=new m(2),d=!0):4==p?(e=C.parse("sqrt(2)"),d=!0):6==p?(e=C.parse("2/sqrt(3)"),d=!0):e=C.symfunction("sec",[b])));!d||2!==a&&3!==
a||e.negate();e||(e=C.symfunction("sec",[b]));return e},1],csc:[function(b){if(I.PARSE2NUMBER&&b.isConstant())return new m(oa.csc(b.valueOf()));var e,d=!1,a=F(b.multiplier.toDecimal()),p=b.multiplier.abs();b.multiplier=p;b.isPi()&&b.isLinear()&&(O(p)?M("csc is undefined for "+b.toString()):(e=p.den,2==e?(e=new m(1),d=!0):3==e?(e=C.parse("2/sqrt(3)"),d=!0):4==e?(e=C.parse("sqrt(2)"),d=!0):6==e?(e=new m(2),d=!0):e=C.symfunction("csc",[b])));e||(e=C.symfunction("csc",[b]));!d||3!==a&&4!==a||e.negate();
return e},1],cot:[function(b){if(I.PARSE2NUMBER&&b.isConstant())return new m(oa.cot(b.valueOf()));var e,d=!1,a=F(b.multiplier.toDecimal()),p=b.multiplier;b.multiplier=p;b.isPi()&&b.isLinear()&&(O(p)?M("cot is undefined for "+b.toString()):(e=p.den,2==e?e=new m(0):3==e?(e=C.parse("1/sqrt(3)"),d=!0):4==e?(e=new m(1),d=!0):6==e?(e=C.parse("sqrt(3)"),d=!0):e=C.symfunction("cot",[b])));e||(e=C.symfunction("cot",[b]));!d||2!==a&&4!==a||e.negate();return e},1],acos:[,1],asin:[,1],atan:[,1],sinh:[,1],cosh:[,
1],tanh:[,1],asinh:[,1],acosh:[,1],atanh:[,1],log10:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceil:[,1],Si:[,1],Ci:[,1],fib:[,1],fact:[p,1],factorial:[p,1],round:[,1],mod:[function(b,e){if(b.isConstant()&&e.isConstant()){var d=new m(1);d.multiplier=d.multiplier.multiply(b.multiplier.mod(e.multiplier));return d}return C.symfunction("mod",[b,e])},2],pfactor:[l,1],vector:[A,-1],matrix:[J,-1],parens:[b,-1],sqrt:[V,1],log:[X,1],expand:[z,1],abs:[e,1],invert:[B,1],transpose:[ca,1],dot:[x,2],
cross:[function(b,e){if(S(b)&&S(e))return b.cross(e);M("function cross expects 2 vectors")},2],vecget:[function(b,e){return b.elements[e]},2],vecset:[function(b,e,d){b.elements[e]=d;return b},3],matget:[function(b,e,d){return b.elements[e][d]},3],matset:[function(b,e,d,a){b.elements[e][d]=a;return b},4],imatrix:[function(b){return H.identity(b)},1]},la={},ga=[];la["("]="(";la[")"]=")";la["["]="[";la["]"]="]";this.error=M;this.override=function(b,e){aa[b]||(aa[b]=[]);aa[b].push(this[b]);this[b]=e};
this.restore=function(b){this[b]&&(this[b]=aa[b].pop())};this.extend=function(b,e,d){var a=this;if("function"===typeof this[b]&&"function"===typeof e){var p=this[b];this[b]=function(b,c){return E(b)&&E(c)&&!d?p.call(a,b,c):e.call(a,b,c,p)}}};this.symfunction=function(b,e){var d=new m(b);d.group=g;"object"===typeof e&&(e=[].slice.call(e));d.args=e;d.fname=b===G?"":b;d.updateHash();return d};this.callfunction=function(b,e){var d=Q[b];if(!d)throw Error(b+" is not a supported function.");var a=d[1],p=
d[0],c;e instanceof Array||(e=void 0!==e?[e]:[]);if(-1!==a){var g=k(a),h=g?a[0]:a,a=g?a[1]:a,g=e.length,f=b+" requires a {0} of {1} arguments. {2} provided!";g<h&&M(Ca(f,"minimum",h,g));g>a&&M(Ca(f,"maximum",a,g))}if(p)c=p.apply(d[2]||this,e);else if(I.PARSE2NUMBER)try{e=e.map(function(b){if(b.group===n)return b.multiplier.toDecimal();M("Symbol must be of group N.")}),c=new m((b in Math?Math[b]:oa[b]).apply(void 0,e))}catch(ub){c=this.symfunction(b,e)}else c=this.symfunction(b,e);return c};this.parse=
function(b,e){b=String(b).split(" ").join("").replace(/\d*\.*\d+e[\+\-]*\d+/gi,function(b,e,d){if(/[a-z_]/.test(d.charAt(e-1)))return b;ga.push(b);return"&"}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(b,e,d,a,p){b="";var c="*";p.charAt(a).match(/[\+\-\/\*]/)||(b=p.charAt(a-1));b.match(/[a-z]/i)&&(c="");return e+c+d}).replace(/\)\(/g,")*(")||"0";var d=e||{},a=[],p=[],c=b.length,g=0,h,k,f=!1,V=!1,q=0,r=function(b){b||(b=a.pop());var e=p.pop(),d=p.pop();if(b||d||!e)if("("===b)f&&M("Unmatched open parenthesis!"),
a.push(b),l(d),l(e);else{var c=b.fn;if(c)b=C[c].call(C,d,e);else{for(b=b.resolve(e);d&&a[a.length-1]instanceof ia;)b=a.pop().resolve(b);d&&l(d)}l(b)}else l(e)},l=function(e){/&/.test(e)&&(e=ga.shift());if(""!==e&&void 0!==e){if(!(e instanceof Array||e instanceof m||U(e))){var c=d[e]||R[e];e=c?c.clone():new m(e)}for(;a[a.length-1]instanceof ia&&(!V||!(c=P[b.charAt(q+1)])||c.left_assoc)&&(!t||t.left_assoc);)e=a.pop().resolve(e);p.push(e);V=!1}};if(!d["~"])for(var K in T)d[K]=new m(T[K]);for(q=0;q<c;q++){K=
b.charAt(q);var t=K in P?P[K]:void 0,X=K in la?la[K]:void 0;if(t||X){var O=b.substring(g,q),F="["===X,ya=b.charAt(q+1);ya in P&&P[ya]&&(ya=K+ya,ya=ya in P?P[ya]:void 0)&&(t=ya,q++);if("("===X&&O||F)F&&O&&l(O),a.push(new v(F?N:O),"("),g=q+1,h=q;else{l(O);if(!X&&(1===q-h||0===q)){if(t.is_prefix){a.push(new ia(t.val));g=q+1;h=q;continue}M(t.val+" is not a valid prefix operator!:"+g)}")"!==K&&(h=q);if(t&&!t.left_assoc&&t.is_postfix&&(p.push(C[t.fn](p.pop())),t=P[b.charAt(++q)],!t)){if(q===c)break;q--}if(t){if(k&&
(t.left_assoc&&t.precedence<=k.precedence||!t.left_assoc&&t.precedence<k.precedence)){K=!1;do{r();K=a[a.length-1];if("("===K)break;K=K?K.left_assoc&&K.precedence<t.precedence:!0}while(!K)}a.push(t)}else if("("===K)a.push(X);else if(")"===K||"]"===K){h=null;for(g=!1;!g;)k=a.pop(),void 0===k&&M("Unmatched close bracket or parenthesis!"),"("===k?g=!0:r(k),"("===k&&"]"===K&&((k=a[a.length-1])&&k.name===N||M("Unmatched parenthesis!"));g=a[a.length-1];g instanceof v&&(g.name===N&&"]"!==K&&")"!==K&&M("Unmatched bracket!"),
K=C.callfunction(a.pop().name,p.pop()),V=!0,l(K))}k=a[a.length-1];g=q+1}}else q===c-1&&l(b.substring(g,q+1))}for(f=!0;0<a.length;)r();return p[0]};this.expand=z;this.ext={log:X,sqrt:V,abs:e,vector:A,matrix:J,parens:b,determinant:function(b){return d(b)?b.determinant():b},dot:x,invert:B,transpose:ca};this.mapped_function=function(){for(var b={},e=this.params,d=0;d<e.length;d++)b[e[d]]=arguments[d];return C.parse(this.body,b)};this.add=function(b,e){var p=E(b),k=E(e);if(p&&k){if(b.multiplier.equals(0))return e;
if(e.multiplier.equals(0))return b;if(b.isConstant()&&e.isConstant()&&I.PARSE2NUMBER)return new m(b.multiplier.add(e.multiplier).valueOf());var p=b.group,k=e.group,q=b.power.toString(),K=e.power.toString();if(p<k||p===k&&q>K&&0<K)return this.add(e,b);p===r&&k===c&&b.value===e.value&&(q=b,b=e,e=q,p=b.group,k=e.group,q=b.power.toString(),K=e.power.toString());var K=q===K,q=b.value,l=e.value,X=b.isComposite(),U=e.isComposite(),O,F;X&&(O=f(b,"hash"));U&&(F=f(e,"hash"));if(p===h&&k===h&&e.isLinear()&&
!b.isLinear())return this.add(b,e);p===c&&k===c&&(q=O,l=F);var U=p===D&&k===n,y=b.value===e.multiplier.toString();if((l=q===l||O===F&&!1||U&&y)&&K&&p===k)if(U&&(e=e.convert(D)),p!==c||k!==w&&k!==D)if(F=b,b.multiplier.isOne()&&e.multiplier.isOne()&&p===h)for(var G in e.symbols)O=e.symbols[G],F.attach(O);else F.multiplier=F.multiplier.add(e.multiplier);else b.distributeMultiplier(),F=b.attach(e);else if(l&&p!==c)F=m.shell(c).attach([b,e]),F.value=p===c?O:q;else if(X&&b.isLinear())if(O=p===k,(k=p===
c&&k===c)&&(O=b.value===e.value),b.distributeMultiplier(),e.isComposite()&&e.isLinear()&&O){e.distributeMultiplier();for(G in e.symbols)O=e.symbols[G],b.attach(O);F=b}else k&&b.value!==F||p===c&&!l?(F=m.shell(h).attach([b,e]),F.updateHash()):F=b.attach(e);else p===g&&b.fname===t&&k!==a&&e.power.equals(.5)&&(G=e.multiplier.clone(),e=V(e.toUnitMultiplier().toLinear()),e.multiplier=G),F=m.shell(h).attach([b,e]),F.updateHash();F.multiplier.equals(0)&&(F=new m(0));1===F.length&&(G=F.multiplier,F=Pa(F.symbols),
F.multiplier=F.multiplier.multiply(G));return F}k&&!p&&(q=b,b=e,e=q,q=k,k=p,p=q);G=d(e);if(p&&G)e.eachElement(function(e){return C.add(b.clone(),e)});else if(d(b)&&G)e=b.add(e);else if(p&&S(e))e.each(function(d,a){a--;e.elements[a]=C.add(b.clone(),e.elements[a])});else if(S(b)&&S(e))e.each(function(d,a){a--;e.elements[a]=C.add(b.elements[a],e.elements[a])});else{if(S(b)&&d(e))return C.add(e,b);if(d(b)&&S(e)){if(e.elements.length===b.rows()){var ya=new H,u=b.cols();e.each(function(e,d){for(var a=[],
p=0;p<u;p++)a.push(C.add(b.elements[d-1][p].clone(),e.clone()));ya.elements.push(a)});return ya}M("Dimensions must match!")}}return e};this.subtract=function(b,e){var a=a=E(b),p=E(e);if(a&&p)return this.add(b,e.negate());p&&(a=e,e=b,b=a,a=p);if(a&&S(e))e=e.map(function(e){return C.subtract(e,b.clone())});else if(S(b)&&S(e))b.dimensions()===e.dimensions()?e=b.subtract(e):C.error("Unable to subtract vectors. Dimensions do not match.");else if(d(b)&&S(e)){if(e.elements.length===b.rows()){var c=new H,
g=b.cols();e.each(function(e,d){for(var a=[],p=0;p<g;p++)a.push(C.subtract(b.elements[d-1][p].clone(),e.clone()));c.elements.push(a)});return c}M("Dimensions must match!")}else{if(S(b)&&d(e))return c=e.clone().negate(),C.add(c,b);d(b)&&d(e)&&(e=b.subtract(e))}return e};this.multiply=function(b,e){var p=E(b),k=E(e);if(p&&k){if(b.isConstant()&&e.isConstant()&&I.PARSE2NUMBER)return new m(b.multiplier.multiply(e.multiplier).valueOf());if(b.isOne())return e.clone();if(e.isOne())return b.clone();if(b.multiplier.equals(0)||
e.multiplier.equals(0))return new m(0);if(e.group>b.group&&e.group!==h)return this.multiply(e,b);if(b.group===r&&e.group===c&&b.value===e.value){var q=b;b=e;e=q}var V=b.group,K=e.group,q=e.multiplier.num,l=e.multiplier.den;V!==g||b.fname!==t||e.isConstant()||b.args[0].value!==e.value||(p=b.power,b=b.args[0].clone(),b.setPower((new u(.5)).multiply(p)),V=b.group);var F=b.value,U=e.value,X=new u(b.multiplier.lessThan(0)?-1:1),y=V===D&&K===n&&e.multiplier.equals(b.value),p=y?(new u(1)).multiply(b.multiplier).abs():
b.multiplier.multiply(e.multiplier).abs(),k=b.clone().toUnitMultiplier();e=e.clone().toUnitMultiplier(!0);F===U&&V===c&&V===K&&(F=b.text("hash"),U=e.text("hash"));K===a&&e.previousGroup===c&&V===c&&(F=f(b,"hash",a));if(F!==U&&!y||V===c&&(K===w||K===D||K===g)||V===c&&K===r)if(V===r&&b.isLinear())if(K===r&&e.distributeExponent(),K===r&&e.isLinear()){for(var G in e.symbols)k=k.combine(e.symbols[G]);k.multiplier=k.multiplier.multiply(e.multiplier)}else k.combine(e);else V!==n?V===r?(k.distributeExponent(),
k.combine(e)):e.isOne()||(k=m.shell(r).combine([k,e])):k=e.clone().toUnitMultiplier();else G=b.power,K=e.power,F=E(G),U=E(K),F=F||U,k.power=F?C.add(E(G)?G:new m(G),E(K)?K:new m(K)):V===n?G:G.add(K),k.power.equals(0)&&(k=k.convert(n)),F&&k.convert(a),b.imaginary&&e.imaginary&&pa(k.power%2)&&(k=new m(1),p.negate()),k.group!==a&&k.previousGroup&&(k.previousGroup=void 0),k.multiplier=k.multiplier.multiply(e.multiplier);k.group===D&&(G=Math.log(k.value),V=Math.log(q)/G,G=Math.log(l)/G,K=p.num/q,F=p.den/
l,0!==V&&O(V)&&O(K)&&(k.power=k.power.add(new u(V)),p.num/=q),0!==G&&O(G)&&O(F)&&(k.power=k.power.subtract(new u(G)),p.den/=l));1===k.length&&(q=k.multiplier,k=Pa(k.symbols),k.multiplier=k.multiplier.multiply(q));pa(k.power.toString())&&k.fname===t?(q=k.power,k=k.args[0],k=C.multiply(new m(p),C.pow(k,new m(q.divide(new u(2)))))):k.multiplier=k.multiplier.multiply(p).multiply(X);k.group===D&&O(k.power.toDecimal())&&(k=k.convert(n));return k}k&&!p&&(q=b,b=e,e=q,q=k,k=p,p=q);k=d(e);q=d(b);if(p&&k)e.eachElement(function(e){return C.multiply(b.clone(),
e)});else if(q&&k)e=b.multiply(e);else if(p&&S(e))e.each(function(d,a){a--;e.elements[a]=C.multiply(b.clone(),e.elements[a])});else if(S(b)&&S(e))e.each(function(d,a){a--;e.elements[a]=C.multiply(b.elements[a],e.elements[a])});else{if(S(b)&&d(e))return this.multiply(e,b);if(d(b)&&S(e)){if(e.elements.length===b.rows()){var Ca=new H,v=b.cols();e.each(function(e,d){for(var a=[],p=0;p<v;p++)a.push(C.multiply(b.elements[d-1][p].clone(),e.clone()));Ca.elements.push(a)});return Ca}M("Dimensions must match!")}}return e};
this.divide=function(b,e){var a=E(b),p=E(e);if(a&&p)return b.isConstant()&&e.isConstant()?(e.equals(0)&&M("Division by zero not allowed!"),p=b.clone(),p.multiplier=p.multiplier.divide(e.multiplier)):(e.invert(),p=C.multiply(b,e)),p;var c=S(b),k=S(e);a&&k?e=e.map(function(e){return C.divide(b.clone(),e)}):c&&p?e=b.map(function(b){return C.divide(b,e.clone())}):c&&k?b.dimensions()===e.dimensions()?e=e.map(function(e,d){return C.divide(b.elements[--d],e)}):C.error("Cannot divide vectors. Dimensions do not match!"):
(a=d(b),c=d(e),a&&p?(b.eachElement(function(b){return C.divide(b,e.clone())}),e=b):a&&c?b.rows()===e.rows()&&b.cols()===e.cols()?b.eachElement(function(b,d,a){return C.divide(b,e.elements[d][a])}):C.error("Dimensions do not match!"):a&&k&&(b.cols()===e.dimensions()?(b.eachElement(function(b,d,a){return C.divide(b,e.elements[d].clone())}),e=b):C.error("Unable to divide matrix by vector.")));return e};this.pow=function(b,e){var p=E(b),c=E(e);if(p&&c){b.equals(0)&&e.equals(0)&&M("0^0 is undefined!");
var c=e.isConstant(),k=b.isConstant(),h=e.isInteger(),f=b.multiplier,p=b.clone();p.toUnitMultiplier();if(p.group!==g||p.fname!==t||c)p.multiplyPower(e);else{var q=p.args[0];q.multiplyPower(new m(.5));q.multiplier.multiply(p.multiplier);q.multiplyPower(e);p=q}if(k&&c&&I.PARSE2NUMBER)p=b.multiplier.toDecimal(),c=e.multiplier.toDecimal(),k=new m(1),e.multiplier.den.isOdd()&&(f=Math.abs(p),k=new m(p/f),p=f),pa(c)&&(k=new m(1)),p=C.multiply(new m(Math.pow(p,c)),k);else if(h&&!f.equals(1))c=e.multiplier.toDecimal(),
c=new u(Math.pow(f.num,c)/Math.pow(f.den,c)),p.multiplier=p.multiplier.multiply(c);else{k=Math.sign(f.num);h=b.group===n&&0>k;q=fa((new m(h?f.num:Math.abs(f.num))).setPower(e.clone()));f=fa((new m(f.den)).setPower(e.clone()).invert());if(b.imaginary)var p=e.multiplier.multiply(u.quick(1,2)),V=Math.pow(-1,p.num),p=pa(p.den)?(new m(-1)).setPower(p,!0):new m(V);0>k&&!h&&p.negate();p=C.multiply(p,ra(C.multiply(q,f)));c&&b.group!==a&&(c=pa(e.multiplier.den),k=pa(b.power),f=p.power.toDecimal(),h=pa(f),
c&&k&&!h&&(1===f?p=C.symfunction(y,[p]):O(f)?p=C.multiply(C.symfunction(y,[p.clone().toLinear()]),p.clone().setPower(new u(f-1))):(c=p.power,p=C.symfunction(y,[p.toLinear()]).setPower(c))))}p=fa(p);p.fname===t?(c=p.group===a,pa(c?p.power.multiplier.toString():p.power.toString())&&(c=c?C.divide(p.power,new m(2)):new m(p.power.divide(new u(2))),f=p.multiplier,p=C.pow(p.args[0],c),p.multiplier=p.multiplier.multiply(f))):p.isE()&&p.group===a&&p.power.contains("pi")&&p.power.contains(I.IMAGINARY)&&(c=
p.multiplier,p=new m(pa(p.power.multiplier)?c:c.negate()));return p}S(b)&&c?b=b.map(function(b){return C.pow(b,e.clone())}):d(b)&&c&&b.eachElement(function(b){return C.pow(b,e.clone())});return b};this.comma=function(b,e){b instanceof Array?b.push(e):b=[b,e];return b};this.factorial=function(b){return this.symfunction(Ba,[b])}}function Z(b){S(b)?this.elements=b.items.slice(0):k(b)?this.elements=b.slice(0):this.elements=[].slice.call(arguments)}function H(){var b=arguments,e=b.length,p,a=[];if(d(b))for(p=
0;p<e;p++)a.push(b[p].slice(0));else{var c,g,h;for(p=0;p<e;p++)c=b[p],S(c)&&(c=c.elements),k(c)||(c=[c]),h=c.length,g&&g!==h&&M("Unable to create Matrix. Row dimensions do not match!"),a.push(c),g=h}this.elements=a}var x=new L,W=z.bigInt;z={};var da=[],B={},I={init_primes:1E3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:"i"},n=z.N=1,D=z.P=2,w=z.S=3,a=z.EX=4,g=z.FN=5,c=z.PL=6,r=z.CB=7,h=z.CP=8,l=I.CONST_HASH="#",G=I.PARENTHESIS="parens",N=I.VECTOR="vector",t=I.SQRT="sqrt",y=I.ABS=
"abs",Ba=I.FACTORIAL="fact",ca=[],R={},J=[],la=B.isReserved=function(b){return-1!==J.indexOf(b)},M=function(b){if(!I.suppress_errors)throw Error(b);},ga=B.validateName=function(b,e){e=e||"variable";if(!/^[a-z_][a-z\d\_]*$/gi.test(b))throw Error(b+" is not a valid "+e+" name");};B.intersection=function(b,e,p){var d=[];if(b.length>e.length){var a=b;b=e;e=a}e=e.slice();for(var a=b.length,c=e.length,k=0;k<a;k++)for(var g=b[k],h=0;h<c;h++){var f=e[h];void 0!==f&&(p?p(g,f):g===f)&&(e[h]=void 0,d.push(g))}return d};
var Aa=B.isPrime=function(b){for(var e=Math.floor(Math.sqrt(b)),p=2;p<=e;p++)if(0===b%p)return!1;return!0},ea=B.isFraction=function(b){return E(b)?ea(b.multiplier.toDecimal()):0!==b%1},E=B.isSymbol=function(b){return b instanceof m},S=B.isVector=function(b){return b instanceof Z},d=B.isMatrix=function(b){return b instanceof H},q=B.isNumericSymbol=function(b){return b.group===n},k=B.isArray=function(b){return b instanceof Array},O=B.isInt=function(b){return 0===b%1},X=B.isNegative=function(b){E(b)&&
(b=b.multiplier);return b.lessThan(0)},F=B.inBrackets=function(b){return"("+b+")"};B.stringReplace=function(b,e,p,d){return b.substr(0,e)+d+b.substr(p,b.length)};var U=B.customType=function(b){return void 0!==b&&b.custom};B.sameSign=function(b,e){return 0>b===0>e};var Ca=B.format=function(){var b=[].slice.call(arguments);return b.shift().replace(/{(\d+)}/g,function(e,d){var p=b[d];return"function"===typeof p?p():p})},ra=B.keys=Object.keys,Pa=B.firstObject=function(b){for(var e in b)break;return b[e]};
B.compare=function(b,e,d){for(var p={},a,c=0;c<d.length;c++)p[d[c]]=new m(Math.floor(5*Math.random())+1);ma("PARSE2NUMBER",function(){a=x.parse(b,p).equals(x.parse(e,p))});return a};B.arrayMax=function(b){return Math.max.apply(void 0,b)};B.arrayMin=function(b){return Math.min.apply(void 0,b)};B.arrayClone=function(b){for(var e=[],d=b.length,a=0;a<d;a++)e[a]=b[a].clone();return e};B.comboSort=function(b,e){for(var d=b.length,a=[],c=0;c<b.length;c++)a.push([b[c],e[c]]);a.sort(function(b,e){return b[0]-
e[0]});for(var k=[],g=[],c=0;c<d;c++)k.push(a[c][0]),g.push(a[c][1]);return[k,g]};B.round=function(b,e){e=e||14;return Math.round(b*Math.pow(10,e))/Math.pow(10,e)};var fa=B.variables=function(b,e,d){d=d||{c:[],add:function(b){-1===this.c.indexOf(b)&&isNaN(b)&&this.c.push(b)}};if(E(b)){var p=b.group,k=b.previousGroup;p===a&&fa(b.power,e,d);if(p===h||p===r||k===h||k===r)for(var f in b.symbols)fa(b.symbols[f],e,d);else if(p===w||k===w)"e"!==b.value&&"pi"!==b.value&&d.add(b.value);else if(p===c||k===
c)fa(Pa(b.symbols),e,d);else if(p===a)isNaN(b.value)||d.add(b.value),fa(b.power,e,d);else if(p===g&&!e)for(p=0;p<b.args.length;p++)fa(b.args[p],e,d)}return d.c.sort()},jb=B.each=function(b,e){if(k(b))for(var d=b.length,a=0;a<d;a++)e.call(b,a);else for(d in b)b.hasOwnProperty(d)&&e.call(b,d)},pa=B.even=function(b){return 0===b%2};B.evenFraction=function(b){return 0===1/(b%1)%2};var vb=B.arrayUnique=function(b){for(var e=b.length,d=[],a=0;a<e;a++){var c=b[a];-1===d.indexOf(c)&&d.push(c)}return d},kb=
B.reserveNames=function(b){var e=function(b){-1===J.indexOf(b)&&J.push(b)};"string"===typeof b?e(b):jb(b,function(b){e(b)})},Za=B.remove=function(b,e){var d;k(b)?d=b.splice(e,1)[0]:(d=b[e],delete b[e]);return d},ma=B.block=function(b,e,d,a){var p=I[b];I[b]=void 0===d?!0:!!d;e=e.call(a);I[b]=p;return e};B.arguments2Array=function(b){return[].slice.call(b)};var lb=function(b){for(var e in b)b[e]=x.parse(b[e].toString());return b},Ja=B.generatePrimes=function(b){for(var e=da[da.length-1]||2;e<b;e++)Aa(e)&&
da.push(e)},oa={csc:function(b){return 1/Math.sin(b)},sec:function(b){return 1/Math.cos(b)},cot:function(b){return 1/Math.tan(b)},erf:function(b){var e=[.254829592,-.284496736,1.421413741,-1.453152027,1.061405429],d=1;0>b&&(d=-1);b=Math.abs(b);var a=1/(1+.3275911*b);return d*(1-((((e[4]*a+e[3])*a+e[2])*a+e[1])*a+e[0])*a*Math.exp(-b*b))},gamma:function(b){var e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9.984369578019572E-6,
1.5056327351493116E-7];if(.5>b)return Math.PI/(Math.sin(Math.PI*b)*gamma(1-b));--b;for(var d=e[0],a=1;9>a;a++)d+=e[a]/(b+a);e=b+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(e,b+.5)*Math.exp(-e)*d},fact:function(b){for(var e=1,d=2;d<=b;d++)e*=d;return e},GCD:function(){for(var b=vb([].slice.call(arguments).map(function(b){return Math.abs(b)})).sort(),e=Math.abs(b.shift()),d=b.length;0<d--;)for(var a=Math.abs(b.shift());;){e%=a;if(0===e){e=a;break}a%=e;if(0===a)break}return e},QGCD:function(){for(var b=
[].slice.call(arguments),e=b[0],d=1;d<b.length;d++){var a=b[d],c=e.isNegative()&&a.isNegative()?-1:1,e=a.gcd(e);0>c&&e.negate()}return e},LCM:function(b,e){return b*e/oa.GCD(b,e)},pow:function(b,e){return 0>b&&1>Math.abs(e)?0===1/e%2?NaN:-Math.pow(Math.abs(b),e):Math.pow(b,e)},ifactor:function(b,e){e=e||{};var d=Math.floor(Math.sqrt(b));d>da[da.length-1]&&1E6>b&&Ja(d);for(var d=da.length,a=0;a<d;a++)for(var c=da[a];0===b%c;)b/=c,e[c]=(e[c]||0)+1;1<b&&(e[b]=1);return e},boxfactor:function(b,e){e=e||
200;for(var d,a,c=Math.floor(5/12*b),k=0,g=!1;;){d=Math.floor(b/c);a=b%c;if(0===a)break;if(g)return[b,1];c=Math.max(a,c-a);k++;g=k>e}return[d,c,k]},fib:function(b){for(var e=0,d=1,a=1,c=2;c<=b;c++)a=e+d,e=d,d=a;return a},mod:function(b,e){return b%e},Ci:function(b){for(var e=0,d=1;20>d;d++)var a=2*d,e=e+Math.pow(-1,d)*Math.pow(b,a)/(a*oa.fact(a));return Math.log(b)+.5772156649015329+e},Si:function(b){for(var e=0,d=0;20>d;d++)var a=2*d,e=e+Math.pow(-1,d)*Math.pow(b,a+1)/((a+1)*oa.fact(a+1));return e}};
Math.sign=Math.sign||function(b){b=+b;return 0===b||isNaN(b)?b:0<b?1:-1};Math.cosh=Math.cosh||function(b){b=Math.exp(b);return(b+1/b)/2};Math.sinh=Math.sinh||function(b){b=Math.exp(b);return(b-1/b)/2};Math.tanh=Math.tanh||function(b){if(Infinity===b)return 1;if(-Infinity===b)return-1;b=Math.exp(2*b);return(b-1)/(b+1)};Math.asinh=Math.asinh||function(b){return-Infinity===b?b:Math.log(b+Math.sqrt(b*b+1))};Math.acosh=Math.acosh||function(b){return Math.log(b+Math.sqrt(b*b-1))};Math.atanh=Math.atanh||
function(b){return Math.log((1+b)/(1-b))/2};Math.log10=Math.log10||function(b){return Math.log(b)*Math.LOG10E};kb(oa);B.text=f;A.getExpression=function(b,e){"last"!==b&&b||(b=ca.length);"first"===b&&(b=1);var d=ca[b-1];return d?new A(d):d};A.prototype={text:function(b){return f(this.symbol,b||"decimals")},latex:function(b){return P.latex(this.symbol,b)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var b=arguments[0],e,d=1;"string"===typeof b?e="%"===b.charAt(0)?A.getExpression(b.substr(1)).text():
b:b instanceof A||E(b)?e=b.text():(e=this.symbol.text(),d--);var a=arguments[d]||{};a.e=x.constants.E;a.pi=x.constants.PI;return new A(ma("PARSE2NUMBER",function(){return x.parse(e,lb(a))},!0))},buildFunction:function(b){return Ka(this.symbol,b)},isNumber:function(){return q(this.symbol)},isInfinity:function(){return Infinity===Math.abs(this.symbol.multiplier)},variables:function(){return fa(this.symbol)},toString:function(){try{return k(this.symbol)?"["+this.symbol.toString()+"]":this.symbol.toString()}catch(b){return""}},
toDecimal:function(){return this.symbol.toDecimal()},isFraction:function(){return ea(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()},sub:function(b,e){return new A(this.symbol.sub(x.parse(b),x.parse(e)))}};A.prototype.toTeX=A.prototype.latex;u.isFrac=function(b){return b instanceof u};u.quick=function(b,e){var d=new u;d.num=new W(b);d.den=new W(e);return d};u.prototype={multiply:function(b){if(this.isOne())return b.clone();if(b.isOne())return this.clone();var e=this.clone();e.num=
e.num.multiply(b.num);e.den=e.den.multiply(b.den);return e.simplify()},divide:function(b){if(b.equals(0))throw Error("Division by zero not allowed!");return this.clone().multiply(b.clone().invert()).simplify()},subtract:function(b){return this.clone().add(b.clone().neg())},neg:function(){this.num=this.num.multiply(-1);return this},add:function(b){var e=this.den,d=b.den,a=this.clone(),c=a.num;b=b.num;e.equals(d)?a.num=c.add(b):(a.num=c.multiply(d).add(b.multiply(e)),a.den=e.multiply(d));return a.simplify()},
mod:function(b){var e=this.clone();b=b.clone();e.num=e.num.multiply(b.den);e.den=e.den.multiply(b.den);b.num=b.num.multiply(this.den);b.den=b.den.multiply(this.den);e.num=e.num.mod(b.num);return e.simplify()},simplify:function(){var b=W.gcd(this.num,this.den);this.num=this.num.divide(b);this.den=this.den.divide(b);return this},clone:function(){var b=new u;b.num=new W(this.num);b.den=new W(this.den);return b},toDecimal:function(){return this.num/this.den},qcompare:function(b){return[this.num.multiply(b.den),
b.num.multiply(this.den)]},equals:function(b){isNaN(b)||(b=new u(b));b=this.qcompare(b);return b[0].equals(b[1])},absEquals:function(b){isNaN(b)||(b=new u(b));b=this.qcompare(b);return b[0].abs().equals(b[1])},greaterThan:function(b){isNaN(b)||(b=new u(b));b=this.qcompare(b);return b[0].gt(b[1])},lessThan:function(b){isNaN(b)||(b=new u(b));b=this.qcompare(b);return b[0].lt(b[1])},isInteger:function(){return this.den.equals(1)},negate:function(){this.num=this.num.multiply(-1);return this},invert:function(){var b=
this.den,e=this.num.isNegative();this.den=this.num.abs();this.num=b;e&&(this.num=this.num.multiply(-1));return this},isOne:function(){return this.num.equals(1)&&this.den.equals(1)},sign:function(){return this.num.isNegative()?-1:1},abs:function(){this.num=this.num.abs();return this},gcd:function(b){return u.quick(W.gcd(b.num,this.num),W.lcm(b.den,this.den))},toString:function(){return this.den.equals(1)?String(this.num):this.num+"/"+this.den},valueOf:function(){return this.num/this.den},isNegative:function(){return 0>
this.toDecimal()}};m.imaginary=function(){var b=new m(I.IMAGINARY);b.isImaginary=!0;return b};m.shell=function(b,e){var d=new m(e);d.group=b;d.symbols={};d.length=0;return d};m.unwrapSQRT=function(b,e){var d=b.power;if(b.fname===t&&(b.isLinear()||e)){var a=b.args[0].clone();a.power=a.power.multiply(new u(.5));a.multiplier=a.multiplier.multiply(b.multiplier);b=a;e&&(b.power=d.multiply(new u(.5)))}return b};m.prototype={equals:function(b){E(b)||(b=new m(b));return this.value===b.value&&this.power.equals(b.power)&&
this.multiplier.equals(b.multiplier)},isPoly:function(b){var e=this.group,d=this.power;if(!O(d)||0>d)return!1;if(e===n||e===w)return!0;if(this.isComposite()||e===r&&b){if(!b&&1<fa(this))return!1;for(var a in this.symbols)if(!this.symbols[a].isPoly(b))return!1}else return!1;return!0},stripVar:function(b){var e;this.group!==c&&this.group!==w||this.value!==b?this.group===r&&this.isLinear()?(e=new m(1),this.each(function(d){d.contains(b,!0)||(e=x.multiply(e,d.clone()))}),e.multiplier=e.multiplier.multiply(this.multiplier)):
this.group!==h||this.isLinear()?this.group===h&&this.isLinear()?(e=new m(0),this.each(function(d){d.contains(b)||(d=d.clone(),d.multiplier=d.multiplier.multiply(this.multiplier),e=x.add(e,d))})):e=this.group===g&&this.contains(b)?new m(this.multiplier):this.clone():e=new m(this.multiplier):e=new m(this.multiplier);return e},toArray:function(b,e){e=e||{arr:[],add:function(b,e){var d=this.arr[e];this.arr[e]=d?x.add(d,b):b}};var d=this.group;if(d===w&&this.contains(b))e.add(new m(this.multiplier),this.power);
else if(d===r){var d=this.stripVar(b),a=x.divide(this.clone(),d.clone()),a=a.isConstant()?0:a.power;e.add(d,a)}else if(d===c&&this.value===b)this.each(function(d,a){e.add(d.stripVar(b),a)});else if(d===h)this.each(function(d){d.toArray(b,e)});else{if(this.contains(b))throw Error("Cannot convert to array! Exiting");e.add(this.clone(),0)}e=e.arr;for(d=0;d<e.length;d++)e[d]||(e[d]=new m(0));return e},hasFunc:function(){if(this.group===g||this.group===a)return!0;if(this.symbols)for(var b in this.symbols)if(this.symbols[b].hasFunc())return!0;
return!1},sub:function(b,e){var d=this.group,c=b.group;if(d===c&&this.equals(b))return e.clone();var k;if(d===c&d===w&&b.isLinear()&&this.value===b.value)k=e.clone(),k.multiplier=this.multiplier.clone(),k.power=this.power.clone(),k=x.parse(k);else if(f(this,"hash")===f(b,"hash"))d=x.divide(x.parse(this.power),x.parse(b.power)),O(d)&&(k=e.clone(),k=x.pow(k,x.parse(d)),k.multiplier=k.multiplier.multiply(this.multiplier));else if(this.symbols){k=this.clone();var h=this.isComposite()?"attach":"combine";
k.symbols={};this.each(function(d){d=d.sub(b,e);k[h](d)});k.updateHash()}else if(d===g){k=this.clone();k.args=[];for(d=0;d<this.args.length;d++)k.args[d]=this.args[d].sub(b,e);k.updateHash()}this.group===a&&(k=k||this.clone(),k.power=k.power.sub(b,e),k=x.parse(k));return k?k:this.clone()},isMonomial:function(){if(this.group===w)return!0;if(this.group===r)for(var b in this.symbols){if(this.symbols[b].group!==w)return!1}else return!1;return!0},isPi:function(){return this.group===w&&"pi"===this.value},
sign:function(){return this.multiplier.sign()},isE:function(){return"e"===this.value},isSQRT:function(){return this.fname===t},isConstant:function(){return this.value===l},isInteger:function(){return this.isConstant()&&this.multiplier.isInteger()},isLinear:function(b){if(b){if(this.isConstant())return!0;if(this.group===w)return this.value===b?this.power.equals(1):!0;if(this.isComposite()&&this.power.equals(1)){for(var e in this.symbols)if(!this.symbols[e].isLinear(b))return!1;return!0}return this.group===
r&&this.symbols[b]?this.symbols[b].isLinear(b):!1}return this.power.equals(1)},multiplyPower:function(b){if(this.group===n&&this.multiplier.equals(1))return this;var e=this.power;this.group!==a&&b.group===n?(b=b.multiplier,this.group!==n||b.isInteger()||this.convert(D),this.power=e.equals(1)?b.clone():e.multiply(b),this.group===D&&O(this.power)&&(this.value=Math.pow(this.value,this.power),this.toLinear(),this.convert(n))):(this.group!==a&&(e=new m(e),this.convert(a)),this.power=x.multiply(e,b));return this},
setPower:function(b,e){if(this.group===n&&this.multiplier.equals(1))return this;if(this.group!==a||E(b)){var d=!1;E(b)&&(b.group===n?b=b.multiplier:d=!0);d=d?a:D;this.power=b;this.group===n&&d&&this.convert(d,e)}else this.group=this.previousGroup,delete this.previousGroup,this.power=b;return this},isInverse:function(){return this.group===a?this.power.multiplier.lessThan(0):0>this.power},clone:function(b){b=b||new m(0);var e="value group length previousGroup imaginary fname args".split(" "),d=e.length,
a;if(this.symbols)for(a in b.symbols={},this.symbols)b.symbols[a]=this.symbols[a].clone();for(a=0;a<d;a++)void 0!==this[e[a]]&&(b[e[a]]=this[e[a]]);b.power=this.power.clone();b.multiplier=this.multiplier.clone();return b},toUnitMultiplier:function(b){this.multiplier.num=new W(this.multiplier.num.isNegative()&&b?-1:1);this.multiplier.den=new W(1);return this},toLinear:function(){this.setPower(new u(1));return this},each:function(b){if(this.symbols)for(var e in this.symbols)b.call(this,this.symbols[e],
e);else b.call(this,this,this.value)},valueOf:function(){return this.group===n?this.multiplier:0===this.power?1:0===this.multiplier?0:f(this,"decimals")},contains:function(b,e){var d=this.group;if(this.symbols&&d!==a)for(var c in this.symbols){if(this.symbols[c].contains(b,e))return!0}else if(d===g||this.previousGroup===g)for(d=0;d<this.args.length;d++){if(this.args[d].contains(b,e))return!0}else if(d===a&&e&&this.power.contains(b,e))return!0;return this.value===b},negate:function(){this.multiplier.negate();
this.group!==h&&this.group!==c||this.distributeMultiplier();return this},invert:function(b){b||(this.multiplier=this.multiplier.invert());E(this.power)?this.power.negate():this.power&&this.group!==n&&this.power.negate();return this},distributeMultiplier:function(){if(this.symbols&&this.power.equals(1)&&this.group!==r&&!this.multiplier.equals(1)){for(var b in this.symbols){var e=this.symbols[b];e.multiplier=e.multiplier.multiply(this.multiplier);e.distributeMultiplier()}this.toUnitMultiplier()}return this},
distributeExponent:function(){if(1!==this.power){var b=this.power,e;for(e in this.symbols){var d=this.symbols[e];d.group===a?d.power=x.multiply(d.power,new m(b)):this.symbols[e].power=this.symbols[e].power.multiply(b)}this.toLinear()}return this},convert:function(b,e){if(b>g){var d=this.clone();this.symbols={};b===r?d.toUnitMultiplier():this.toUnitMultiplier();this.group===g&&(d.args=this.args,delete this.args,delete this.fname);this.isImgSymbol&&delete this.isImgSymbol;this.toLinear();this.symbols[d.keyForGroup(b)]=
d;this.group=b;this.length=1}else b===a?this.group===n&&this.multiplier.equals(1)||(this.group!==a&&(this.previousGroup=this.group),this.group===n?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=f(this,"hash"),this.group=a):b===n?(d=this.multiplier.toDecimal(),this.symbols&&(this.symbols=void 0),(new m(this.group===D?d*Math.pow(this.value,this.power):d)).clone(this)):b===D&&this.group===n&&("1"!==this.multiplier.den.toString()&&M("Attempting conversion of group N with non-unit denominator!"),
this.value=e?this.multiplier.num.toString():Math.abs(this.multiplier.num.toString()),this.toUnitMultiplier(!e),this.group=D);return this},insert:function(b,e){E(b)||M("Object "+b+" is not of type Symbol!");if(this.symbols){var d=this.group;if(d>g){var d=b.keyForGroup(d),c=d in this.symbols?this.symbols[d]:!1;"add"===e?c?(this.symbols[d]=x.add(c,b),this.symbols[d].multiplier.equals(0)&&(delete this.symbols[d],this.length--,0===this.length&&(this.convert(n),this.multiplier=new u(0)))):(this.symbols[d]=
b,this.length++):(b.group===D&&O(b.power)&&b.convert(n),b.group!==a?(this.multiplier=this.multiplier.multiply(b.multiplier),b.toUnitMultiplier()):(b.parens=b.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(b.multiplier.clone().abs()),b.toUnitMultiplier(!0)),c&&(b=x.multiply(Za(this.symbols,d),b),b.isConstant()&&(this.multiplier=this.multiplier.multiply(b.multiplier),b=new m(1)),this.length--),b.isOne(!0)?b.multiplier.lessThan(0)&&this.negate():(this.symbols[d]=b,this.length++));0===
this.length&&this.convert(n);this.group!==h&&this.group!==r||this.updateHash()}}return this},attach:function(b){if(k(b)){for(var e=0;e<b.length;e++)this.insert(b[e],"add");return this}return this.insert(b,"add")},combine:function(b){if(k(b)){for(var e=0;e<b.length;e++)this.insert(b[e],"multiply");return this}return this.insert(b,"multiply")},updateHash:function(){if(this.group!==n)if(this.group===g){for(var b="",e=this.args,d=this.fname===G,a=0;a<e.length;a++)b+=(0===a?"":",")+f(e[a]);this.value=
(d?"":this.fname)+(d?b:F(b))}else this.group!==w&&this.group!==c&&(this.value=f(this,"hash"))},keyForGroup:function(b){var e=this.group,d;e===n?d=this.value:e===w||e===D?d=b===c?this.power.toDecimal():this.value:e===g?d=b===c?this.power.toDecimal():f(this,"hash"):e===c?d=b===r?f(this,"hash"):b===h?this.power.equals(1)?this.value:F(f(this,"hash"))+"^"+this.power.toDecimal():b===c?this.power.toString():this.value:e===h?(b===h&&f(this,"hash"),d=b===c?this.power.toDecimal():this.value):e===r?d=b===c?
this.power.toDecimal():f(this,"hash"):e===a&&(d=b===c?f(this.power):f(this,"hash"));return d},collectSymbols:function(b,e,d,a){var k=[];if(this.symbols)for(var p in this.symbols){var g=this.symbols[p];!a||g.group!==c&&g.group!==h?k.push(b?b(g,e):g):k=k.concat(g.collectSymbols())}else k.push(this);null===d&&(d=void 0);return k.sort(d)},latex:function(){return P.latex(this)},text:function(){return f(this)},isOne:function(b){return this.group===n?this.multiplier[b?"absEquals":"equals"](1):this.power.equals(0)},
isComposite:function(){var b=this.group,e=this.previousGroup;return b===h||b===c||e===c||e===h},isCombination:function(){var b=this.previousGroup;return this.group===r||b===r},lessThan:function(b){return this.multiplier.lessThan(b)},getDenom:function(){if(this.power.lessThan(0))return this.clone();if(this.group===r)var b=new m(1);for(var e in this.symbols)0>this.symbols[e].power&&(b=x.multiply(b,this.symbols[e].clone()));return b},getNum:function(){if(this.power.lessThan(0))return new m(this.multiplier.num);
if(this.group===r){var b=new m(1),e;for(e in this.symbols)0<this.symbols[e].power&&(b=x.multiply(b,this.symbols[e].clone()));return b}return this.clone()},toString:function(){return this.text()}};ba.prototype.toString=function(){return this.val};ia.prototype={resolve:function(b){return"-"===this.val?b.negate():b},toString:function(){return this.val}};var T={convert:function(b,e){var d;if(0===b)d=[0,1];else if(1E-6>b||1E20<b){if(d=this.quickConversion(Number(b)),1E20>=d[1]){var a=Math.abs(b),c=b/a;
d=this.fullConversion(a.toFixed((d[1]+"").length-1));d[0]*=c}}else d=this.fullConversion(b);return d},quickConversion:function(b){b=(b.toExponential()+"").split("e");var e=b[0].split(".")[1],e=e?e.length:0;return[Math.pow(10,e)*b[0],Math.pow(10,Math.abs(b[1])+e)]},fullConversion:function(b){for(var e=!1,d=0,a=1,c=1,k=0,g=0,h=b;!e;){g++;1E4<g&&(e=!0);var f=Math.floor(h),q=d+f*c,r=a+f*k,d=h-f;1E-16>d&&(e=!0);h=1/d;d=c;a=k;c=q;k=r;if(1E-16>Math.abs(q/r-b)||30<g)e=!0}return[q,r]}},P={space:"~",dot:" \\cdot ",
latex:function(b,e){if(k(b)){for(var a=[],c=0;c<b.length;c++)a.push(this.latex(b[c]));return this.brackets(a.join(", "),"square")}if(d(b)){a="\\begin{pmatrix}\n";for(c=0;c<b.elements.length;c++){for(var g=[],h=b.elements[c],f=0;f<h.length;f++)g.push(this.latex(h));a+=g.join(" & ")+"\\\\\n"}return a+"\\end{pmatrix}"}b=b.clone();var f="decimal"===e,q=b.power,c=X(q),a=b.multiplier.lessThan(0);if(b.group===D&&f)return String(b.multiplier.toDecimal()*Math.pow(b.value,b.power.toDecimal()));b.multiplier=
b.multiplier.abs();f?(g=String(b.multiplier.toDecimal()),"1"!=g||f||(g=""),g=[g,""]):g=[b.multiplier.num,b.multiplier.den];h=this.value(b,c,e,a);c&&q.negate();f?(f=E(q)?P.latex(q,e):String(q.toDecimal()),"1"==f&&(f="")):f=E(q)?this.latex(q,e):this.formatFrac(q,!0);q=["",""];q[c?1:0]=f;return((a?"-":"")+this.set(g,h,q,b.group===r)).replace(/\+\-/gi,"-")},greek:{alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",
kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omnikron:"\\omnikron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Epsilon:"\\Epsilon",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega"},value:function(b,e,d,c){var k=b.group,p=b.previousGroup,f=["",""];e=e?1:0;if(k===w||k===D||p===w||p===D||p===n)k=b.value,(c=this.greek[k])&&
(k=c),f[e]=k;else if(k===g||p===g){c=[];p=b.fname;for(k=0;k<b.args.length;k++){var q=b.args[k],q="string"===typeof q?q:this.latex(q,d);c.push(q)}p===t?f[e]="\\sqrt"+this.braces(c.join(",")):p===y?f[e]=this.brackets(c.join(","),"abs"):p===G?f[e]=this.brackets(c.join(","),"parens"):"integrate"===p?f[e]="\\int"+this.braces(c[0])+this.braces("d"+c[1]):p===Ba?(q=b.args[0],q.power.equals(1)&&(q.isComposite()||q.isCombination())&&(c[0]=this.brackets(c[0])),f[e]=c[0]+"!"):(k="\\mathrm"+this.braces(p),f[e]=
k+this.brackets(c.join(","),"parens"))}else if(b.isComposite()){for(var p=b.collectSymbols().sort(k===h||p===h?function(b,e){return e.group-b.group}:function(b,e){var d=E(b.power)?-1:b.power;return(E(e.power)?-1:e.power)-d}),q=[],l=p.length,k=0;k<l;k++)q.push(P.latex(p[k],d));k=q.join("+");f[e]=b.isLinear()&&b.multiplier.equals(1)&&!c?k:this.brackets(k,"parens")}else if(k===r||p===a){var F=[],U=[],O=[],m=[],V=0,u=0;e=function(b,e,d){if(1<d&&0<e.length){d=e.length;for(var a=0;a<d;a++){var c=e[a],k=
b[c];/^\\left\(.+\\right\)\^\{.+\}$/g.test(k)||/^\\left\(.+\\right\)$/g.test(k)||(b[c]=P.brackets(k,"parens"))}}return b};b.each(function(e){var a;X(e.power)?(a=P.latex(e.invert(),d),u++,e.isComposite()&&(1!=b.multiplier.den&&1==Math.abs(e.power)&&(a=P.brackets(a,"parens")),O.push(F.length)),F.push(a)):(a=P.latex(e,d),V++,e.isComposite()&&(1!=b.multiplier.num&&1==Math.abs(e.power)&&(a=P.brackets(a,"parens")),m.push(U.length)),U.push(a))});e(U,m,V);f[0]=U.join(this.dot);e(F,O,u);f[1]=F.join(this.dot)}return f},
set:function(b,e,d,a){d&&(d=this.formatP(d));if(a){var c=d[0];d[0]=""}e=this.merge(e,d);d=b[0];b=b[1];var k=e[0];e=e[1];k&&1==d&&(d="");1==b&&(b="");d=this.join(d,k,/^\\left\(.+\\right\)$/.test(k)?"":this.dot);e=this.join(b,e,/^\\left\(.+\\right\)$/.test(e)?"":this.dot);return d&&e?(e=this.frac(d,e),a&&c&&(e=this.brackets(e)+c),e):d},merge:function(b,e){for(var d=[],a=0;2>a;a++)d[a]=b[a]+e[a];return d},join:function(b,e,d){return b||e?b&&!e?b:e&&!b?e:b+d+e:""},formatP:function(b){for(var e=0;2>e;e++){var d=
b[e];d&&(b[e]="^"+this.braces(d))}return b},formatFrac:function(b,e){var d=b.num.toString(),a=b.den.toString();return e&&"1"===d&&"1"===a?"":"1"===a?d:this.frac(d,a)},frac:function(b,e){return"\\frac"+this.braces(b)+this.braces(e)},braces:function(b){return"{"+b+"}"},brackets:function(b,e){var d={parens:["(",")"],square:["[","]"],brace:["{","}"],abs:["|","|"],angle:["\\langle","\\rangle"]}[e||"parens"];return"\\left"+d[0]+b+"\\right"+d[1]}};Z.arrayPrefill=function(b,e){var d=[];e=e||0;for(var a=0;a<
b;a++)d[a]=e;return d};Z.fromArray=function(b){var e=new Z;e.elements=b;return e};Z.prototype={custom:!0,e:function(b){return 1>b||b>this.elements.length?null:this.elements[b-1]},set:function(b,e){this.elements[b]=new m(e)},dimensions:function(){return this.elements.length},modulus:function(){return ma("SAFE",function(){return x.pow(this.dot(this.clone()),new m(.5))},void 0,this)},eql:function(b){var e=this.elements.length;b=b.elements||b;if(e!==b.length)return!1;do if(Math.abs(x.subtract(this.elements[e-
1],b[e-1]).valueOf())>PRECISION)return!1;while(--e);return!0},clone:function(){for(var b=new Z,e=this.elements.length,d=0;d<e;d++)b.elements.push(this.elements[d].clone());return b},map:function(b){var e=[];this.each(function(d,a){e.push(b(d,a))});return new Z(e)},each:function(b){var e=this.elements.length,d=e,a;do a=d-e,b(this.elements[a],a+1);while(--e)},toUnitVector:function(){return ma("SAFE",function(){var b=this.modulus();return 0===b.valueOf()?this.clone():this.map(function(e){return x.divide(e,
b)})},void 0,this)},angleFrom:function(b){return ma("SAFE",function(){var e=b.elements||b;if(this.elements.length!==e.length)return null;var d=new m(0),a=new m(0),c=new m(0);this.each(function(b,k){d=x.add(d,x.multiply(b,e[k-1]));a=x.add(a,x.multiply(b,b));c=x.add(c,x.multiply(e[k-1],e[k-1]))});var a=x.pow(a,new m(.5)),c=x.pow(c,new m(.5)),k=x.multiply(a,c);if(0===k.valueOf())return null;var k=x.divide(d,k),g=k.valueOf();-1>g&&(k=-1);1<g&&(k=1);return new m(Math.acos(k))},void 0,this)},isParallelTo:function(b){b=
this.angleFrom(b).valueOf();return null===b?null:b<=PRECISION},isAntiparallelTo:function(b){b=this.angleFrom(b).valueOf();return null===b?null:Math.abs(b-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(b){b=this.dot(b);return null===b?null:Math.abs(b)<=Sylvester.precision},add:function(b){return ma("SAFE",function(){var e=b.elements||b;return this.elements.length!==e.length?null:this.map(function(b,d){return x.add(b,e[d-1])})},void 0,this)},subtract:function(b){return ma("SAFE",function(){var e=
b.elements||b;return this.elements.length!==e.length?null:this.map(function(b,d){return x.subtract(b,e[d-1])})},void 0,this)},multiply:function(b){return this.map(function(e){return e.clone()*b.clone()})},x:function(b){return this.multiply(b)},dot:function(b){return ma("SAFE",function(){var e=b.elements||b,d=new m(0),a=this.elements.length;if(a!==e.length)return null;do d=x.add(d,x.multiply(this.elements[a-1],e[a-1]));while(--a);return d},void 0,this)},cross:function(b){var e=b.elements||b;if(3!==
this.elements.length||3!==e.length)return null;var d=this.elements;return ma("SAFE",function(){return new Z([x.subtract(x.multiply(d[1],e[2]),x.multiply(d[2],e[1])),x.subtract(x.multiply(d[2],e[0]),x.multiply(d[0],e[2])),x.subtract(x.multiply(d[0],e[1]),x.multiply(d[1],e[0]))])},void 0,this)},max:function(){var b=0,e=this.elements.length,d=e,a;do a=d-e,Math.abs(this.elements[a].valueOf())>Math.abs(b.valueOf())&&(b=this.elements[a]);while(--e);return b},indexOf:function(b){var e=null,d=this.elements.length,
a=d,c;do c=a-d,null===e&&this.elements[c].valueOf()===b.valueOf()&&(e=c+1);while(--d);return e},text:function(b){return f(this)},toString:function(){return this.text()},latex:function(b){var d=[],a;for(a in this.elements)d.push(P.latex.call(P,this.elements[a],b));return"["+d.join(", ")+"]"}};H.identity=function(b){for(var d=new H,a=0;a<b;a++){d.elements.push([]);for(var c=0;c<b;c++)d.set(a,c,a===c?new m(1):new m(0))}return d};H.fromArray=function(b){function d(b){return H.apply(this,b)}d.prototype=
H.prototype;return new d(b)};H.zeroMatrix=function(b,d){for(var e=new H,a=0;a<b;a++)e.elements.push(Z.arrayPrefill(d,new m(0)));return e};H.prototype={custom:!0,set:function(b,d,a){this.elements[b]||(this.elements[b]=[]);this.elements[b][d]=E(a)?a:new m(a)},cols:function(){return this.elements[0].length},rows:function(){return this.elements.length},row:function(b){return!b||b>this.cols()?[]:this.elements[b-1]},col:function(b){var d=this.rows(),a=[];if(b>this.cols()||!b)return a;for(var c=0;c<d;c++)a.push(this.elements[c][b-
1]);return a},eachElement:function(b){var d=this.rows(),a=this.cols(),c,k;for(c=0;c<d;c++)for(k=0;k<a;k++)this.elements[c][k]=b.call(this,this.elements[c][k],c,k)},determinant:function(){if(!this.isSquare())return null;var b=this.toRightTriangular(),d=b.elements[0][0],a=b.elements.length-1,c=a,k;do k=c-a+1,d=x.multiply(d,b.elements[k][k]);while(--a);return d},isSquare:function(){return this.elements.length===this.elements[0].length},isSingular:function(){return this.isSquare()&&0===this.determinant()},
augment:function(b){var d=this.rows(),a=b.rows();d!==a&&M("Cannot augment matrix. Rows don't match.");for(a=0;a<d;a++)this.elements[a]=this.elements[a].concat(b.elements[a]);return this},clone:function(){for(var b=this.rows(),d=this.cols(),a=new H,c=0;c<b;c++){a.elements[c]=[];for(var k=0;k<d;k++){var g=this.elements[c][k];a.elements[c][k]=E(g)?g.clone():g}}return a},invert:function(){this.isSquare()||M("Matrix is not square!");return ma("SAFE",function(){var b=this.elements.length,d=b,a,c;a=H.identity(b);
var k=this.augment(a).toRightTriangular(),g,f=k.elements[0].length,h,q,r=[],l;do{a=b-1;q=[];g=f;r[a]=[];c=k.elements[a][a];do h=f-g,l=x.divide(k.elements[a][h],c.clone()),q.push(l),h>=d&&r[a].push(l);while(--g);k.elements[a]=q;for(c=0;c<a;c++){q=[];g=f;do h=f-g,q.push(x.subtract(k.elements[c][h].clone(),x.multiply(k.elements[a][h].clone(),k.elements[c][a].clone())));while(--g);k.elements[c]=q}}while(--b);return H.fromArray(r)},void 0,this)},toRightTriangular:function(){return ma("SAFE",function(){var b=
this.clone(),d,a,c=this.elements.length,k=c,g,f,h=this.elements[0].length,q;do{g=k-c;a=b.elements[g][g];if(0===a.valueOf())for(a=g+1;a<k;a++)if((d=b.elements[a][g])&&0!==d.valueOf()){d=[];f=h;do q=h-f,d.push(x.add(b.elements[g][q].clone(),b.elements[a][q].clone()));while(--f);b.elements[g]=d;break}a=b.elements[g][g];if(0!==a.valueOf())for(a=g+1;a<k;a++){var r=x.divide(b.elements[a][g].clone(),b.elements[g][g].clone());d=[];f=h;do q=h-f,d.push(q<=g?new m(0):x.subtract(b.elements[a][q].clone(),x.multiply(b.elements[g][q].clone(),
r.clone())));while(--f);b.elements[a]=d}}while(--c);return b},void 0,this)},transpose:function(){var b=this.elements.length,d=this.elements[0].length,a=new H,c=d,k,g,f;do{k=d-c;a.elements[k]=[];g=b;do f=b-g,a.elements[k][f]=this.elements[f][k].clone();while(--g)}while(--c);return a},canMultiplyFromLeft:function(b){b=d(b)?b.elements.length:b.length;return this.elements[0].length===b},sameSize:function(b){return this.rows()===b.rows()&&this.cols()===b.cols()},multiply:function(b){return ma("SAFE",function(){var d=
b.elements||b;if(!this.canMultiplyFromLeft(d)){if(this.sameSize(b)){for(var d=new H,a=this.rows(),c=0;c<a;c++){var k=x.multiply(new Z(this.elements[c]),new Z(b.elements[c]));d.elements[c]=k.elements}return d}return null}var k=a=this.elements.length,g,f=d[0].length,h,q=this.elements[0].length,r=[],l,F,t;do{c=k-a;r[c]=[];g=f;do{h=f-g;l=new m(0);F=q;do t=q-F,l=x.add(l,x.multiply(this.elements[c][t],d[t][h]));while(--F);r[c][h]=l}while(--g)}while(--a);return H.fromArray(r)},void 0,this)},add:function(b){var d=
new H;this.sameSize(b)&&this.eachElement(function(e,a,c){d.set(a,c,x.add(e.clone(),b.elements[a][c]))});return d},subtract:function(b){var d=new H;this.sameSize(b)&&this.eachElement(function(e,a,c){d.set(a,c,x.subtract(e.clone(),b.elements[a][c]))});return d},negate:function(){this.each(function(b){return b.negate()});return this},toVector:function(){if(1===this.rows()||1===this.cols()){var b=new Z;b.elements=this.elements;return b}return this},toString:function(b){b=this.rows();for(var d=[],a=0;a<
b;a++)d.push("["+this.elements[a].map(function(b){return void 0!==b?b.toString():""}).join(",")+"]");return"matrix"+F(d.join(","))},text:function(){return"matrix("+this.toString("")+")"},latex:function(b){var d=this.cols(),a=this.elements;return Ca("\\begin{vmatrix}{0}\\end{vmatrix}",function(){var e=[],c;for(c in a){for(var k=[],g=0;g<d;g++)k.push(P.latex.call(P,a[c][g],b));e.push(k.join(" & "))}return e.join(" \\cr ")})}};H.prototype.each=H.prototype.eachElement;var Ka=B.build=function(b,d){var e=
fa(b),c=[],k=function(b,d){d=d||[];var e=[],f=b.group,h="",q=function(e){e=e===r?"*":"+";var a=[],c;for(c in b.symbols)a.push(k(b.symbols[c],d)[0]);return(c=a.join(e))&&!b.multiplier.equals(1)?F(c):c},p=function(e){e in Math?e="Math."+e:-1===c.indexOf(e)&&(d.push("var "+e+" = "+oa[e].toString()+"; "),c.push(e));return e+=F(b.args.map(function(b){return k(b,d)[0]}).join(","))};f===n?e.push(b.multiplier.toDecimal()):b.multiplier.equals(-1)?h="-":b.multiplier.equals(1)||e.push(b.multiplier.toDecimal());
f===w?q=b.value:f===g?q=p(b.fname):f===a?(f=b.previousGroup,q=f===n||f===w?b.value:f===g?p(b.fname):q(b.previousGroup)):q=q(b.group);b.group===n||b.power.equals(1)||(p=k(x.parse(b.power)),d.push(p[1]),q="Math.pow"+F(q+","+p[0]));q&&e.push(h+q);return[e.join("*"),d.join("").replace(/\n+\s+/g," ")]};if(d){e.length!==d.length&&M("Argument array contains wrong number of arguments");for(var f=0;f<e.length;f++){var h=e[f];-1===d.indexOf(h)&&M(h+" not found in argument array")}e=d}f=k(b);return new Function(e,
f[1]+" return "+f[0]+";")};kb(x.constants);kb(x.functions);Ja(I.init_primes);var ja={};ja.Operator=ba;ja.groups=z;ja.Symbol=m;ja.Expression=A;ja.Frac=u;ja.Vector=Z;ja.Matrix=H;ja.Parser=L;ja.Fraction=T;ja.Math2=oa;ja.LaTeX=P;ja.Utils=B;ja.PRIMES=da;ja.PARSER=x;ja.PARENTHESIS=G;ja.Settings=I;ja.VARS=R;ja.err=M;ja.bigInt=W;var aa=function(b,d,a,c){var e,g,f;b instanceof A&&(b=b.toString());var h=b.split("=");1<h.length&&(/\w+\((.*)\)/.test(h[0].replace(/\s/g,""))?(g=/\w+(?=\()/.exec(h[0])[0],f=/\((.*)(?=\))/.exec(h[0])[1].replace(/\s/g,
"").split(",")):e=h[0],b=h[1]);var q=(h=k(a))?-1!==a.indexOf("numer"):"numer"===a;if(h?-1!==a.indexOf("expand"):"expand"===a)b=Ca("{0}({1})","expand",b);a=ma("PARSE2NUMBER",function(){return x.parse(b,lb(d))},q||I.PARSE2NUMBER);c?ca[c-1]=a:ca.push(a);e&&aa.setVar(e,a);g&&aa.setFunction(g,f,a);return new A(a)};aa.version=function(){return"0.6.6"};aa.getWarnings=function(){return""};aa.setConstant=function(b,d){ga(b);if(!la(b))if("delete"===d)delete x.constants[b];else{if(isNaN(d))throw Error("Constant must be a number!");
x.constants[b]=d}return this};aa.setFunction=function(b,d,a){ga(b);return la(b)?!1:(d=d||fa(x.parse(a)),x.functions[b]=[x.mapped_function,d.length,{name:b,params:d,body:a}],!0)};aa.getCore=function(){return ja};aa.getExpression=aa.getEquation=A.getExpression;aa.reserved=function(b){return b?J:J.join(", ")};aa.clear=function(b,d){if("all"===b)ca=[];else if("last"===b)ca.pop();else if("first"===b)ca.shift();else{var e=b?b-1:ca.length;!0===d?ca[e]=void 0:Za(ca,e)}return this};aa.flush=function(){this.clear("all");
return this};aa.expressions=function(b,d,a){for(var e=b?{}:[],c=0;c<ca.length;c++){var k=d?P.latex(ca[c],a):f(ca[c],a);b?e[c+1]=k:e.push(k)}return e};aa.register=function(b){var d=this.getCore();if(k(b))for(var a=0;a<b.length;a++)b&&this.register(b[a]);else if(b&&-1===I.exclude.indexOf(b.name)){if(b.dependencies)for(a=0;a<b.dependencies.length;a++)if(!d[b.dependencies[a]])throw Error(Ca("{0} requires {1} to be loaded!",b.name,b.dependencies[a]));var a=b.parent,c=b.build.call(d);a&&(d[a]||(d[b.parent]=
{}),("nerdamer"===a?this:d[a])[b.name]=c);b.visible&&(x.functions[b.name]=[c,b.numargs])}};aa.validateName=ga;aa.validVarName=function(b){try{return ga(b),-1===J.indexOf(b)}catch(e){return!1}};aa.supported=function(){return ra(x.functions)};aa.numEquations=aa.numExpressions=function(){return ca.length};aa.setVar=function(b,d){ga(b);"delete"===d?delete R[b]:R[b]=E(d)?d:x.parse(d);return this};aa.clearVars=function(){R={};return this};aa.load=function(b){b.call(this);return this};aa.getVars=function(b,
d){b=b||"text";var a={};if("object"===b)a=R;else for(var e in R)"latex"===b?a[e]=R[e].latex(d):"text"===b&&(a[e]=R[e].text(d));return a};aa.set=function(b,d){-1!==["SAFE"].indexOf(b)&&M("Cannot modify setting: "+b);I[b]=d};return aa}({bigInt:function(z){function f(d,a){this.value=d;this.sign=a;this.isSmall=!1}function v(d){this.value=d;this.sign=0>d;this.isSmall=!0}function A(d){return-9007199254740992<d&&9007199254740992>d}function u(d){return 1E7>d?[d]:1E14>d?[d%1E7,Math.floor(d/1E7)]:[d%1E7,Math.floor(d/
1E7)%1E7,Math.floor(d/1E14)]}function m(d){Y(d);var a=d.length;if(4>a&&0>c(d,la))switch(a){case 0:return 0;case 1:return d[0];case 2:return d[0]+1E7*d[1];default:return d[0]+1E7*(d[1]+1E7*d[2])}return d}function Y(d){for(var a=d.length;0===d[--a];);d.length=a+1}function ba(d){for(var a=Array(d),c=-1;++c<d;)a[c]=0;return a}function ia(d){return 0<d?Math.floor(d):Math.ceil(d)}function L(d,a){var c=d.length,g=a.length,f=Array(c),h=0,q,r;for(r=0;r<g;r++)q=d[r]+a[r]+h,h=1E7<=q?1:0,f[r]=q-1E7*h;for(;r<
c;)q=d[r]+h,h=1E7===q?1:0,f[r++]=q-1E7*h;0<h&&f.push(h);return f}function Z(d,a){return d.length>=a.length?L(d,a):L(a,d)}function H(d,a){var c=d.length,g=Array(c),f,h;for(h=0;h<c;h++)f=d[h]-1E7+a,a=Math.floor(f/1E7),g[h]=f-1E7*a,a+=1;for(;0<a;)g[h++]=a%1E7,a=Math.floor(a/1E7);return g}function x(d,a){var c=d.length,g=a.length,f=Array(c),h=0,q,r;for(q=0;q<g;q++)r=d[q]-h-a[q],0>r?(r+=1E7,h=1):h=0,f[q]=r;for(q=g;q<c;q++){r=d[q]-h;if(0>r)r+=1E7;else{f[q++]=r;break}f[q]=r}for(;q<c;q++)f[q]=d[q];Y(f);return f}
function W(d,a,c){var k=d.length,g=Array(k);a=-a;var h,q;for(h=0;h<k;h++)q=d[h]+a,a=Math.floor(q/1E7),q%=1E7,g[h]=0>q?q+1E7:q;g=m(g);return"number"===typeof g?(c&&(g=-g),new v(g)):new f(g,c)}function da(d,a){var c=d.length,g=a.length,f=ba(c+g),h,q,r,l;for(r=0;r<c;++r){l=d[r];for(var t=0;t<g;++t)h=a[t],h=l*h+f[r+t],q=Math.floor(h/1E7),f[r+t]=h-1E7*q,f[r+t+1]+=q}Y(f);return f}function B(d,a){var c=d.length,g=Array(c),f=0,h,q;for(q=0;q<c;q++)h=d[q]*a+f,f=Math.floor(h/1E7),g[q]=h-1E7*f;for(;0<f;)g[q++]=
f%1E7,f=Math.floor(f/1E7);return g}function I(d,a){for(var c=[];0<a--;)c.push(0);return c.concat(d)}function n(d,a){var c=Math.max(d.length,a.length);if(30>=c)return da(d,a);var c=Math.ceil(c/2),g=d.slice(c),f=d.slice(0,c),h=a.slice(c),q=a.slice(0,c),r=n(f,q),l=n(g,h),g=n(Z(f,g),Z(q,h)),c=Z(Z(r,I(x(x(g,r),l),c)),I(l,2*c));Y(c);return c}function D(d,a,c){return 1E7>d?new f(B(a,d),c):new f(da(a,u(d)),c)}function w(d){var a=d.length,c=ba(a+a),g,f,h,r;for(h=0;h<a;h++){r=d[h];for(var l=0;l<a;l++)g=d[l],
g=r*g+c[h+l],f=Math.floor(g/1E7),c[h+l]=g-1E7*f,c[h+l+1]+=f}Y(c);return c}function a(d,a){var c=d.length,g=ba(c),f,h;h=0;for(--c;0<=c;--c)h=1E7*h+d[c],f=ia(h/a),h-=f*a,g[c]=f|0;return[g,h|0]}function g(d,g){var k,h=J(g),q=d.value;k=h.value;if(0===k)throw Error("Cannot divide by zero");if(d.isSmall)return h.isSmall?[new v(ia(q/k)),new v(q%k)]:[E[0],d];if(h.isSmall){if(1===k)return[d,E[0]];if(-1==k)return[d.negate(),E[0]];k=Math.abs(k);if(1E7>k)return k=a(q,k),q=m(k[0]),k=k[1],d.sign&&(k=-k),"number"===
typeof q?(d.sign!==h.sign&&(q=-q),[new v(q),new v(k)]):[new f(q,d.sign!==h.sign),new v(k)];k=u(k)}var r=c(q,k);if(-1===r)return[E[0],d];if(0===r)return[E[d.sign===h.sign?1:-1],E[0]];if(200>=q.length+k.length){var l=k,t=q.length;k=l.length;var r=ba(l.length),G=l[k-1],y=Math.ceil(1E7/(2*G)),q=B(q,y),l=B(l,y),n,w,D,N,z,A;q.length<=t&&q.push(0);l.push(0);G=l[k-1];for(n=t-k;0<=n;n--){t=9999999;q[n+k]!==G&&(t=Math.floor((1E7*q[n+k]+q[n+k-1])/G));D=w=0;z=l.length;for(N=0;N<z;N++)w+=t*l[N],A=Math.floor(w/
1E7),D+=q[n+N]-(w-1E7*A),w=A,0>D?(q[n+N]=D+1E7,D=-1):(q[n+N]=D,D=0);for(;0!==D;){--t;for(N=w=0;N<z;N++)w+=q[n+N]-1E7+l[N],0>w?(q[n+N]=w+1E7,w=0):(q[n+N]=w,w=1);D+=w}r[n]=t}q=a(q,y)[0];k=[m(r),m(q)]}else{r=q.length;G=k.length;y=[];for(l=[];r;)if(l.unshift(q[--r]),0>c(l,k))y.push(0);else{t=l.length;n=1E7*l[t-1]+l[t-2];w=1E7*k[G-1]+k[G-2];t>G&&(n=1E7*(n+1));t=Math.ceil(n/w);do{n=B(k,t);if(0>=c(n,l))break;t--}while(t);y.push(t);l=x(l,n)}y.reverse();k=[m(y),m(l)]}q=k[0];h=d.sign!==h.sign;k=k[1];r=d.sign;
"number"===typeof q?(h&&(q=-q),q=new v(q)):q=new f(q,h);"number"===typeof k?(r&&(k=-k),k=new v(k)):k=new f(k,r);return[q,k]}function c(d,a){if(d.length!==a.length)return d.length>a.length?1:-1;for(var c=d.length-1;0<=c;c--)if(d[c]!==a[c])return d[c]>a[c]?1:-1;return 0}function r(d){d=d.abs();if(d.isUnit())return!1;if(d.equals(2)||d.equals(3)||d.equals(5))return!0;if(d.isEven()||d.isDivisibleBy(3)||d.isDivisibleBy(5))return!1;if(d.lesser(25))return!0}function h(d){return("number"===typeof d||"string"===
typeof d)&&1E7>=+Math.abs(d)||d instanceof f&&1>=d.value.length}function l(d,a,c){a=J(a);var g=d.isNegative(),k=a.isNegative(),h=g?d.not():d,f=k?a.not():a;a=[];d=[];for(var q=!1,r=!1;!q||!r;)h.isZero()?(q=!0,a.push(g?1:0)):g?a.push(h.isEven()?1:0):a.push(h.isEven()?0:1),f.isZero()?(r=!0,d.push(k?1:0)):k?d.push(f.isEven()?1:0):d.push(f.isEven()?0:1),h=h.over(2),f=f.over(2);g=[];for(k=0;k<a.length;k++)g.push(c(a[k],d[k]));for(c=bigInt(g.pop()).negate().times(bigInt(2).pow(g.length));g.length;)c=c.add(bigInt(g.pop()).times(bigInt(2).pow(g.length)));
return c}function G(d){d=d.value;d="number"===typeof d?d|1073741824:d[0]+1E7*d[1]|1073758208;return d&-d}function N(d,a){d=J(d);a=J(a);return d.greater(a)?d:a}function t(d,a){d=J(d);a=J(a);return d.lesser(a)?d:a}function y(d,a){d=J(d).abs();a=J(a).abs();if(d.equals(a))return d;if(d.isZero())return a;if(a.isZero())return d;for(var c=E[1],g;d.isEven()&&a.isEven();)g=Math.min(G(d),G(a)),d=d.divide(g),a=a.divide(g),c=c.multiply(g);for(;d.isEven();)d=d.divide(G(d));do{for(;a.isEven();)a=a.divide(G(a));
d.greater(a)&&(g=a,a=d,d=g);a=a.subtract(d)}while(!a.isZero());return c.isUnit()?d:d.multiply(c)}function Ba(d){d=d.value;"number"===typeof d&&(d=[d]);return 1===d.length&&35>=d[0]?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(d[0]):"<"+d+">"}function ca(d,a){a=bigInt(a);if(a.isZero()){if(d.isZero())return"0";throw Error("Cannot convert nonzero numbers to base 0.");}if(a.equals(-1))return d.isZero()?"0":d.isNegative()?Array(1-d).join("10"):"1"+Array(+d).join("01");var c="";d.isNegative()&&a.isPositive()&&
(c="-",d=d.abs());if(a.equals(1))return d.isZero()?"0":c+Array(+d+1).join(1);for(var g=[],h=d,f;h.isNegative()||0<=h.compareAbs(a);)f=h.divmod(a),h=f.quotient,f=f.remainder,f.isNegative()&&(f=a.minus(f).abs(),h=h.next()),g.push(Ba(f));g.push(Ba(h));return c+g.reverse().join("")}function R(d){if(A(+d)){var a=+d;if(a===ia(a))return new v(a);throw"Invalid integer: "+d;}(a="-"===d[0])&&(d=d.slice(1));var c=d.split(/e/i);if(2<c.length)throw Error("Invalid integer: "+g.join("e"));if(2===c.length){d=c[1];
"+"===d[0]&&(d=d.slice(1));d=+d;if(d!==ia(d)||!A(d))throw Error("Invalid integer: "+d+" is not a valid exponent.");var g=c[0],c=g.indexOf(".");0<=c&&(d-=g.length-c-1,g=g.slice(0,c)+g.slice(c+1));if(0>d)throw Error("Cannot include negative exponent part for integers");d=g+=Array(d+1).join("0")}if(!/^([0-9][0-9]*)$/.test(d))throw Error("Invalid integer: "+d);for(var g=[],c=d.length,h=c-7;0<c;)g.push(+d.slice(h,c)),h-=7,0>h&&(h=0),c-=7;Y(g);return new f(g,a)}function J(d){return"number"===typeof d?(d=
A(d)?new v(d):R(d.toString()),d):"string"===typeof d?R(d):d}var la=u(9007199254740992),M=Math.log(9007199254740992);f.prototype.add=function(d){d=J(d);if(this.sign!==d.sign)return this.subtract(d.negate());var a=this.value,c=d.value;return d.isSmall?new f(H(a,Math.abs(c)),this.sign):new f(Z(a,c),this.sign)};f.prototype.plus=f.prototype.add;v.prototype.add=function(d){d=J(d);var a=this.value;if(0>a!==d.sign)return this.subtract(d.negate());var c=d.value;if(d.isSmall){if(A(a+c))return new v(a+c);c=
u(Math.abs(c))}return new f(H(c,Math.abs(a)),0>a)};v.prototype.plus=v.prototype.add;f.prototype.subtract=function(d){var a=J(d);if(this.sign!==a.sign)return this.add(a.negate());d=this.value;var g=a.value;if(a.isSmall)return W(d,Math.abs(g),this.sign);a=this.sign;0<=c(d,g)?d=x(d,g):(d=x(g,d),a=!a);d=m(d);"number"===typeof d?(a&&(d=-d),d=new v(d)):d=new f(d,a);return d};f.prototype.minus=f.prototype.subtract;v.prototype.subtract=function(a){a=J(a);var d=this.value;if(0>d!==a.sign)return this.add(a.negate());
var c=a.value;return a.isSmall?new v(d-c):W(c,Math.abs(d),0<=d)};v.prototype.minus=v.prototype.subtract;f.prototype.negate=function(){return new f(this.value,!this.sign)};v.prototype.negate=function(){var a=this.sign,c=new v(-this.value);c.sign=!a;return c};f.prototype.abs=function(){return new f(this.value,!1)};v.prototype.abs=function(){return new v(Math.abs(this.value))};f.prototype.multiply=function(a){var d=J(a);a=this.value;var c=d.value,g=this.sign!==d.sign;if(d.isSmall){if(0===c)return E[0];
if(1===c)return this;if(-1===c)return this.negate();c=Math.abs(c);if(1E7>c)return new f(B(a,c),g);c=u(c)}var d=a.length,h=c.length;return 0<-.012*d-.012*h+1.5E-5*d*h?new f(n(a,c),g):new f(da(a,c),g)};f.prototype.times=f.prototype.multiply;v.prototype._multiplyBySmall=function(a){return A(a.value*this.value)?new v(a.value*this.value):D(Math.abs(a.value),u(Math.abs(this.value)),this.sign!==a.sign)};f.prototype._multiplyBySmall=function(a){return 0===a.value?E[0]:1===a.value?this:-1===a.value?this.negate():
D(Math.abs(a.value),this.value,this.sign!==a.sign)};v.prototype.multiply=function(a){return J(a)._multiplyBySmall(this)};v.prototype.times=v.prototype.multiply;f.prototype.square=function(){return new f(w(this.value),!1)};v.prototype.square=function(){var a=this.value*this.value;return A(a)?new v(a):new f(w(u(Math.abs(this.value))),!1)};f.prototype.divmod=function(a){a=g(this,a);return{quotient:a[0],remainder:a[1]}};v.prototype.divmod=f.prototype.divmod;f.prototype.divide=function(a){return g(this,
a)[0]};v.prototype.over=v.prototype.divide=f.prototype.over=f.prototype.divide;f.prototype.mod=function(a){return g(this,a)[1]};v.prototype.remainder=v.prototype.mod=f.prototype.remainder=f.prototype.mod;f.prototype.pow=function(a){var d=J(a),c=this.value;a=d.value;var g;if(0===a)return E[1];if(0===c)return E[0];if(1===c)return E[1];if(-1===c)return d.isEven()?E[1]:E[-1];if(d.sign)return E[0];if(!d.isSmall)throw Error("The exponent "+d.toString()+" is too large.");if(this.isSmall&&A(g=Math.pow(c,
a)))return new v(ia(g));g=this;for(d=E[1];;){a&1&&(d=d.times(g),--a);if(0===a)break;a/=2;g=g.square()}return d};v.prototype.pow=f.prototype.pow;f.prototype.modPow=function(a,c){a=J(a);c=J(c);if(c.isZero())throw Error("Cannot take modPow with modulus 0");for(var d=E[1],g=this.mod(c);a.isPositive();){if(g.isZero())return E[0];a.isOdd()&&(d=d.multiply(g).mod(c));a=a.divide(2);g=g.square().mod(c)}return d};v.prototype.modPow=f.prototype.modPow;f.prototype.compareAbs=function(a){a=J(a);return a.isSmall?
1:c(this.value,a.value)};v.prototype.compareAbs=function(a){a=J(a);var d=Math.abs(this.value),c=a.value;return a.isSmall?(c=Math.abs(c),d===c?0:d>c?1:-1):-1};f.prototype.compare=function(a){if(Infinity===a)return-1;if(-Infinity===a)return 1;a=J(a);return this.sign!==a.sign?a.sign?1:-1:a.isSmall?this.sign?-1:1:c(this.value,a.value)*(this.sign?-1:1)};f.prototype.compareTo=f.prototype.compare;v.prototype.compare=function(a){if(Infinity===a)return-1;if(-Infinity===a)return 1;a=J(a);var d=this.value,c=
a.value;return a.isSmall?d==c?0:d>c?1:-1:0>d!==a.sign?0>d?-1:1:0>d?1:-1};v.prototype.compareTo=v.prototype.compare;f.prototype.equals=function(a){return 0===this.compare(a)};v.prototype.eq=v.prototype.equals=f.prototype.eq=f.prototype.equals;f.prototype.notEquals=function(a){return 0!==this.compare(a)};v.prototype.neq=v.prototype.notEquals=f.prototype.neq=f.prototype.notEquals;f.prototype.greater=function(a){return 0<this.compare(a)};v.prototype.gt=v.prototype.greater=f.prototype.gt=f.prototype.greater;
f.prototype.lesser=function(a){return 0>this.compare(a)};v.prototype.lt=v.prototype.lesser=f.prototype.lt=f.prototype.lesser;f.prototype.greaterOrEquals=function(a){return 0<=this.compare(a)};v.prototype.geq=v.prototype.greaterOrEquals=f.prototype.geq=f.prototype.greaterOrEquals;f.prototype.lesserOrEquals=function(a){return 0>=this.compare(a)};v.prototype.leq=v.prototype.lesserOrEquals=f.prototype.leq=f.prototype.lesserOrEquals;f.prototype.isEven=function(){return 0===(this.value[0]&1)};v.prototype.isEven=
function(){return 0===(this.value&1)};f.prototype.isOdd=function(){return 1===(this.value[0]&1)};v.prototype.isOdd=function(){return 1===(this.value&1)};f.prototype.isPositive=function(){return!this.sign};v.prototype.isPositive=function(){return 0<this.value};f.prototype.isNegative=function(){return this.sign};v.prototype.isNegative=function(){return 0>this.value};f.prototype.isUnit=function(){return!1};v.prototype.isUnit=function(){return 1===Math.abs(this.value)};f.prototype.isZero=function(){return!1};
v.prototype.isZero=function(){return 0===this.value};f.prototype.isDivisibleBy=function(a){a=J(a);var d=a.value;return 0===d?!1:1===d?!0:2===d?this.isEven():this.mod(a).equals(E[0])};v.prototype.isDivisibleBy=f.prototype.isDivisibleBy;f.prototype.isPrime=function(){var a=r(this);if(a!==z)return a;for(var a=this.abs(),c=a.prev(),g=[2,3,5,7,11,13,17,19],h=c,f,l,t,m;h.isEven();)h=h.divide(2);for(t=0;t<g.length;t++)if(m=bigInt(g[t]).modPow(h,a),!m.equals(E[1])&&!m.equals(c)){l=!0;for(f=h;l&&f.lesser(c);f=
f.multiply(2))m=m.square().mod(a),m.equals(c)&&(l=!1);if(l)return!1}return!0};v.prototype.isPrime=f.prototype.isPrime;f.prototype.isProbablePrime=function(a){var d=r(this);if(d!==z)return d;d=this.abs();a=a===z?5:a;for(var c=0;c<a;c++)if(!bigInt.randBetween(2,d.minus(2)).modPow(d.prev(),d).isUnit())return!1;return!0};v.prototype.isProbablePrime=f.prototype.isProbablePrime;f.prototype.next=function(){var a=this.value;return this.sign?W(a,1,this.sign):new f(H(a,1),this.sign)};v.prototype.next=function(){var a=
this.value;return 9007199254740992>a+1?new v(a+1):new f(la,!1)};f.prototype.prev=function(){var a=this.value;return this.sign?new f(H(a,1),!0):W(a,1,this.sign)};v.prototype.prev=function(){var a=this.value;return-9007199254740992<a-1?new v(a-1):new f(la,!0)};for(var ga=[1];1E7>=ga[ga.length-1];)ga.push(2*ga[ga.length-1]);var Aa=ga.length,ea=ga[Aa-1];f.prototype.shiftLeft=function(a){if(!h(a))throw Error(String(a)+" is too large for shifting.");a=+a;if(0>a)return this.shiftRight(-a);for(var d=this;a>=
Aa;)d=d.multiply(ea),a-=Aa-1;return d.multiply(ga[a])};v.prototype.shiftLeft=f.prototype.shiftLeft;f.prototype.shiftRight=function(a){var d;if(!h(a))throw Error(String(a)+" is too large for shifting.");a=+a;if(0>a)return this.shiftLeft(-a);for(d=this;a>=Aa;){if(d.isZero())return d;d=g(d,ea);d=d[1].isNegative()?d[0].prev():d[0];a-=Aa-1}d=g(d,ga[a]);return d[1].isNegative()?d[0].prev():d[0]};v.prototype.shiftRight=f.prototype.shiftRight;f.prototype.not=function(){return this.negate().prev()};v.prototype.not=
f.prototype.not;f.prototype.and=function(a){return l(this,a,function(a,d){return a&d})};v.prototype.and=f.prototype.and;f.prototype.or=function(a){return l(this,a,function(a,d){return a|d})};v.prototype.or=f.prototype.or;f.prototype.xor=function(a){return l(this,a,function(a,d){return a^d})};v.prototype.xor=f.prototype.xor;f.prototype.toString=function(a){a===z&&(a=10);if(10!==a)return ca(this,a);a=this.value;for(var d=a.length,c=String(a[--d]),g;0<=--d;)g=String(a[d]),c+="0000000".slice(g.length)+
g;return(this.sign?"-":"")+c};v.prototype.toString=function(a){a===z&&(a=10);return 10!=a?ca(this,a):String(this.value)};f.prototype.valueOf=function(){return+this.toString()};f.prototype.toJSNumber=f.prototype.valueOf;v.prototype.valueOf=function(){return this.value};v.prototype.toJSNumber=v.prototype.valueOf;for(var E=function(a,c){if("undefined"===typeof a)return E[0];if("undefined"!==typeof c){var d;if(10===+c)d=J(a);else{d=c;var g=E[0],h=E[1],f=a.length;if(2<=d&&36>=d&&f<=M/Math.log(d))d=new v(parseInt(a,
d));else{d=J(d);var f=[],r,l="-"===a[0];for(r=l?1:0;r<a.length;r++){var q=a[r].toLowerCase(),t=q.charCodeAt(0);if(48<=t&&57>=t)f.push(J(q));else if(97<=t&&122>=t)f.push(J(q.charCodeAt(0)-87));else if("<"===q){q=r;do r++;while(">"!==a[r]);f.push(J(a.slice(q+1,r)))}else throw Error(q+" is not a valid character");}f.reverse();for(r=0;r<f.length;r++)g=g.add(f[r].times(h)),h=h.times(d);d=l?g.negate():g}}return d}return J(a)},S=0;1E3>S;S++)E[S]=new v(S),0<S&&(E[-S]=new v(-S));E.one=E[1];E.zero=E[0];E.minusOne=
E[-1];E.max=N;E.min=t;E.gcd=y;E.lcm=function(a,c){a=J(a).abs();c=J(c).abs();return a.divide(y(a,c)).multiply(c)};E.isInstance=function(a){return a instanceof f||a instanceof v};E.randBetween=function(a,c){a=J(a);c=J(c);var d=t(a,c),g=N(a,c).subtract(d);if(g.isSmall)return d.add(Math.round(Math.random()*g));for(var h=[],r=!0,l=g.value.length-1;0<=l;l--){var q=r?g.value[l]:1E7,G=ia(Math.random()*q);h.unshift(G);G<q&&(r=!1)}h=m(h);return d.add("number"===typeof h?new v(h):new f(h,!1))};return E}()});
(function(){function z(a,g,c){if(A.Utils.isSymbol(a))this.parse(a);else if(isNaN(a))"string"===typeof a&&this.parse(u.parse(a));else{if(void 0===g)throw Error("Polynomial expects a variable name when creating using order");this.coeffs=[];this.coeffs[c||0]=a;this.fill(a)}}function f(){this.factors={}}function v(a,g,c){this.terms=g||[];this.coeff=a;this.map=c;this.sum=new A.Frac(0);this.image=void 0}var A=nerdamer.getCore(),u=A.PARSER,m=A.groups.N,Y=A.groups.S,ba=A.groups.EX,ia=A.groups.FN,L=A.groups.PL,
Z=A.groups.CP,H=A.groups.CB,x=A.Utils.keys,W=A.Utils.variables,da=A.Utils.round,B=A.Frac,I=A.Utils.isInt,n=A.Symbol,D=A.Settings.CONST_HASH;z.fromArray=function(a,g){if("undefined"===typeof g)throw Error("A variable name must be specified when creating polynomial from array");var c=new z;c.coeffs=a;c.variable=g;return c};z.fit=function(a,g,c,f,h,l){var r=Array(h+1);r[0]=g;r[h]=a;a=c-g-a*Math.pow(f,h);for(--h;0<h;h--)g=Math.pow(f,h),c=a/g,c=Math.sign(c)*Math.floor(Math.abs(c)),a-=c*g,r[h]=c;if(0!==
a)return null;for(h=0;h<r.length;h++)r[h]=new B(r[h]);return z.fromArray(r,l)};z.prototype={parse:function(a,g){this.variable=W(a)[0];if(!a.isPoly())throw Error("Polynomial Expected! Received "+A.Utils.text(a));g=g||[];a.power.absEquals(1)||(a=u.expand(a));if(a.group===A.groups.N)g[0]=a.multiplier;else if(a.group===A.groups.S)g[a.power.toDecimal()]=a.multiplier;else for(var c in a.symbols){var f=a.symbols[c],h=f.power;if(A.Utils.isSymbol(h))throw Error("power cannot be a Symbol");h=f.group===m?0:
h.toDecimal();f.symbols?this.parse(f,g):g[h]=f.multiplier}this.coeffs=g;this.fill()},fill:function(a){a=Number(a)||0;for(var g=this.coeffs.length,c=0;c<g;c++)void 0===this.coeffs[c]&&(this.coeffs[c]=new B(a));return this},trim:function(){for(var a=this.coeffs.length;a--;){var g=this.coeffs[a],c=g.equals(0);if(g&&c){if(0===a)break;this.coeffs.pop()}else break}return this},modP:function(a){for(var g=this.coeffs.length,c=0;c<g;c++){var f=this.coeffs[c];if(0>f){for(var h,l=c;l<g;l++)if(0<this.coeffs[l]){h=
this.coeffs[l];break}if(h){for(l;l>c;l--)this.coeffs[l]=this.coeffs[l].subtract(new B(1)),this.coeffs[l-1]=this.coeffs[l-1].add(new B(a));f=this.coeffs[c]}}l=f.mod(a);f=f.subtract(l).divide(a);if(!f.equals(0)){var m=c+1,n=this.coeffs[m]||new B(0),n=n.add(f);this.coeffs[m]=new B(n);this.coeffs[c]=new B(l)}}return this},add:function(a){for(var g=Math.max(this.coeffs.length,a.coeffs.length),c=0;c<g;c++){var f=this.coeffs[c]||new B(0),h=a.coeffs[c]||new B(0);this.coeffs[c]=f.add(h)}return this},subtract:function(a){for(var g=
Math.max(this.coeffs.length,a.coeffs.length),c=0;c<g;c++){var f=this.coeffs[c]||new B(0),h=a.coeffs[c]||new B(0);this.coeffs[c]=f.subtract(h)}return this},divide:function(a){var g=this.variable,c=A.Utils.arrayClone(this.coeffs),f=A.Utils.arrayClone(a.coeffs),h=c.length,l=f.length-1;a=[];for(var m=0;m<h;m++){var n=h-(m+1),t=n-l,n=c[n].divide(f[l]);if(0>t)break;a[t]=n;for(var y=0;y<=l;y++)c[y+t]=c[y+t].subtract(f[y].multiply(n))}c=z.fromArray(c,g||"x").trim();return[z.fromArray(a,g||"x"),c]},multiply:function(a){for(var g=
this.coeffs.length,c=a.coeffs.length,f=[],h=0;h<g;h++)for(var l=this.coeffs[h],m=0;m<c;m++){var n=h+m,t=a.coeffs[m],y=f[n]||new B(0);f[n]=y.add(l.multiply(t))}this.coeffs=f;return this},isZero:function(){for(var a=this.coeffs.length,g=0;g<a;g++)if(!this.coeffs[g].equals(0))return!1;return!0},sub:function(a){for(var g=new B(0),c=this.coeffs.length,f=0;f<c;f++){var h=this.coeffs[f];h.equals(0)||(g=g.add(h.multiply(new B(Math.pow(a,f)))))}return g},clone:function(){var a=new z;a.coeffs=this.coeffs;a.variable=
this.variable;return a},deg:function(){this.trim();return this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var a=this.lc(),g=this.coeffs.length,c=0;c<g;c++)this.coeffs[c]=this.coeffs[c].divide(a);return this},gcd:function(a){var g;if(this.coeffs.length-1<a.coeffs.length-1)return a.gcd(this);for(g=this;!a.isZero();){var c=a.clone();g=g.clone();g=g.divide(c);a=g[1];g=c}c=A.Math2.QGCD.apply(null,g.coeffs);if(!c.equals(1)){a=g.coeffs.length;for(var f=0;f<
a;f++)g.coeffs[f]=g.coeffs[f].divide(c)}return g},diff:function(){for(var a=[],g=this.coeffs.length,c=1;c<g;c++)a.push(this.coeffs[c].multiply(new B(c)));this.coeffs=a;return this},integrate:function(){for(var a=[0],g=this.coeffs.length,c=0;c<g;c++){var f=new B(c+1);a[f]=this.coeffs[c].divide(f)}this.coeffs=a;return this},gcf:function(a){for(var g=[],c=0;c<this.coeffs.length;c++){var f=this.coeffs[c];f.equals(0)||-1!==g.indexOf(f)||g.push(f)}g=[A.Math2.QGCD.apply(void 0,g),function(a){for(var c=0;c<
a.length;c++)if(!a[c].equals(0))return c}(this.coeffs)].toDecimal();a&&(a=[],a[g[1]-1]=g[0],g=z.fromArray(a,this.variable).fill());return g},quad:function(a){var g=[];if(3<this.coeffs.length)throw Error("Cannot calculate quadratic order of "+(this.coeffs.length-1));if(0===this.coeffs.length)throw Error("Polynomial array has no terms");var c=this.coeffs[2]||0,f=this.coeffs[1]||0,h=f*f-4*c*this.coeffs[0];0>h&&!a||(g[0]=(-f+Math.sqrt(h))/(2*c),g[1]=(-f-Math.sqrt(h))/(2*c));return g},squareFree:function(){for(var a=
this.clone(),g=1,c=a.clone().diff(),c=a.clone().gcd(c),f=a.divide(c)[0],a=z.fromArray([new B(1)],a.variable);!c.equalsNumber(1);){var h=f.gcd(c),f=f.divide(h)[0];if(!f.equalsNumber(1)&&1<g){for(var l=f.clone(),m=1;m<g;m++)l.multiply(f.clone());f=l}a=a.multiply(f);g++;f=h;c=c.divide(h)[0]}return[a,f,g]},toSymbol:function(){var a=this.coeffs.length,g=this.variable;if(0===a)return new A.Symbol(0);for(var c=a-1,f="",h=0;h<a;h++){var l=h===c?"":"+",m=this.coeffs[h];m.equals(0)||(f+=m+"*"+g+"^"+h+l)}return u.parse(f)},
equalsNumber:function(a){this.trim();return 1===this.coeffs.length&&this.coeffs[0].toDecimal()===a},toString:function(){return this.toSymbol().toString()}};n.prototype.coeffs=function(a,g){g&&!this.isPoly(!0)&&u.error("Polynomial expected when requesting coefficients with order");a=a||[];var c=this.clone().distributeMultiplier();if(c.isComposite())for(var f in c.symbols){var h=c.symbols[f];h.isComposite()?h.clone().distributeMultiplier().coeffs(a,g):g?a[h.isConstant()?0:h.power.toDecimal()]=h.multiplier:
a.push(h.multiplier)}else g?a[c.isConstant()?0:c.power.toDecimal()]=c.multiplier:a.push(c.multiplier);if(g)for(c=0;c<a.length;c++)void 0===a[c]&&(a[c]=new B(0));return a};n.prototype.tBase=function(a){if("undefined"===typeof a)throw Error("Symbol.tBase requires a map object!");for(var g=[],c=this.collectSymbols(null,null,null,!0),f=c.length,h=0;h<f;h++){var l=c[h],m=l.group,n=new v(l.multiplier,[],a);if(m===H)for(var t in l.symbols)n.terms[a[t]]=l.symbols[t].power;else n.terms[a[l.value]]=l.power;
g.push(n.fill());n.updateCount()}return g};n.prototype.altVar=function(a){var g=this.multiplier.toString(),c=this.power.toString();return("1"===g?"":g+"*")+a+("1"===c?"":"^"+c)};n.prototype.sameVars=function(a){if(!this.symbols&&this.group!==a.group)return!1;for(var g in this.symbols){var c=a.symbols[g];if(!c||this.symbols[g].value!==c.value)return!1}return!0};f.prototype.add=function(a){if(a.equals(0))return this;if(a.group===H){var g=this;a.each(function(a){g.add(a)})}else{this.preAdd&&(a=this.preAdd(a));
this.pFactor&&(a=u.pow(a,new n(this.pFactor)));var c=a.isConstant();if(c&&a.equals(1))return this;c=c?a.value:a.text();this.factors[c]=c in this.factors?u.multiply(this.factors[c],a):a}return this};f.prototype.toSymbol=function(){var a=new n(1),g;for(g in this.factors)var c=this.factors[g].power.equals(1)?u.symfunction(A.PARENTHESIS,[this.factors[g]]):this.factors[g],a=u.multiply(a,c);return a};f.prototype.merge=function(a){for(var g in a)this.factors[g]=g in this.factors?u.multiply(this.factors[g],
a[g]):a[g];return this};f.prototype.each=function(a){for(var g in this.factors){var c=this.factors[g];c.fname===A.PARENTHESIS&&c.isLinear()&&(c=c.args[0]);a.call(this,c,g)}return this};f.prototype.count=function(){return x(this.factors).length};f.prototype.toString=function(){return this.toSymbol().toString()};v.prototype.updateCount=function(){this.count=this.count||0;for(var a=0;a<this.terms.length;a++)this.terms[a].equals(0)||this.count++;return this};v.prototype.getVars=function(){for(var a=[],
g=0;g<this.terms.length;g++){var c=this.terms[g];this.getRevMap();c.equals(0)||a.push(this.rev_map[g])}return a.join(" ")};v.prototype.len=function(){"undefined"===typeof this.count&&this.updateCount();return this.count};v.prototype.toSymbol=function(a){a=a||this.getRevMap();for(var g=new n(this.coeff),c=0;c<this.terms.length;c++){var f=a[c],h=this.terms[c];h.equals(0)||f===D||(f=new n(f),f.power=h,g=u.multiply(g,f))}return g};v.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var a=
{},g;for(g in this.map)a[this.map[g]]=g;return this.rev_map=a};v.prototype.generateImage=function(){this.image=this.terms.join(" ");return this};v.prototype.getImg=function(){this.image||this.generateImage();return this.image};v.prototype.fill=function(){for(var a=this.map.length,g=0;g<a;g++)"undefined"===typeof this.terms[g]?this.terms[g]=new A.Frac(0):this.sum=this.sum.add(this.terms[g]);return this};v.prototype.divide=function(a){for(var g=this.coeff.divide(a.coeff),c=this.terms.length,g=new v(g,
[],this.map),f=0;f<c;f++)g.terms[f]=this.terms[f].subtract(a.terms[f]),g.sum=g.sum.add(g.terms[f]);return g};v.prototype.multiply=function(a){for(var g=this.coeff.multiply(a.coeff),c=this.terms.length,g=new v(g,[],this.map),f=0;f<c;f++)g.terms[f]=this.terms[f].add(a.terms[f]),g.sum=g.sum.add(g.terms[f]);return g};v.prototype.isZero=function(){return this.coeff.equals(0)};v.prototype.toString=function(){return"{ coeff: "+this.coeff.toString()+", terms: ["+this.terms.join(",")+"]: sum: "+this.sum.toString()+
", count: "+this.count+"}"};A.Utils.toMapObj=function(a){for(var g=0,c={},f=0;f<a.length;f++){var h=a[f];"undefined"===typeof c[h]&&(c[h]=g,g++)}c.length=g;return c};A.Utils.filledArray=function(a,g,c){for(var f=[];g--;)f[g]=c?new c(a):a;return f};A.Utils.arrSum=function(a){for(var g=0,c=a.length,f=0;f<c;f++)g+=a[f];return g};A.Utils.subFunctions=function(a,g){g=g||{};var c=[];a.each(function(a){if(a.group===ia||a.previousGroup===ia){var f=A.Utils.text(a,"hash"),l=g[f];l||(l=a.fname+x(g).length,g[f]=
l);c.push(a.altVar(l))}else a.group===H||a.group===L||a.group===Z?c.push(A.Utils.subFunctions(a,g)):c.push(a.text())});return a.group===Z||a.group===L?a.altVar(A.Utils.inBrackets(c.join("+"))):a.group===H?a.altVar(A.Utils.inBrackets(c.join("*"))):a.text()};A.Utils.getFunctionsSubs=function(a){var g={},c;for(c in a)g[a[c]]=u.parse(c);return g};var w=A.Algebra={version:"1.4.0",init:void 0,proots:function(a,g){function c(a,c,f){function h(a,d,c,g,f,h){f[0]=h.b=g[0];f[1]=h.a=-(d*h.b)+g[1];for(var k=2;k<
a;k++)f[k]=-(d*h.a+c*h.b)+g[k],h.b=h.a,h.a=f[k]}function l(a,d,c,g,f,l,r,t,q){var k={},m=3;k.b=k.a=0;h(d,r,t,l,q,k);f.c=k.a;f.d=k.b;if(Math.abs(f.c)<=100*a*Math.abs(l[d-1])&&Math.abs(f.d)<=100*a*Math.abs(l[d-2]))return m;f.h=t*g;Math.abs(f.d)>=Math.abs(f.c)?(m=2,f.e=c/f.d,f.f=f.c/f.d,f.g=r*g,f.a3=f.e*(f.g+c)+g/f.d*f.h,f.a1=-c+f.f*g,f.a7=f.h+(f.f+r)*c):(m=1,f.e=c/f.c,f.f=f.d/f.c,f.g=f.e*r,f.a3=f.e*c+(f.g+f.h/f.c)*g,f.a1=-(f.d/f.c*c)+g,f.a7=f.g*f.d+f.h*f.f+c);return m}function r(a,d,c,f,g,h,l,r,t){if(3==
c)for(l[1]=l[0]=0,a=2;a<d;a++)l[a]=r[a-2];else if(Math.abs(h.a1)>10*a*Math.abs(1==c?g:f))for(h.a7/=h.a1,h.a3/=h.a1,l[0]=t[0],l[1]=-(t[0]*h.a7)+t[1],a=2;a<d;a++)l[a]=-(t[a-1]*h.a7)+r[a-2]*h.a3+t[a];else for(l[0]=0,l[1]=-(t[0]*h.a7),a=2;a<d;a++)l[a]=-(t[a-1]*h.a7)+r[a-2]*h.a3}function t(a,d,c,f,g,h,l,r,t,q,m,n,y,w,D,G,u){d.b=d.a=0;3!=a&&(2!=a?(a=c+y*l+n*q,t=r+(y+w*q)*t):(a=(c+m)*q+n,t=(q+y)*r+w*t),r=-(D[G-1]/u[G]),D=-(D[G-2]+r*u[G-1])/u[G],G=r*h,g*=r*r,u=-(G+g)+w*D*f,a=-u+t+r*a,0!=a&&(d.a=-((y*(g+G)+
w*(r*f+D*h))/a)+y,d.b=w*(1+u/a)))}function m(a,d,c,f){var g,h;f.sr=f.si=f.lr=f.li=0;0==a?f.sr=0!=d?-(c/d):f.sr:0==c?f.lr=-(d/a):(d/=2,Math.abs(d)<Math.abs(c)?(h=-(0<=c?a:-a)+d/Math.abs(c)*d,g=Math.sqrt(Math.abs(h))*Math.sqrt(Math.abs(c))):(h=-(a/d*(c/d))+1,g=Math.sqrt(Math.abs(h))*Math.abs(d)),0<=h?(f.lr=(-d+(0<=d?-g:g))/a,f.sr=0!=f.lr?c/f.lr/a:f.sr):(f.lr=f.sr=-(d/a),f.si=Math.abs(g/a),f.li=-f.si))}c=a.slice(0);a.unshift(f);if(100<f)throw Error("This utility accepts polynomials of degree up to 100. ");
a=[];var n={};n.Degree=f;for(y=0;y<f;y++)a.push(0);f=a.slice(0);(function(a,d,c,f){var g=a.Degree,k=Math.LN2,q=a.Degree+1,n=Array(q),y=Array(q),w=Array(q),D=Array(q),G={},u={},v,z,A,N,F,x,J,E,R,B,b,e,p,ca,Ba,M,O,X,H,la,S,I,ga,W;e=1;do z=e,e/=2,p=1+e;while(1<p);var Aa=Number.MIN_VALUE/z,C=Math.cos(1.6406094968746698),Y=Math.sin(1.6406094968746698),L=Math.sqrt(.5),Z=-L;u.NZ=H=0;for(u.szr=u.szi=u.lzr=u.lzi=0;0==d[g];)c[H]=f[H]=0,g--,H++;for(ga=g+1;1<=g;){if(2>=g){2>g?(c[a.Degree-1]=-(d[1]/d[0]),f[a.Degree-
1]=0):(G.li=G.lr=G.si=G.sr=0,m(d[0],d[1],d[2],G),c[a.Degree-2]=G.sr,f[a.Degree-2]=G.si,c[a.Degree-1]=G.lr,f[a.Degree-1]=G.li);break}J=0;E=Number.MAX_VALUE;for(Q=0;Q<ga;Q++)B=Math.abs(d[Q]),B>J&&(J=B),0!=B&&B<E&&(E=B);R=Aa/E;if(1>=R&&10<=J||1<R&&Number.MAX_VALUE/R>=J)if(R=0==R?Number.MIN_VALUE:R,S=Math.floor(Math.log(R)/k+.5),F=Math.pow(2,S),1!=F)for(Q=0;Q<ga;Q++)d[Q]*=F;for(var Q=0;Q<ga;Q++)y[Q]=Math.abs(d[Q]);y[g]=-y[g];I=g-1;B=Math.exp((Math.log(-y[g])-Math.log(y[0]))/g);0!=y[I]&&(b=-y[g]/y[I],
B=b<B?b:B);b=B;do for(B=b,b=.1*B,x=y[0],Q=1;Q<ga;Q++)x=x*b+y[Q];while(0<x);do{A=x=y[0];for(Q=1;Q<g;Q++)x=B*x+y[Q],A=B*A+x;x=B*x+y[g];N=x/A;B-=N}while(.005<Math.abs(N/B));v=B;for(Q=1;Q<g;Q++)n[Q]=(g-Q)*d[Q]/g;n[0]=d[0];e=d[g];p=d[I];W=0==n[I]?1:0;for(la=0;5>la;la++)if(ca=n[I],W){for(Q=0;Q<I;Q++)H=I-Q,n[H]=n[H-1];n[0]=0;W=0==n[I]?1:0}else{M=-e/ca;for(Q=0;Q<I;Q++)H=I-Q,n[H]=M*n[H-1]+d[H];n[0]=d[0];W=Math.abs(n[I])<=Math.abs(p)*z*10?1:0}for(Q=0;Q<g;Q++)D[Q]=n[Q];for(la=1;20>=la;la++){X=-(Y*Z)+C*L;Z=Y*
L+C*Z;L=X;Ba=v*L;O=-(2*Ba);a:{var ea,ba,da,ia,Ib,tb,qa,Jb,ib,Kb,Lb,ub,Va,Mb,Wa,Xa,Na,Nb,Ob=void 0,Pb=void 0,Qb,Rb,Sb,Ia,Oa,Ya=z,lc=20*la,mc=Ba,Qa=v,wa=n,ta=g,$a=d,wb=ga,mb=w,ab=O,nb=u,sa={},na={},bb=Array(q),Tb=Array(q),ob=1;nb.NZ=0;Rb=Sb=.25;Qb=mc;Nb=Qa;sa.b=sa.a=0;h(wb,ab,Qa,$a,mb,sa);Oa=sa.a;Ia=sa.b;na.h=na.g=na.f=na.e=na.d=na.c=na.a7=na.a3=na.a1=0;da=l(Ya,ta,Oa,Ia,na,wa,ab,Qa,bb);for(tb=0;tb<lc;tb++){Jb=1;r(Ya,ta,da,Oa,Ia,na,wa,bb,mb);da=l(Ya,ta,Oa,Ia,na,wa,ab,Qa,bb);t(da,sa,Oa,na.a1,na.a3,na.a7,
Ia,na.c,na.d,na.f,na.g,na.h,ab,Qa,wa,ta,$a);Lb=sa.a;ib=Kb=sa.b;Xa=0!=wa[ta-1]?-($a[ta]/wa[ta-1]):0;Wa=Va=1;if(0!=tb&&3!=da&&(Va=0!=ib?Math.abs((ib-Nb)/ib):Va,Wa=0!=Xa?Math.abs((Xa-Qb)/Xa):Wa,ub=Va<Ob?Va*Ob:1,Mb=Wa<Pb?Wa*Pb:1,ba=ub<Rb?1:0,(Ib=Mb<Sb?1:0)||ba)){for(qa=0;qa<ta;qa++)Tb[qa]=wa[qa];Na=Xa;for(ia=ea=0;;){if(!Jb||0!=(Jb=0)||!Ib||ba&&!(Mb<ub)){var cb=void 0,Ra=void 0,xb=void 0,db=void 0,ua=void 0,Yb=void 0,za=void 0,yb=void 0,Sa=void 0,Zb=void 0,zb=void 0,La=void 0,Ma=Ya,Ta=ta,xa=nb,nc=Lb,oc=
Kb,eb=mb,$b=wb,ka=sa,Ub=$a,pb=bb,va=na,fb=wa,Fa={},Ab=0,ac=0;xa.NZ=0;za=nc;ua=oc;do{Fa.li=Fa.lr=Fa.si=Fa.sr=0;m(1,za,ua,Fa);xa.szr=Fa.sr;xa.szi=Fa.si;xa.lzr=Fa.lr;xa.lzi=Fa.li;if(Math.abs(Math.abs(xa.szr)-Math.abs(xa.lzr))>.01*Math.abs(xa.lzr))break;h($b,za,ua,Ub,eb,ka);zb=Math.abs(-(xa.szr*ka.b)+ka.a)+Math.abs(xa.szi*ka.b);xb=Math.sqrt(Math.abs(ua));La=2*Math.abs(eb[0]);yb=-(xa.szr*ka.b);for(Ra=1;Ra<Ta;Ra++)La=La*xb+Math.abs(eb[Ra]);La=La*xb+Math.abs(yb+ka.a);La=(9*La+2*Math.abs(yb)-7*(Math.abs(ka.a+
yb)+xb*Math.abs(ka.b)))*Ma;if(zb<=20*La){xa.NZ=2;break}Ab++;if(20<Ab)break;if(2<=Ab&&.01>=Sa&&zb>=Zb&&!ac){Sa=Sa<Ma?Math.sqrt(Ma):Math.sqrt(Sa);za-=za*Sa;ua+=ua*Sa;h($b,za,ua,Ub,eb,ka);for(Ra=0;5>Ra;Ra++)cb=l(Ma,Ta,ka.a,ka.b,va,fb,za,ua,pb),r(Ma,Ta,cb,ka.a,ka.b,va,fb,pb,eb);ac=1;Ab=0}Zb=zb;cb=l(Ma,Ta,ka.a,ka.b,va,fb,za,ua,pb);r(Ma,Ta,cb,ka.a,ka.b,va,fb,pb,eb);cb=l(Ma,Ta,ka.a,ka.b,va,fb,za,ua,pb);t(cb,ka,ka.a,va.a1,va.a3,va.a7,ka.b,va.c,va.d,va.f,va.g,va.h,za,ua,fb,Ta,Ub);Yb=ka.a;db=ka.b;0!=db&&(Sa=
Math.abs((-ua+db)/db),za=Yb,ua=db)}while(0!=db);if(0<nb.NZ)break a;ob=ea=1;Rb*=.25;if(ia||!Ib)ob=0;else for(qa=0;qa<ta;qa++)wa[qa]=Tb[qa]}if(0!=ob){sa.a=Na;var Bb=void 0,ha=void 0,Vb=void 0,gb=void 0,Ga=void 0,Ua=void 0,bc=void 0,cc=void 0,qb=void 0,Da=void 0,Cb=void 0,Wb=Ya,rb=nb,pc=sa,sb=ta,dc=$a,ec=wb,hb=mb,Ea=wa,Db=bb,fc=sb-1;rb.NZ=Bb=Vb=0;for(Ga=pc.a;;){Ua=dc[0];hb[0]=Ua;for(ha=1;ha<ec;ha++)hb[ha]=Ua=Ua*Ga+dc[ha];qb=Math.abs(Ua);cc=Math.abs(Ga);Cb=.5*Math.abs(hb[0]);for(ha=1;ha<ec;ha++)Cb=Cb*
cc+Math.abs(hb[ha]);if(qb<=20*Wb*(2*Cb-qb)){rb.NZ=1;rb.szr=Ga;rb.szi=0;break}Bb++;if(10<Bb)break;if(2<=Bb&&Math.abs(gb)<=.001*Math.abs(-gb+Ga)&&qb>bc){Vb=1;rb.a=Ga;break}bc=qb;Db[0]=Da=Ea[0];for(ha=1;ha<sb;ha++)Db[ha]=Da=Da*Ga+Ea[ha];if(Math.abs(Da)>10*Math.abs(Ea[fc])*Wb)for(gb=-(Ua/Da),Ea[0]=hb[0],ha=1;ha<sb;ha++)Ea[ha]=gb*Db[ha-1]+hb[ha];else for(Ea[0]=0,ha=1;ha<sb;ha++)Ea[ha]=Db[ha-1];Da=Ea[0];for(ha=1;ha<sb;ha++)Da=Da*Ga+Ea[ha];gb=Math.abs(Da)>10*Math.abs(Ea[fc])*Wb?-(Ua/Da):0;Ga+=gb}ob=Vb;Na=
sa.a;if(0<nb.NZ)break a;ia=1;Sb*=.25;if(0!=ob){Lb=-(Na+Na);Kb=Na*Na;continue}}for(qa=0;qa<ta;qa++)wa[qa]=Tb[qa];if(!ba||ea)break}h(wb,ab,Qa,$a,mb,sa);Oa=sa.a;Ia=sa.b;da=l(Ya,ta,Oa,Ia,na,wa,ab,Qa,bb)}Nb=ib;Qb=Xa;Ob=Va;Pb=Wa}}if(0!=u.NZ){H=a.Degree-g;c[H]=u.szr;f[H]=u.szi;ga-=u.NZ;g=ga-1;for(Q=0;Q<ga;Q++)d[Q]=w[Q];1!=u.NZ&&(c[H+1]=u.lzr,f[H+1]=u.lzi);break}else for(Q=0;Q<g;Q++)n[Q]=D[Q]}if(20<la){a.Degree-=g;break}}})(n,c,f,a);c=a.length;for(y=0;y<c;y++){var n=da(a[y],g+8),d=da(f[y],g),d=2<g-String(d).length?
d:f[y],q=0>n?"-":"";0===d&&(d="");0===n&&(n="");n=1===Math.abs(n)?q+"i":n?n+"*i":"";f[y]=(d&&n?d+"+"+n:d+n).replace(/\+\-/g,"-")}return f}g=g||7;var f=function(a,f,g){a=c(a,f,g);for(f=0;0>f;f++)a.unshift(0);return a};if(a instanceof n&&a.isPoly()){if(a.group===A.groups.S)return[0];if(a.group===A.groups.PL){var h=x(a.symbols),h=A.Utils.arrayMin(h);a=A.PARSER.divide(a,A.PARSER.parse(a.value+"^"+h))}for(var h=x(a.symbols).sort().pop(),l=a.group===A.groups.PL?a.symbols:a.symbols[h],m=l.group,h=m===Y?
[l.power.toDecimal()]:x(l.symbols),w=[],t=A.Utils.arrayMax(h),y=1;y<=t;y++){var D=0;-1!==h.indexOf(y+"")&&(D=m===Y?l.multiplier:l.symbols[y].multiplier);w.unshift(D)}w.push(a.symbols["#"].multiplier);l.group===Y&&(w[0]=l.multiplier);return f(w,h,t)}if(A.Utils.isArray(a)){l=a;w=[];h=[];for(y=D=0;y<l.length;y++){for(var m=l[y][0],t=l[y][1],D=t-D-1,u=0;u<D;u++)w.unshift(0);w.unshift(m);0!==t&&h.push(t);D=t}t=Math.max.apply(void 0,h);return f(w,h,t)}throw Error("Cannot calculate roots. Symbol must be a polynomial!");
},roots:function(a){a=w.proots(a).map(function(a){return u.parse(a)});return A.Vector.fromArray(a)},froot:function(a,f,c){f=Number(f);c=c?c:A.Utils.build(A.Calculus.diff(a.clone()));a=a instanceof Function?a:A.Utils.build(a);for(var g=!1,h=0;!g;){var l=f-a(f)/c(f),m=Math.abs(Math.abs(l)-Math.abs(f));f=l;1E-12>m?g=!0:1E4<h&&(f=null,g=!0);h++}return f},quad:function(a,f,c){var g=function(a,c,f,g){return u.parse("-("+c+"+"+g+"*sqrt(("+c+")^2-4*("+a+")*("+f+")))/(2*"+a+")")};return[g(a,f,c,1),g(a,f,c,
-1)]},sumProd:function(a,f){return w.quad(-f,a,-1).map(function(a){return a.invert()})},polyPowers:function(a,f,c){c=c||[];var g=g=a.group;if(g===L&&f===a.value)c=c.concat(x(a.symbols));else if(g===Z)for(var h in a.symbols){var l=a.symbols[h],g=l.group,n=l.value;g===Y&&f===n?c.push(l.power):g===L||g===Z?c=w.polyPowers(l,f,c):g===H&&l.contains(f)?(g=l.symbols[f])&&c.push(g.power):g!==m&&f===n||c.push(0)}return A.Utils.arrayUnique(c).sort()},Factor:{mix:function(a,f){for(var c=x(a),g=c.length,h=[],
l=0;l<g;l++){for(var m=c[l],n=a[m],t=h.length,y=0;y<t;y++){var w=h[y]*m;h.push(w);f&&h.push(-w)}for(y=1;y<=n;y++)h.push(Math.pow(m,y))}return h},factor:function(a,g){if(a.group===Y)return a;var c=a.power.clone();if(I(c)){a.toLinear();g=g||new f;var r={},h;a=u.parse(A.Utils.subFunctions(a,r));0<x(r).length&&(g.preAdd=function(a){return u.parse(a,A.Utils.getFunctionsSubs(r))});a.isLinear()||(g.pFactor=a.power.toString(),a.toLinear());var l=W(a),m=1<l.length;m&&(h=a.clone());if(m){var n=!0,t=!0;a.each(function(a){a.group!==
Y&&(n=!1);a.multiplier.equals(1)||(t=!1)});if(n&&t)return u.pow(a,u.parse(c))}a=w.Factor.coeffFactor(a,g);a=w.Factor.powerFactor(a,g);1===l.length?(a=w.Factor.squareFree(a,g),a=w.Factor.trialAndError(a,g)):a=w.Factor.mfactor(a,g);a=u.parse(a,A.Utils.getFunctionsSubs(r));g.add(a);var y=g.toSymbol();return m&&!A.Utils.compare(h,y,l)?h:u.pow(y,u.parse(c))}return a},squareFree:function(a,f){if(a.isConstant()||a.group===Y)return a;var c=(new z(a)).squareFree(),g=c[2];if(1!==g){var h=c[1].toSymbol();h.power=
h.power.multiply(new B(g));f.add(w.Factor.factor(h));return w.Factor.squareFree(c[0].toSymbol(),f)}return a},powerFactor:function(a,f){if(a.group!==L)return a;var c=A.Utils.arrayMin(x(a.symbols)),g=new n(0),h=u.parse(a.value+"^"+c);a.each(function(a){a=u.divide(a,h.clone());g=u.add(g,a)});f.add(h);return g},coeffFactor:function(a,f){if(a.isComposite()){var c=A.Math2.QGCD.apply(null,a.coeffs());c.equals(1)||a.each(function(a){a.isComposite()?a.each(function(a){a.multiplier=a.multiplier.divide(c)}):
a.multiplier=a.multiplier.divide(c)});a.updateHash();f&&f.add(new n(c))}return a},trialAndError:function(a,f){if(a.isConstant()||a.group===Y)return a;for(var c=new z(a),g=A.Math2.ifactor(c.coeffs[0]),h=w.proots(a),l=0;l<h.length;l++){var m=h[l],n=1;if(!isNaN(m)){for(var t in g){var y=A.Utils.round(Math.log(t)/Math.log(Math.abs(m)),8);if(I(y)){m=t;n=y;break}}m=new B(m);y=[(new B(m.num)).negate()];y[n]=new B(m.den);n=z.fromArray(y,c.variable).fill();m=c.divide(n);m[1].equalsNumber(0)&&(c=m[0],f.add(n.toSymbol()))}}c.equalsNumber(1)||
(c=w.Factor.search(c,f));return c.toSymbol()},search:function(a,f,c){c=c||10;var g=a.variable,h=function(h,l,t,r){return(h=z.fit(h,l,t,c,r,g))&&1<h.coeffs.length&&(l=a.divide(h),l[1].equalsNumber(0))?(f.add(h.toSymbol()),[l[0],h]):null},l=a.coeffs[0],m=A.Math2.ifactor(l),n=a.lc(),t=A.Math2.ifactor(n),y=a.sub(c),y=w.Factor.mix(A.Math2.ifactor(y),0>y),D=Math.ceil(a.coeffs.length/2),n=n.lessThan(0),l=l.lessThan(0);t["1"]=1;for(m["1"]=1;D--;)for(var u in t)for(var v in m)for(var x=0;x<y.length;x++){var B=
h(u,v,y[x],D);if(B)return a=B[0],A.Utils.isPrime(a.sub(c))||(a=w.Factor.search(a,f)),a;!B&&n?B=h(-u,v,y[x],D):!B&&l?B=h(u,-v,y[x],D):!B&&n&&l&&(B=h(-u,-v,y[x],D))}return a},mSqfrFactor:function(a,f){for(var c=W(a).reverse(),g=0;g<c.length;g++){do{var h=w.Factor.coeffFactor(A.Calculus.diff(a,c[g]));if(h.equals(0))break;var l=w.div(a,h.clone()),m=l[1].equals(0);if(l[0].isConstant()){f.add(l[0]);break}m&&(f.add(l[0]),a=h)}while(m)}return a},mfactor:function(a,f){a=w.Factor.mSqfrFactor(a,f);for(var c=
W(a),g=a.collectSymbols(),h={},l={},m=c.length,D=g.length,t=0;t<m;t++){var y=c[t];h[y]=new n(0);for(var v=0;v<D;v++){var z=g[v];if(z.contains(y)){var x=z.value===y?z.power.toDecimal():z.symbols[y].power.toDecimal();if(!l[y]||x<l[y])l[y]=x;h[y]=u.add(h[y],z.clone())}}}for(var A in h){c=u.parse(A+"^"+l[A]);c=u.expand(u.divide(h[A],c));g=w.div(a.clone(),c);if(g[0].equals(0))return g[1];if(g[1].equals(0))return f.add(g[0]),f.add(c),c=w.div(a,g[0].clone())[0],c.isConstant()?(f.add(c),c):w.Factor.mfactor(c,
f)}return a}},allLinear:function(a){for(var f=a.length,c=0;c<f;c++)if(!w.isLinear(a[c]))return!1;return!0},isLinear:function(a){var f=!1,c=a.group;if(c===L||c===Z){var f=!0,r;for(r in a.symbols){var c=a.symbols[r],h=c.group;if(h===ia||h===ba||h===H)f=!1;else if(h===L||h===Z)f=w.isLinear(c);else if(c.group!==m&&"1"!==c.power.toString()){f=!1;break}}}else c===Y&&1===a.power&&(f=!0);return f},gcd:function(a,f){if(a.length<f.length){var c=a;a=f;f=c}var c=W(a),g=W(f);if(c.length===g.length&&1===c.length&&
c[0]===g[0])return a=new z(a),f=new z(f),a.gcd(f).toSymbol();for(;!f.equals(0);){c=f.clone();a=a.clone();g=w.div(a,c);f=g[1];if(g[0].equals(0))return new n(A.Math2.QGCD(a.multiplier,f.multiplier));a=c}var h=[];a.each(function(a){h.push(a.multiplier)});var l=A.Math2.QGCD.apply(void 0,h);l.equals(1)||a.each(function(a){a.multiplier=a.multiplier.divide(l)});return a},divide:function(a,f){var c=w.div(a,f),g=u.divide(c[1],f);return u.add(c[0],g)},div:function(a,f){if(f.isConstant())return a.each(function(a){a.multiplier=
a.multiplier.divide(f.multiplier)}),[a,new n(0)];if(a.group===Y&&f.group===Z){var c=f.symbols[a.value];if(c&&f.isLinear()&&c.isLinear()&&a.isLinear())return[new n(1),u.subtract(a.clone(),f.clone())]}var g=a.hasFunc(),h=f.hasFunc(),c=!1;if(g||h){var c=!0,l={};a=u.parse(A.Utils.subFunctions(a,l));f=u.parse(A.Utils.subFunctions(f,l));l=A.Utils.getFunctionsSubs(l)}var h=A.Utils.arrayUnique(W(a).concat(W(f))),m;if(1===h.length){var w=(new z(a)).divide(new z(f));m=w[0].toSymbol();g=w[1].toSymbol()}else{h.push(D);
var g=function(a){for(var d=new n(0),c=0;c<a.length;c++)var f=a[c].toSymbol(),d=u.add(d,f);return d},t=function(a,c){var d=Math.max.apply(null,a.terms),f=0,g;if(!c)for(var h=0;h<a.terms.length;h++)if(a.terms[h].equals(d)&&(g=h,f++),1<f)return;if(c)for(h=0;h<a.terms.length;h++)if(a.terms[h].equals(d)){g=h;break}return[d,g,a]},y=function(a,c){c=c||0;var d=a[c],f=a.length;if(d){for(var g=t(d),h=c+1;h<f;h++){var l=a[h],q=d.sum.equals(l.sum);if(!q&&g)break;if(q){for(var m,n,r,w,g=d.terms.length,q=0;q<
g;q++){var D=d.terms[q],u=l.terms[q];if("undefined"===typeof m||D.greaterThan(m))m=D,r=q;if("undefined"===typeof n||u.greaterThan(n))n=u,w=q}g=m.subtract(l.terms[r]);q=n.subtract(d.terms[w]);if(q>g){g=[n,w,l];break}if(g>q){g=[m,r,d];break}}else if(g=t(l))break;g=t(l)}if(!g)return t(a[0],!0);for(var v,h=0;h<R.length;h++){f=R[h].terms;d=g[1];if(d===f.length-1)return;v=f[d];if(!v.equals(0))break}return v.equals(0)?y(a,++c):g}},x=A.Utils.toMapObj(h),ca=function(a,c){return c.sum.subtract(a.sum)};m=function(a,
c){if(!a||!c)return!1;for(var d=0;d<a.terms.length;d++)if(a.terms[d].lessThan(c.terms[d]))return!1;return!0};var h=a.tBase(x).sort(ca),R=f.tBase(x).sort(ca),x=m(h[0],R[0])&&h[0].count>R[0].count?R:h,ca=y(x),x=[];if(ca){var J=ca[1],ca=function(a,c){return a[0].sum.equals(c[0].sum)?a.length>=c.length:!0},H=function(a,c){var d=a.len(),f=c.len(),g=c.terms[J],h=a.terms[J];return f>d&&g.greaterThan(h)?f-d:g.subtract(h)};h.sort(H);R.sort(H);var w=R[0],M=h[0],I=new v(new B(1),[],M.map);if(w.sum.greaterThan(M.sum)&&
1<M.len())for(var L=0;L<M.terms.length;L++){var ea=w.terms[L].subtract(M.terms[L]);if(ea.equals(0))I.terms[L]=new B(0);else{var E=ea.add(new B(1));I.terms[L]=ea;for(ea=0;ea<h.length;ea++)h[ea].terms[L]=h[ea].terms[L].add(E)}}for(ea=m(h[0],R[0]);ea&&ca(h,R);){w=h[0].divide(R[0]);x.push(w);h.shift();for(L=1;L<R.length;L++)for(M=R[L].multiply(w).generateImage(),E=h.length,0===E&&(M.coeff=M.coeff.neg(),h.push(M),h.sort(H)),ea=0;ea<E;ea++){var S=h[ea];if(S.getImg()===M.getImg()){S.coeff=S.coeff.subtract(M.coeff);
S.coeff.equals(0)&&(A.Utils.remove(h,ea),ea--);break}ea===E-1&&(M.coeff=M.coeff.neg(),h.push(M),h.sort(H))}ea=m(h[0],R[0]);if(!ea&&h.length>=R.length)for(L=1;L<h.length;L++)if(ea=m(h[L],R[0])){h.unshift(A.Utils.remove(h,L));break}}}m=g(x);g=g(h);"undefined"!==typeof I&&(I=I.toSymbol(),m=u.divide(m,I.clone()),g=u.divide(g,I))}c&&(m=u.parse(m.text(),l),g=u.parse(g.text(),l));return[m,g]},Classes:{Polynomial:z,Factors:f,MVTerm:v}};nerdamer.register([{name:"factor",visible:!0,numargs:1,build:function(){return w.Factor.factor}},
{name:"gcd",visible:!0,numargs:2,build:function(){return w.gcd}},{name:"roots",visible:!0,numargs:-1,build:function(){return w.roots}},{name:"divide",visible:!0,numargs:2,build:function(){return w.divide}},{name:"div",visible:!0,numargs:2,build:function(){return w.div}}])})();
(function(){var z=nerdamer.getCore(),f=z.PARSER,v=z.Frac,A=z.Utils.isSymbol,u=z.groups.FN,m=z.Symbol,Y=z.Utils.text,ba=z.Utils.inBrackets,ia=z.Utils.isInt,L=z.Utils.format,Z=z.groups.N,H=z.groups.S,u=z.groups.FN,x=z.groups.PL,W=z.groups.CP,da=z.groups.CB,B=z.groups.EX,I=z.groups.P;m.prototype.hasIntegral=function(){if(this.group===u&&"integrate"===this.fname)return!0;if(this.symbols)for(var f in this.symbols)if(this.symbols[f].hasIntegral())return!0;return!1};m.unwrapPARENS=function(f){if(f.group===
u&&!f.fname){var m=f.args[0];m.power=m.power.multiply(f.power);m.multiplier=m.multiplier.multiply(f.multiplier);return m}return f};z.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()};z.Utils.in_inverse_trig=function(f){return-1!=="asin acos atan acsc asec acot".split(" ").indexOf(f)};z.Utils.in_trig=function(f){return-1!=="cos sin tan sec csc cot".split(" ").indexOf(f)};z.Settings.integration_depth=4;var n=z.Calculus={version:"1.3.1",sum:function(n,w,a,g){if(w.group!==
z.groups.S)throw Error("Index must be symbol. "+Y(w)+" provided");w=w.value;var c;if(z.Utils.isNumericSymbol(a)&&z.Utils.isNumericSymbol(g))if(a=a.multiplier,g=g.multiplier,c=z.Utils.variables(n),1===c.length&&w===c[0]){var r=z.Utils.build(n);c=0;for(var h=a;h<=g;h++)c+=r.call(void 0,h)}else{var r=n.text(),l={"~":!0};c=new z.Symbol(0);for(h=a;h<=g;h++)l[w]=new m(h),c=f.add(c,f.parse(r,l))}else c=f.symfunction("sum",arguments);return c},diff:function(D,w,a){function g(a){if(a.value===l||a.contains(l,
!0))a.multiplier=a.multiplier.multiply(a.power),a.power=a.power.subtract(new v(1)),a.power.equals(0)&&(a=m(a.multiplier));return a}function c(a){var t=a.group,w;if(t===Z||t===H&&a.value!==l||t===I)a=m(0);else if(t===H)a=g(a);else{if(t===da)return w=a.multiplier.clone(),a.toUnitMultiplier(),a=f.multiply(h(a),g(a.clone())),a.multiplier=a.multiplier.multiply(w),a;if(t===u&&a.power.equals(1))switch(a.fname){case "log":w=a.clone();a=a.args[0].clone();a.power=a.power.negate();a.multiplier=w.multiplier.divide(a.multiplier);
break;case "cos":a.fname="sin";a.multiplier.negate();break;case "sin":a.fname="cos";break;case "tan":a.fname="sec";a.power=new v(2);break;case "sec":a=r(a,"tan");break;case "csc":a=r(a,"-cot");break;case "cot":a.fname="csc";a.multiplier.negate();a.power=new v(2);break;case "asin":a=f.parse("(sqrt(1-("+Y(a.args[0])+")^2))^(-1)");break;case "acos":a=f.parse("-(sqrt(1-("+Y(a.args[0])+")^2))^(-1)");break;case "atan":a=f.parse("(1+("+Y(a.args[0])+")^2)^(-1)");break;case "abs":w=a.multiplier.clone();a.toUnitMultiplier();
t=a.args[0].clone();t.toUnitMultiplier();a=f.parse(ba(Y(a.args[0]))+"/abs"+ba(Y(t)));a.multiplier=w;break;case "parens":a=m(1);break;case "cosh":a.fname="sinh";break;case "sinh":a.fname="cosh";break;case "tanh":a.fname="sech";a.power=new v(2);break;case "sech":a=r(a,"-tanh");break;case "asinh":a=f.parse("(sqrt(1+("+Y(a.args[0])+")^2))^(-1)");break;case "acosh":a=f.parse("(sqrt(-1+("+Y(a.args[0])+")^2))^(-1)");break;case "atanh":a=f.parse("(1-("+Y(a.args[0])+")^2)^(-1)");break;case "Si":a=a.args[0];
a=f.parse("sin("+a+")/("+a+")");break;case "Ci":a=a.args[0],a=f.parse("cos("+a+")/("+a+")")}else if(t===B||t===u&&A(a.power))w=t===B?a.value:t===u&&a.contains(l)?a.fname+ba(Y(a.args[0])):a.value+ba(Y(a.args[0])),f.multiply(f.parse("log"+ba(w)),a.power.clone()),t=n.diff(f.multiply(f.parse("log"+ba(w)),a.power.clone()),l),a=f.multiply(a,t);else if(t===u&&!a.power.equals(1))t=a.clone(),t.toLinear(),t.toUnitMultiplier(),a=f.multiply(g(a.clone(),l),c(t));else if(t===W||t===x){t=new m(0);for(w in a.symbols)t=
f.add(t,n.diff(a.symbols[w].clone(),l));a=f.multiply(g(a.clone()),t)}}a.updateHash();return a}function r(a,c,g){return f.multiply(a,f.parse(c+ba(g||Y(a.args[0]))))}function h(a){a=a.collectSymbols();for(var c=new m(0),g=a.length,h=0;h<g;h++){for(var r=n.diff(a[h].clone(),l),t=0;t<g;t++)h!==t&&(r=f.multiply(r,a[t].clone()));c=f.add(c,r)}return c}var l=A(w)?w.text():w;a=A(a)?a.multiplier:a||1;void 0===l&&(l=z.Utils.variables(D)[0]);if(D.group===u&&"sqrt"===D.fname){var G=D.args[0],N=D.power.clone();
if(G.group!==Z||G.group!==I)G.power=A(G.power)?f.multiply(G.power,f.multiply(new m(.5)),N):G.power.multiply(new v(.5)).multiply(N),G.multiplier=G.multiplier.multiply(D.multiplier);D=G}D.group!==u||A(D.power)?D=c(D):(G=c(D),D=n.diff(D.args[0].clone(),l),D=f.multiply(G,D));1<a&&(a--,D=n.diff(D,w,a));return D},integration:{u_substitution:function(D,w){function a(a,c,g){a=g?g(a,c):f.divide(a.clone(),n.diff(c,w));return a.contains(w)?null:a}function g(a,c){var g=n.integrate(f.symfunction(a,[new m(v)]),
v),g=g.sub(new m(v),c);g.updateHash();return g}var c=D[0].clone(),r=D[1].clone(),h=c.group,l=r.group,v="__u__";if(h===u&&l!==u){l=c.args[0];if(h=a(r,l.clone()))return f.multiply(h,g(c.fname,l));if(h=a(r,c))return n.integration.poly_integrate(c)}else if(l===u&&h!==u){if(l=r.args[0],h=a(c,l.clone()))return f.multiply(h,g(r.fname,l))}else if(h===u&&h===u){if((h=a(c.clone(),r.clone()))||(h=a(r.clone(),c.clone())))return f.multiply(n.integration.poly_integrate(r),h)}else{if(h===B&&l!==B)return l=c.power,
h=a(r,l.clone()),c=n.integrate(c.sub(l,new m(v)),v),f.multiply(c.sub(new m(v),l),h);if(l===B&&h!==B)return l=r.power,h=a(c,l.clone()),c=n.integrate(r.sub(l,new m(v)),v),f.multiply(c.sub(new m(v),l),h);if(c.isComposite()||r.isComposite()){var l=function(a,c){var g=z.Algebra.Factor.factor(a),h=z.Algebra.Factor.factor(n.diff(c,w));return f.divide(g,h)},x=c.isComposite()?c.clone().toLinear():c.clone(),t=r.isComposite()?r.clone().toLinear():r.clone();if(h=a(x.clone(),t.clone(),l))return f.multiply(n.integration.poly_integrate(r),
h);if(h=a(t.clone(),x.clone(),l))return f.multiply(n.integration.poly_integrate(c),h)}}},poly_integrate:function(n){var w=n.power.toString(),a=n.multiplier.toString();n=n.toUnitMultiplier().toLinear();return-1===Number(w)?f.multiply(new m(a),f.symfunction("log",[n])):f.parse(L("({0})*({1})^(({2})+1)/(({2})+1)",a,n,w))},stop:function(f){throw Error(f||"Stopping!");},partial_fraction:function(u,w,a){var g,c,r=new m(u.multiplier);A(u)?(c=u.getDenom().invert(),g=u.getNum()):(g=u[0],c=u[1]);if(g.isConstant()){var h=
c.clone().toLinear(),l=h.stripVar(w),h=f.subtract(h.clone(),l);if(h.group===H&&h.isLinear())return n.integration.poly_integrate(u);c.power.greaterThan(1)&&(c=f.expand(c))}u=z.Algebra.div(g,c.clone());var h=new z.Matrix,l=new z.Matrix,v=u[1].toArray(w);g=u[1];var x=m.unwrapPARENS(z.Algebra.Factor.factor(c)),t=[],y=u[0].equals(0)?u[0]:n.integrate(u[0],w,a);if(x.group!==W)x.each(function(a){a=m.unwrapPARENS(a);a.isConstant()?r=f.multiply(r,a):t.push(a)});else return u[1].isComposite()?u[1].each(function(c){c=
f.divide(c.clone(),x.clone());y=f.add(y,n.integrate(c,w,a))}):(h=x.clone().toLinear(),c=n.integration.decompose_arg(h,w),g=c[1],l=c[0],c=c[3],g.isLinear()||n.integration.stop(),x.power.greaterThan(0)?(y=u[1].isConstant()?n.integration.poly_integrate(f.divide(u[1],x)):f.add(n.integrate(f.divide(h.clone(),x.clone()),w,a),n.integrate(f.divide(c.negate(),x.clone()),w,a)),y=f.divide(y,l)):y=n.integration.by_parts(f.divide(u[1],x.clone()),w,z.Settings.integration_depth)),y;g=t.length;if(1===g)return u=
f.divide(u[1],t[0]),u=n.integrate(u,w,a),u=f.divide(u,r),y=f.add(y,u);for(c=0;c<g;c++){for(var D=new m(1),B=0;B<g;B++)c!==B&&(D=f.multiply(D,t[B].clone()));D=f.expand(D).toArray(w);B=v[c];l.elements[c]=B?[B]:[m(0)];h.elements[c]=D}h=h.transpose().invert().multiply(l);for(c=0;c<g;c++)l=n.integrate(f.divide(u[1].clone(),t[c]),w,a),v=f.expand(h.elements[c][0]),v=f.divide(v,r.clone()),y=f.add(y,f.multiply(l,v));return y},by_parts:function(v,w,a){var g,c;g=function(a){var c=[[],[],[],[],[]],g=function(a){var f=
a.group;f===u?(f=a.fname,z.Utils.in_trig(f)?c[3].push(a):z.Utils.in_inverse_trig(f)?c[1].push(a):"log"===f?c[0].push(a):stop()):f===H||a.isComposite()&&a.isLinear()||f===da&&a.isLinear()?c[2].push(a):f===B||a.isComposite()&&!a.isLinear()?c[4].push(a):stop()};a.group===da?a.each(function(a){g(m.unwrapSQRT(a,!0))}):g(a);for(var n,r=new m(1),t=0;5>t;t++){var w=c[t],v,x=w.length;if(0<x){if(1<x){v=new m(1);for(var A=0;A<x;A++)v=f.multiply(v,w[A].clone())}else v=w[0].clone();n?r=f.multiply(r,v):(n=v,n.multiplier=
n.multiplier.multiply(a.multiplier))}}return[n,r]}(v);v=g[0];c=g[1];g=m.unwrapSQRT(f.expand(n.diff(v.clone(),w)),!0);c=n.integrate(c.clone(),w,a);g=f.multiply(c.clone(),g);v=f.multiply(v,c);c=g.multiplier.clone();g.toUnitMultiplier();w=n.integrate(g.clone(),w,a);w.multiplier=w.multiplier.multiply(c);return f.subtract(v,w)},decompose_arg:function(m,n){var a,g,c,r;m.group===W?(g=f.expand(m.clone()).stripVar(n),a=f.subtract(m.clone(),g.clone()),r=g):a=m.clone();g=a.stripVar(n);c=f.divide(a.clone(),g.clone());
return[g,c,a,r]}},integrate:function(D,w,a){a=a||0;var g=A(w)?w.toString():w,c=m.unwrapSQRT(D.clone(),!0),r=c.group,h;try{++a>z.Settings.integration_depth&&n.integration.stop("Maximum depth reached. Exiting!");if(!c.contains(g,!0))h=f.multiply(c.clone(),f.parse(g));else if(r===H)h=n.integration.poly_integrate(c,g,a);else if(r===B)if(c.contains(g))c.power.contains(g)?n.integration.stop():h=n.integration.poly_integrate(c,g,a);else{var l=n.diff(c.power.clone(),g);if(l.contains(g)){var G=l.stripVar(g),
N=f.divide(l.clone(),G.clone());if(N.group===H&&N.isLinear())return G.multiplier=G.multiplier.divide(new v(2)),f.parse(L("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",G,g,c.multiplier));n.integration.stop()}if(c.isE())h=c;else{var t=f.symfunction("log",[f.parse(c.value)]);h=f.divide(c,t)}h=f.divide(h,l)}else if(c.isComposite()&&c.isLinear())h=new m(0),c.each(function(b){h=f.add(h,n.integrate(b,g,a))});else if(r===W){var y=Number(c.power),I=c.multiplier.clone();c.toUnitMultiplier();var ca=
c.clone().toLinear(),R=n.integration.decompose_arg(ca,g),J=R[3],Y=R[2],l=R[0],N=R[1];if(-1===y&&N.group!==x)if(N.group===H&&N.power.equals(2)){var M=function(a){var b=new m(1);a.each(function(a){b=f.multiply(b,"abs"===a.fname?a.args[0]:a)});return b},Z=l.clone(),ba=J.clone(),Z=f.pow(Z,new m(.5)),ba=f.pow(ba,new m(.5)),t=f.multiply(M(ba),M(Z)),ea=f.symfunction("atan",[f.divide(f.multiply(l,N.toLinear()),t.clone())]);h=f.divide(ea,t)}else h=N.group===H&&N.isLinear()?f.divide(n.integration.poly_integrate(c),
l):n.integration.partial_fraction(c,g,a);else if(-.5===y)if(N.group===H&&N.power.equals(2))if(Y.multiplier.lessThan(0)&&!J.multiplier.lessThan(0))if(l.negate(),J.isConstant()&&l.isConstant()){var t=f.symfunction("sqrt",[l.clone()]),E=f.symfunction("sqrt",[f.multiply(l.clone(),J)]);h=f.divide(f.symfunction("asin",[f.divide(Y.toLinear(),E)]),t)}else{var S=f.symfunction("sqrt",[l]),d=f.multiply(S.clone(),N.clone().toLinear());h=f.divide(f.symfunction("atan",[f.divide(d,f.symfunction("sqrt",[ca.clone()]))]),
S)}else n.integration.stop();else n.integration.stop();else h=N.isLinear()&&N.group!==x?f.divide(n.integration.poly_integrate(c),l):n.integration.partial_fraction(c,g,a);h.multiplier=h.multiplier.multiply(I)}else if(r===u){var q=c.args[0],I=c.multiplier.clone();c.toUnitMultiplier();var R=n.integration.decompose_arg(q,g),l=R[0],N=R[1],k=c.fname;if("log"===k||"asin"===k||"acos"===k||"atan"===k&&N.isLinear())y=c.power.toString(),ia(y)&&(a-=y),h=n.integration.by_parts(c,g,a);else{if(!l.contains(g,!0)&&
c.isLinear())if("abs"===k)if(N=f.divide(q.clone(),l.clone()),N.group!==H||N.power.lessThan(0))n.integration.stop();else if(z.Utils.even(N.power))h=n.integrate(q,g,a);else{var O=n.integrate(N,g,a);O.power=O.power.subtract(new v(1));h=f.multiply(f.multiply(f.symfunction("abs",[N.toLinear()]),O),l)}else{switch(k){case "cos":h=f.symfunction("sin",[q]);break;case "sin":h=f.symfunction("cos",[q]);h.negate();break;case "tan":h=f.parse(L("log(sec({0}))",q));break;case "sec":h=f.parse(L("log(tan({0})+sec({0}))",
q));break;case "csc":h=f.parse(L("-log(csc({0})+cot({0}))",q));break;case "cot":h=f.parse(L("log(sin({0}))",q));break;case "erf":q=c.args[0].clone();G=q.stripVar(g);h=f.parse(L("(({0})*{1}+e^(-{2}^2*{3}^2)/sqrt(pi))",q,h,G,g));break;default:n.integration.stop()}h=f.divide(h,l)}else if(N.isLinear())if("cos"===k||"sin"===k)if(y=Number(c.power),0>y)c.fname="sin"===k?"csc":"sec",c.invert().updateHash(),h=n.integrate(c,g,a);else{var q=c.args[0],X=c.clone(),F=c.clone(),U=new m((y-1)/y),Ca=f.multiply(l.clone(),
new m(y)).invert();X.power=X.power.subtract(new v(1));F.power=F.power.subtract(new v(2));var ra=f.symfunction("cos"===k?"sin":"cos",[q.clone()]);"sin"===k&&ra.negate();h=f.add(f.multiply(f.multiply(Ca,X),ra),f.multiply(U,n.integrate(f.parse(F),g,a)))}else if("tan"===k||"cot"===k){if(c.args[0].isLinear(g)){var Pa=c.power.subtract(new v(1)).toString(),fa=c.clone().toUnitMultiplier(),jb=f.parse(L(("cot"===k?"-":"")+"1/({2}*{0})*{3}({1})^({0})",Pa,q,l,k));fa.power=fa.power.subtract(new v(2));fa.power.equals(0)&&
(fa=f.parse(fa));h=f.subtract(jb,n.integrate(fa,g,a))}}else if("sec"===k||"csc"===k){var pa=c.power.subtract(new v(1)).toString(),vb=c.power.subtract(new v(2)).toString(),J="sec"===k?"tan":"cot",fa=c.clone().toUnitMultiplier(),kb=L(("csc"===k?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",l,pa,vb,q,k,J),jb=f.parse(kb);fa.power=fa.power.subtract(new v(2));fa.power.equals(0)&&(fa=f.parse(fa));h=f.add(jb,f.multiply(new m(vb/pa),n.integrate(fa,g,a)))}else n.integration.stop();else n.integration.stop();
h.multiplier=h.multiplier.multiply(I)}}else if(r===x)h=n.integration.partial_fraction(c,g,a);else if(r===da){var M=c.stripVar(g),Za=f.divide(c.clone(),M.clone());if(Za.group!==da)h=n.integrate(Za,g,a);else{var ma=Za.collectSymbols().sort(function(a,b){return a.group===b.group?Number(a.power)===Number(b.power)?a<b?1:-1:b.power-a.power:b.group-a.group}).map(function(a){return m.unwrapSQRT(a,!0)}),lb=ma.length;if(2===lb){if(h=n.integration.u_substitution(ma,g),!h){var Ja=ma[0].group,oa=ma[1].group,T=
ma[0],P=ma[1],Ka=T.fname,ja=P.fname,c=f.multiply(T.clone(),P.clone());if(Ja===u&&oa===u)if("log"===Ka||"log"===ja)h=n.integration.by_parts(c.clone(),g,a);else{ma.sort(function(a,b){return b.fname>a.fname});var aa=T.args[0];(!aa.isLinear()||aa.group!==W&&aa.group!==da&&aa.group!==H)&&n.integration.stop();R=n.integration.decompose_arg(aa,g);N=R[1];l=R[0];N.isLinear()||n.integration.stop();if(aa.equals(P.args[0]))if("sin"===Ka&&"cos"===ja)if(T.power.lessThan(0)&&n.integration.stop(),"sin"===Ka&&T.power.add(P.power).equals(0))T.fname=
"tan",T.updateHash(),h=n.integrate(T,g,a);else{var b=z.Utils.even(T.power),e=z.Utils.even(P.power);h=new m(0);if(b&&e)return I=function(a){var b=a.power/2;return f.parse("cos"===a.fname?"((1/2)+(cos(2*("+a.args[0]+"))/2))^"+b:"((1/2)-(cos(2*("+a.args[0]+"))/2))^"+b)},l=I(T),J=I(P),ra=f.multiply(l,J),Eb=f.expand(ra),Eb.each(function(b){h=f.add(h,n.integrate(b,g,a))}),f.multiply(h,M);var p,V;b?(p=T,fa=P):(p=P,fa=T);var K="cos"===p.fname?-1:1,Pa=fa.power,l=(Pa-1)/2;V=f.parse("(1-"+p.fname+z.Utils.inBrackets(aa)+
"^2)^"+l);var Eb=f.expand(f.multiply(new m(K),f.multiply(p.clone(),V)));Eb.each(function(a){h=f.add(h,n.integration.poly_integrate(a.clone()))})}else"tan"===Ka&&"sec"===ja&&N.isLinear()?T.isLinear()&&P.isLinear()?h=f.divide(f.symfunction("sec",[aa.clone()]),l):n.integration.stop():"sec"===Ka&&"cos"===ja?(T.fname="cos",T.invert().updateHash(),h=n.integrate(f.multiply(T,P),g,a)):"sin"===Ka&&"csc"===ja?(P.fname="sin",P.invert().updateHash(),h=n.integrate(f.multiply(T,P),g,a)):n.integration.stop();else n.integration.stop()}else if(Ja===
u&&oa===H)h="cos"===T.fname&&P.power.equals(-1)?f.symfunction("Ci",[T.args[0]]):"sin"===T.fname&&P.power.equals(-1)?f.symfunction("Si",[T.args[0]]):n.integration.by_parts(c,g,a);else if(Ja===B&&oa===H)h=n.integration.by_parts(c,g,a);else if(Ja===x&&oa===H){if(P.value===T.value&&T.power.equals(-1)){var gc=Math.min.apply(null,z.Utils.keys(T.symbols)),hc=Math.min(gc,P.power),Fb=P.clone();Fb.power=new v(hc);P=f.divide(P,Fb.clone());ra=new m(0);T.each(function(a){ra=f.add(ra,f.divide(a.clone(),Fb.clone()))});
ra.multiplier=T.multiplier;c=f.divide(P,ra)}h=n.integration.partial_fraction(c,g,a)}else if(Ja===W&&oa===H)if(T.power.equals(-.5)){if(R=n.integration.decompose_arg(T.clone().toLinear(),g),l=R[0].negate(),N=R[1],J=R[3],y=Number(P.power),ia(y)&&z.Utils.even(y)&&N.power.equals(2)){var Gb=f.divide(f.multiply(f.pow(J.clone(),new m(2)),f.symfunction("sqrt",[f.divide(J.clone(),l.clone())])),f.pow(l.clone(),new m(2))),Gb=f.multiply(Gb,f.symfunction("sqrt",[J]).invert()),Hb=f.parse("sin(u)");Hb.power=Hb.power.multiply(P.power);
var Xb=n.integrate(Hb,"u",a),ic=f.parse("asin(sqrt("+l+"/"+J+")*"+g+")");h=f.multiply(Gb,Xb.sub(new m("u"),ic))}}else if(T.power.equals(-1)&&P.isLinear())h=n.integration.partial_fraction(c,g,a);else if(!T.power.lessThan(0)&&ia(T.power)){var jc=f.expand(T);h=new m(0);jc.each(function(b){b.group===x?b.each(function(b){h=f.add(h,n.integrate(f.multiply(P.clone(),b),g,a))}):h=f.add(h,n.integrate(f.multiply(P.clone(),b),g,a))})}else h=T.power.lessThan(-2)?n.integration.by_parts(c,g,a):n.integration.partial_fraction(c,
g,a);else if(T.isComposite()&&P.isComposite()){h=new m(0);var kc=Number(P.power);0>Number(T.power)&&0<kc&&(ra=T,T=P,P=ra);T.each(function(b){h=f.add(h,n.integrate(f.multiply(b,P.clone()),g,a))})}else h=n.integration.by_parts(c,g,a)}}else 3===lb&&ma[2].group===H&&(h=n.integration.by_parts(c,g,a))}h=f.multiply(h,M)}if(h)return h}catch(C){}return f.symfunction("integrate",[D,w])}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return n.diff}},{name:"sum",visible:!0,numargs:4,
build:function(){return n.sum}},{name:"integrate",visible:!0,numargs:2,build:function(){return n.integrate}}])})();
(function(){var z=nerdamer.getCore(),f=z.PARSER,v=z.groups.N,A=z.Special={version:"1.0.0",step:function(u){return u.group===v?(u=u.multiplier.toDecimal(),0<u?1:0>u?0:.5):f.symfunction("step",[u])},sign:function(u){return u.group===v?(u=u.multiplier.toDecimal(),0<u?1:0>u?-1:0):f.symfunction("sign",[u])},rect:function(f){f=z.Utils.format("step({0}+(0.5)) - step({0}-(0.5))",f);return z.PARSER.parse(f)},sinc:function(u){return u.group===v?0===u.multiplier.toDecimal()?1:Math.sin(u)/u:f.symfunction("sinc",
[u])},tri:function(f){f=z.Utils.format("rect(0.5*{0})*(1-abs({0}))",f);return z.PARSER.parse(f)}};nerdamer.register([{name:"step",visible:!0,numargs:1,build:function(){return A.step}},{name:"sign",visible:!0,numargs:1,build:function(){return A.sign}},{name:"rect",visible:!0,numargs:1,build:function(){return A.rect}},{name:"sinc",visible:!0,numargs:1,build:function(){return A.sinc}},{name:"tri",visible:!0,numargs:1,build:function(){return A.tri}}])})();
(function(){var z=nerdamer.getCore(),f=z.PARSER,v=z.Algebra,A=z.Calculus,u=z.groups.PL,m=z.Utils.format,Y=z.Utils.build,ba=z.Utils.isInt,ia=z.Utils.sameSign,L=z.Symbol,Z=z.Utils.isSymbol,H=z.Utils.variables,x=z.Utils.isArray,W=function(m){var n=m.split("=");void 0===n[1]&&(n[1]="0");m=f.parse(n[0]);n=f.parse(n[1]);return f.subtract(m,n)},da=function(f){nerdamer.clearVars();for(var m=0;m<f.length;m++)f[m]=W(f[m]);v.allLinear(f)||z.err("System must contain all linear equations!");for(var a=H(f[0]),
g=new z.Matrix,c=new z.Matrix,n=f.length,m=1;m<n;m++)a=a.concat(H(f[m]));a=z.Utils.arrayUnique(a).sort();for(m=0;m<n;m++){for(var h=f[m],l=0;l<n;l++){var u=h.symbols[a[l]];g.set(m,l,u?u.multiplier:0)}h=h.symbols["#"];c.set(m,0,new L(h?-h.multiplier:0))}var g=g.invert(),x=[];g.multiply(c).each(function(c,f){x.push([a[f],c.valueOf()])});return x},B=function(m,n,a,g){g="-"===g?"subtract":"add";m=f.subtract(f.pow(n.clone(),L(2)),f.multiply(f.multiply(a.clone(),m.clone()),L(4)));m=f.pow(m,L(.5));return f.divide(f[g](n.clone().negate(),
m),f.multiply(new L(2),a.clone()))},I=function(n,u,a,g){var c=g.text(),r=a.text(),h=u.text(),l=n.text(),w=f.parse(m("{1}^2-3*{0}*{2}",c,r,h)),v=f.parse(m("sqrt((2*{1}^3-9*{0}*{1}*{2}+27*{0}^2*{3})^2-4*({1}^2-3*{0}*{2})^3)",c,r,h,l)),t=f.parse(m("((1/2)*({4}+2*{1}^3-9*{0}*{1}*{2}+27*{0}^2*{3}))^(1/3)",c,r,h,l,v)),x=z.Utils.block("PARSE2NUMBER",function(){return f.parse(t,{a:new L(1),b:new L(1),c:new L(1),d:new L(1)})});0===Number(w)&&0===Number(x)&&(t=f.parse(m("((1/2)*(-{4}+2*{1}^3-9*{0}*{1}*{2}+27*{0}^2*{3}))^(1/3)",
c,r,h,l,v)));c=["-(b/(3*a))+C/(3*a)+((b^2-3*a*c))/(3*a*C)","-(b/(3*a))+(C*(1+i*sqrt(3)))/(6*a)+((1-i*sqrt(3))*(b^2-3*a*c))/6*a*C".replace(/i/g,z.Settings.IMAGINARY),"-(b/(3*a))+(C*(1-i*sqrt(3)))/(6*a)+((1+i*sqrt(3))*(b^2-3*a*c))/(6*a*C)".replace(/i/g,z.Settings.IMAGINARY)];for(r=0;3>r;r++)c[r]=f.parse(c[r],{a:g.clone(),b:a.clone(),c:u.clone(),d:n.clone(),C:t.clone()});return c},n=function(m,n){n=n||"x";if(x(m))return da.apply(void 0,arguments);var a=[],g=function(c){x(c)?a=a.concat(c):"null"!==c.valueOf()&&
(Z(c)||(c=f.parse(c)),a.push(c))},c=function(a){var c=Y(a),h,l=0;do if(h=c(l),l++,100<l)break;while(!isFinite(h));if(0===h)g(new L(h));else{for(var l=Y(A.diff(a.clone())),m,n=0;10>n;n++){var r=l(n);if(!isNaN(m)&&!isNaN(r))break;m=r}var t=1;ia(m-r,h)&&(t=-1);m=function(h){for(var l=0,d,m=h;m<h+100;m++){var k=c(m)*t,n=Math.abs(0-k);1<n&&(k*=n);if(0===k||!ia(k,l)){d=k===h?k:(h+l)/2;break}l=k}void 0!==d&&g(f.parse(z.Algebra.froot(a,d)))};m(h);m(-h)}},r=W(m),h=z.Utils.variables(r);if(1===h.length)r.isPoly(!0)?
h[0]===n&&v.proots(r).map(g):c(r);else if(!r.hasFunc()&&r.isComposite())try{var l=[],w=function(a,c){c=Number(c);if(!ba(c))throw Error("Stopping");var g=f.parse(n+"^"+c);l[c]=f.divide(a,g)},D;for(D in r.symbols){var t=r.symbols[D];if(t.group===u&&t.value===n)t.each(function(a,c){w(a,c)});else{var y;t.symbols?(y=t.symbols[n],w(t,y?y.power:0)):w(t,t.value===n?t.power:0)}}for(var H=l.length,c=H-1,r=0;r<H;r++)void 0===l[r]&&(l[r]=new L(0));switch(c){case 1:g(f.divide(l[0],l[1].negate()));break;case 2:g(B.apply(void 0,
l));l.push("-");g(B.apply(void 0,l));break;case 3:g(I.apply(void 0,l))}}catch(ca){}return a};nerdamer.register({name:"solveEquations",parent:"nerdamer",visible:!0,build:function(){return n}})})();"undefined"!==typeof module&&(module.exports=nerdamer);